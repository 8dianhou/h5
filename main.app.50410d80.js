var appConfig={version:"v2.9.7.3",libHost:"http://assets3.weplus.me/lib/",viewDomainFormat:"http://h5.rrxiu.net/v/{guid}",viewHost:"http://view3.weplus.me/",pcViewHost:"http://www.rrxiu.net/view-",serviceHost:"http://res.rrxiu.net/",interactServiceHost:"http://res.rrxiu.net/",dataHost:"http://data3.weplus.me/",vipDataHost:"http://vipdata3.weplus.me/",vrHost:"http://view3.weplus.me/vr/",imageHost:"http://image3.weplus.me/",imageOss:"http://run-image2-weplus-me.oss-cn-hangzhou.aliyuncs.com/",shareImageThumb:"@!300x300",llImageThumb:"@!view-loading-logo",cloudHost:"http://view3.weplus.me/data/",pluginDomainFormat:"http://assets3.weplus.me/plugin/{token}/{version}",clientHost:"http://www.rrxiu.net/",webFontHost:"http://assets3.weplus.me/webfont/",rrxiuFontCssHost:"http://assets3.weplus.me/rrxiuFontCss/",weixinVoiceHost:"http://assets3.weplus.me/weixinVoice/",startTimeParseBgImgNew:"2016-11-16 08:30:00",enabledCloud:!0,animationEngine:"css",copyright:{content:"免费制作 → 人人秀",textAlign:"center",url:"http://mp.weixin.qq.com/s?__biz=MzA4ODc5OTE1OQ==&mid=403178211&idx=1&sn=9c50c942df41020d626d50289a75cf16#rd",color:"#fff",bgColor:"#00"},shareInfo:{color:"#fff",bgColor:"rgba(0, 0, 0, 0.9)",content:'<div class="d-share-arrow"></div>'},copyrightPage:{id:"copyrightPage",backgroundColor:"#E6E9EE",elementList:[{animationList:[],content:{css:"",fullscreen:!0,html:'<div class="copyright-content" style="color:{{titleColor}}"><a href="javascript:void(0)" class="show-rrxiu-report" style="color:{{jubaoColor}}">举报</a><div class="share-title">{{shareTitle}}</div><div class="share-image"><img src="{{shareImageUrl}}"></div><div class="bottomm-text" style="{{bgBottomColor}}"><a class="make-rrxiu" href="http://mp.weixin.qq.com/s?__biz=MzA4ODc5OTE1OQ==&mid=403178211&idx=1&sn=9c50c942df41020d626d50289a75cf16#rd" target="blank"><span style="color:{{leftColor}}">{{leftText}} <span style="color:{{rightColor}}">{{rightText}}</span></span></a></div><a href="javascript:void(0)" class="show-rrxiu-visit" style="color:{{visitColor}};display:{{showVisitCount}}">阅读:{{visitCount}}</a></div>',scroll:!1},display:!0,height:1010,id:1e4,left:0,resize:0,style:"",top:0,type:"html",width:640,zIndex:1}]}},CssAnimationEngine=function(){function a(a,b){a.removeClass(b),d(a)}function b(a,b){var c=["fadeIn","fadeInDown","fadeInUp","fadeInLeft","fadeInRight","fadeInRightUp","fadeInLeftUp","fadeInRightDown","fadeInLeftDown","bounceIn","bounceInDown","bounceInUp","bounceInLeft","bounceInRight","bounceInRightUp","bounceInLeftUp","bounceInRightDown","bounceInLeftDown","rotateIn","rotateInRight","rotateInLeft","rotateInLeftDown","rotateInLeftUp","rotateInRightDown","rotateInRightUp","zoomIn","bigIn","moveInDown","moveInUp","moveInLeft","moveInRight","flipInX","flipInY","flipInHorizontal","flip3d","lightSpeedInRight","lightSpeedInLeft","boingIn","perspectiveLeftRetourn","perspectiveRightRetourn","perspectiveDownRetourn","perspectiveUpRetourn","stretchRight","stretchLeft","pullUp","pullDown"];c.indexOf(b)>-1&&a.css("display","block")}function c(a,b){var c=["fadeIn","fadeInDown","fadeInUp","fadeInLeft","fadeInRight","fadeInRightUp","fadeInLeftUp","fadeInRightDown","fadeInLeftDown","bounceIn","bounceInDown","bounceInUp","bounceInLeft","bounceInRight","bounceInRightUp","bounceInLeftUp","bounceInRightDown","bounceInLeftDown","rotateIn","rotateInRight","rotateInLeft","rotateInLeftDown","rotateInLeftUp","rotateInRightDown","rotateInRightUp","zoomIn","bigIn","moveInDown","moveInUp","moveInLeft","moveInRight","flipInX","flipInY","flipInHorizontal","flip3d","lightSpeedInRight","lightSpeedInLeft","boingIn","perspectiveLeftRetourn","perspectiveRightRetourn","perspectiveDownRetourn","perspectiveUpRetourn","stretchRight","stretchLeft","pullUp","pullDown"];c.indexOf(b)>-1&&a.css("display","none")}function d(a){a.css({animation:"","animation-name":"","animation-duration":"","animation-timing-function":"","animation-delay":"","animation-iteration-count":""}),a.css({"-webkit-animation":"","-webkit-animation-name":"","-webkit-animation-duration":"","-webkit-animation-timing-function":"","-webkit-animation-delay":"","-webkit-animation-iteration-count":""})}function e(a,b,c,d,e,f){return a+"s "+b+" "+c+"s "+d+" "+e+" "+f}function f(f,g,h,i,j,k,l,m){if(""!==g){(void 0===h||null===h||isNaN(parseFloat(h)))&&(h=0),(void 0===i||null===i||isNaN(parseFloat(i)))&&(i=1),(void 0===j||null===j||isNaN(parseFloat(j)))&&(j=0),(void 0===k||null===k||isNaN(parseFloat(k)))&&(k=0),l=l||!1;var n=f.attr("class");c(f,g),f.removeClass(g),d(f);var o=0;l&&(o=h);var p="both",q="ease",r=1;setTimeout(function(){if(b(f,g),m===!0)f.addClass(g);else{if(n){var c=n.split(" "),d=0;if($.each(c,function(a,b){""!==$.trim(b)&&(d+=1)}),d>2){var k=c[0]+" "+c[1];f.attr("class",k)}}f.addClass(g)}-1==j?(q="linear",r="infinite"):r=0===j?1:j,m&&"infinite"==r&&(r=1),l!==!1&&(h=0);var o=e(i,q,h,r,p,g);f.css("-webkit-animation",o),f.css("animation",o),f.css("-webkit-animation-name",o+" !important"),f.css("animation-name",o+" !important"),m===!0&&f.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a(f,g)})},o)}}function g(f,g,h){function i(f,g,h){if(j<g.length){var k=g[j],l=k.name,m=k.delay,n=k.duration,o=k.repeat,p="both",q="ease",r=1;-1==o?(q="linear",r="infinite"):r=0===o?1:o,h&&"infinite"==r&&(r=1),c(f,l),f.removeClass(l),d(f),b(f,l),f.addClass(l);var s=e(n,q,m,r,p,l);f.css("-webkit-animation",s),f.css("animation",s),f.css("-webkit-animation-name",s+" !important"),f.css("animation-name",s+" !important"),f.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){h&&a(f,l),j++,i(f,g,h)})}}var j=0;i(f,g,h)}return{animation:f,animationList:g}}();!function(){function a(a,b){a.constructor===String&&(a=[a]);for(var d=0;d<a.length;d++)-1===a[d].indexOf("?")&&(a[d]=a[d]+"?v="+appConfig.version);var e=new c(a,b);e.load()}function b(){e=[]}function c(a,b){this.newModuleList=a,this.allCount=a.length,this.tempCount=0,this.callback=b}function d(a,b){this.moduleName=a,this.callback=b}window.require=a,window.clearRequieModuleList=b;var e=[];c.prototype={load:function(){for(var a=this,b=function(b){var c=new d(b,function(){a.tempCount++,a.tempCount===a.allCount&&void 0!==a.callback&&a.callback()});c.load()},c=0;c<a.allCount;c++)b(a.newModuleList[c])}},d.prototype={load:function(){{var a=this;a.moduleName}if(a.isLoad()){var b=a.getModuleInfo();if(b.isLoad)a.callback();else{var c=b.callback;b.callback=function(){c(),a.callback()}}}else{var d=document.createElement("script");d.src=a.moduleName,d.type="text/javascript",document.body.appendChild(d);var f={name:a.moduleName,isLoad:!1,callback:function(){a.callback()}};e.push(f),d.onload=function(){f.callback(),f.isLoad=!0},d.onerror=function(){f.callback(),f.isLoad=!0}}},isLoad:function(){return null===this.getModuleInfo()?!1:!0},getModuleInfo:function(){for(var a=0;a<e.length;a++)if(this.moduleName==e[a].name)return e[a];return null}}}(window);var Cool={share:{title:"",desc:"",image:"",setTitle:function(a){this.title=a},setDesc:function(a){this.desc=a},setImage:function(a){this.image=a}},util:{getUrlParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.href);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getUrlName:function(){if(!(appConfig.viewDomainFormat.indexOf("://{guid}")>-1)){regex=new RegExp(".*/([^&#?/]*)"),results=regex.exec(location);var a="";null!==results&&(a=decodeURIComponent(results[1].replace(/\+/g," ")));var b="",c=a.split("-");return b=2==c.length?c[1]:""}return regex=new RegExp(".*//([^&#?.]*)"),results=regex.exec(location),(null===results||"view"===results[1])&&(regex=new RegExp(".*/([^&#?/]*)"),results=regex.exec(location)),null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},getUrlParaObject:function(a){var b=a.replace(/^\s+/,"").replace(/\s+$/,"").match(/([^?#]*)(#.*)?$/);if(!b)return{};for(var c=b[1],d=c.split("&"),e={},f=0,g=d.length;g>f;f++){var h=d[f];if((h=h.split("="))[0]){var i=decodeURIComponent(h.shift()),j=h.length>1?h.join("="):h[0];void 0!==j&&(j=decodeURIComponent(j)),i in e?(e[i].constructor!=Array&&(e[i]=[e[i]]),e[i].push(j)):e[i]=j}}return e},removeUrlPara:function(a,b){var c=a.lastIndexOf("?"),d=a;if(c>-1){d=a.substr(0,c);var e=this.getUrlParaObject(a),f=[];jQuery.each(e,function(a,c){void 0!==a&&b!==a&&f.push(a+"="+c)});var g=f.join("&");""!==g&&(d+="?"+g)}return d},loadJs:function(a,b){require(a,b)},loadCss:function(a){for(var b=document.getElementsByTagName("head")[0],c=$(b).find("link"),d=0;d<c.length;d++)if(c[d].href===a)return;var e=document.createElement("link");e.href=a+"?v="+appConfig.version,e.rel="stylesheet",b.appendChild(e)},loadCssByStyle:function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.innerHTML=a,b.appendChild(c)},checkIsPc:function(){var a=this.getUrlParameterByName("iframe");if("1"===a)return!1;var b={win:!1,mac:!1,xll:!1},c=navigator.platform;return b.win=0===c.indexOf("Win"),b.mac=0===c.indexOf("Mac"),b.x11="X11"==c||0===c.indexOf("Linux"),b.win||b.mac||b.xll?!0:!1},checkIsPcWithoutIframe:function(){var a={win:!1,mac:!1,xll:!1},b=navigator.platform;return a.win=0===b.indexOf("Win"),a.mac=0===b.indexOf("Mac"),a.x11="X11"==b||0===b.indexOf("Linux"),a.win||a.mac||a.xll?!0:!1},checkIsWeixin:function(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)?!0:!1},checkIsAndroid:function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("android")>-1?!0:!1},checkIsIphone:function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("iphone")>-1?!0:!1},isOrientationHorizontal:function(){return 90===window.orientation||-90===window.orientation},isOrientationVertical:function(){return 180===window.orientation||0===window.orientation},hostStamp:function(a){if(a){var b=window.location.host+appConfig.version;-1===a.indexOf("data:image")&&a.indexOf("http://")>-1&&(a=a.indexOf("?")>-1?a+"&host="+b:a+"?host="+b)}return a},loadImage:function(a,b){try{var c=new Image;if(-1===a.indexOf("data:image")&&(c.crossOrigin="Anonymous"),c.src=Cool.util.hostStamp(a),c.complete)return void(void 0!==b&&b(c));c.onload=function(){void 0!==b&&b(c)},c.onerror=function(){void 0!==b&&b(null)}}catch(d){}},parseJson:function(a){var b={};return a.constructor===String?""!==a&&(b=JSON.parse(a)):b=a,b},getPluginDomain:function(a,b){return appConfig.pluginDomainFormat.replace("{token}",a).replace("{version}",b)+"/"},parsePluginTheme:function(a,b,c){if(!a)return null;void 0===a.length&&(a=[a]);for(var d=[],e=[],f=[],g=0;g<a.length;g++){var h=[],i=a[g];if(!i.list)return;for(var j=0;j<i.list.length;j++){var k=i.list[j];switch(k.type){case"text":if(k.hasOwnProperty("content")){for(var l=[],m=0;m<k.content.length;m++){var n=k.content[m];l[n.key]=n}h[k.key]={bgcolor:k.backgroundColor,content:l}}else h[k.key]=k.backgroundColor;break;case"image":var o="";if(k.src){if(o=k.src,b&&(o+="?host="+b),!c){var p=new Image;b&&(p.crossOrigin="Anonymous"),p.src=o}d.push({id:k.key,src:o})}h[k.key]=o;break;case"audio":var q="";if(k.src){if(q=k.src,b&&(q+="?host="+b),!c){var r=new Audio;b&&(r.crossOrigin="Anonymous"),r.src=q}f.push({id:k.key,src:q})}h[k.key]=q}}e[i.value]=h}return{dict:e,imageManifest:d,audioManifest:f}},getBrowserUrl:function(arg,arg_val,sl){var url=sl||window.location.href,pattern=arg+"=([^&]*)",replaceText=arg+"="+arg_val,newUrl="";if(url.match(pattern)){var tmp="/("+arg+"=)([^&]*)/gi";tmp=url.replace(eval(tmp),replaceText),newUrl=tmp}else newUrl=url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText;return newUrl},getImageThumb:function(a){if("100%"===a)return"";if(a=parseInt(a,10),0>=a||isNaN(a))return"";var b="@!user_image_",c=Math.ceil(a/100);return 10>=c?b+100*c+"x1":"@!user_image_1000x1"},getNowTimeString:function(){var a=new Date,b="-",c=":",d=a.getMonth()+1,e=a.getDate();d>=1&&9>=d&&(d="0"+d),e>=0&&9>=e&&(e="0"+e);var f=a.getFullYear()+b+d+b+e+" "+a.getHours()+c+a.getMinutes()+c+a.getSeconds();return f}},storageUtil:{storage:window.sessionStorage,getMd5Key:function(a){return hex_md5(window.location.host+a)},set:function(a,b){try{this.storage&&this.storage.setItem(this.getMd5Key(a),b)}catch(c){this.clear()}},get:function(a){return this.storage?this.storage.getItem(this.getMd5Key(a)):null},clear:function(){this.storage&&this.storage.clear()},remove:function(a){this.storage&&this.storage.removeItem(this.getMd5Key(a))},isHave:function(a){if(this.storage){for(var b=0;b<this.storage.length;b++)if(this.storage.key(b)===this.getMd5Key(a))return!0;return!1}return!1}},localStorageUtil:{storage:window.localStorage,getMd5Key:function(a){return hex_md5(window.location.host+a)},set:function(a,b){try{this.storage&&this.storage.setItem(this.getMd5Key(a),b)}catch(c){this.clear()}},get:function(a){return this.storage?this.storage.getItem(this.getMd5Key(a)):null},clear:function(){this.storage&&this.storage.clear()},remove:function(a){this.storage&&this.storage.removeItem(this.getMd5Key(a))},isHave:function(a){if(this.storage){for(var b=0;b<this.storage.length;b++)if(this.storage.key(b)===this.getMd5Key(a))return!0;return!1}return!1}},cookie:{get:function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(-1!==b){b=b+a.length+1;var c=document.cookie.indexOf(";",b);return-1===c&&(c=document.cookie.length),unescape(document.cookie.substring(b,c))}}return""},set:function(a,b,c){var d=new Date;d.setTime(d.getTime()+864e5),document.cookie=void 0!==c&&null!==c?a+"="+b+";expires="+d.toGMTString()+";path=/;domain="+c:a+"="+b+";expires="+d.toGMTString()+";path=/"},setWithoutTime:function(a,b,c,d){(void 0===c||null===c)&&(c=3650);var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),document.cookie=void 0!==d&&null!==d?a+"="+b+";expires="+e.toGMTString()+";path=/;domain="+d:a+"="+b+";expires="+e.toGMTString()+";path=/"}}};window.rrxOpenWsiteTime=(new Date).getTime(),window.userReadDepth=1,window.rrxdebug=!1,window.CoolApp={},function(){CoolApp=function(){function wxinit(a){return Cool.util.checkIsWeixin()===!1?(setTimeout(handleShareUrl,2e3),!1):void setTimeout(function(){getWxJsSign(a,"",_dataObj.guid)},500)}function getWxJsSign(a,b,c){getWxJsSignTry+=1,getWxJsSignTry>2||$.get(_host+"wechat/getWxJsSign",{url:a,error:b,wsiteGuid:c},function(b){console.info("getWxJsSign ret",b),0===b.result?(wx.config({debug:!1,appId:b.sign.appId,timestamp:b.sign.timestamp,nonceStr:b.sign.nonceStr,signature:b.sign.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","translateVoice","getNetworkType","chooseImage"]}),wx.ready(function(){console.info("wx.ready"),_dataObj.showShareCount?setTimeout(function(){setWxShareInfo(),fnHackTitle(shareTitle)},1500):(setWxShareInfo(),fnHackTitle(shareTitle)),(_isPreview||1===parseInt(_dataObj.forbidShare)||wsiteInfo.wxp.showShareMenu===!1)&&wx.hideOptionMenu(),console.info("wx.ready end")}),wx.error(function(b){console.info("wx.error"),console.error(b);var d=JSON.stringify(b);d=encodeURIComponent(d),getWxJsSign(a,d,c)})):handleShareUrl()},"json").fail(function(){console.info("getWxJsSign fail"),handleShareUrl()}).always(function(){console.info("getWxJsSign always")})}function listenPopStateEvent(){window.addEventListener("popstate",function(){apiHelper.getAppInstance().closeWsite(function(){window.history.length>2?window.history.back():Cool.util.checkIsWeixin()&&"undefined"!=typeof WeixinJSBridge&&WeixinJSBridge.call("closeWindow")})},!1)}function handleShareUrl(){if(shareUrl){var a=Cool.cookie.get(_log.getVisitFirstLogKey());""!==a&&(shareUrl=Cool.util.getBrowserUrl("from_code",a,shareUrl)),Cool.util.checkIsAndroid()||window.history.pushState({},document.title,shareUrl),shareUrl=shareUrl.replace("mode=official_accounts","mode="),shareUrl=Cool.util.removeUrlPara(shareUrl,"rrxsrc"),setTimeout(function(){listenPopStateEvent()},500)}}function setWxShareInfo(){handleShareUrl(),wx.onMenuShareTimeline({title:shareTitle,link:shareUrl,imgUrl:shareImageUrl,success:function(a){setTimeout(function(){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareTimeline",type:"success"})},100),void 0!==_log&&_log.doShare(2)},cancel:function(a){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareTimeline",type:"cancel"})}}),wx.onMenuShareAppMessage({title:shareTitle,desc:shareDesc,link:shareUrl,imgUrl:shareImageUrl,type:"link",dataUrl:"",success:function(a){setTimeout(function(){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareAppMessage",type:"success"})},100),void 0!==_log&&_log.doShare(3)},cancel:function(a){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareAppMessage",type:"cancel"})}}),wx.onMenuShareQQ({title:shareTitle,desc:shareDesc,link:shareUrl,imgUrl:shareImageUrl,success:function(a){setTimeout(function(){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareQQ",type:"success"})},100),void 0!==_log&&_log.doShare(4)},cancel:function(a){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareQQ",type:"cancel"})}}),wx.onMenuShareWeibo({title:shareTitle,desc:shareDesc,link:shareUrl,imgUrl:shareImageUrl,success:function(a){setTimeout(function(){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareWeibo",type:"success"})},100),void 0!==_log&&_log.doShare(6)},cancel:function(a){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareWeibo",type:"cancel"})}}),wx.onMenuShareQZone({title:shareTitle,desc:shareDesc,link:shareUrl,imgUrl:shareImageUrl,success:function(a){setTimeout(function(){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareQZone",type:"success"})},100),void 0!==_log&&_log.doShare(5)},cancel:function(a){triggerPageEvent(currentPageId,"sysShareCallBack",{method:"onMenuShareQZone",type:"cancel"})}})}function initQQMap(){isLoadQQMap||$.ajax({url:"http://map.qq.com/api/js?v=2.exp&key=QAXBZ-W56RP-WCEDV-LF7WK-PVFE5-TSBAC&callback=qqMapCallback",dataType:"script"}).then(function(a){})}function createQQMap(a,b){if($(a).on("mousedown mousemove mouseup mouseleave touchstart touchmove touchend",function(a){a.stopPropagation()}),_isEditing)loadQQMap(a,b);else if(isLoadQQMap)loadQQMap(a,b);else var c=0,d=setInterval(function(){isLoadQQMap?(loadQQMap(a,b),clearInterval(d)):c>10&&clearInterval(d),c++},500)}function loadQQMap(a,b){var c=new qq.maps.LatLng(b.latlng.lat,b.latlng.lng),d=new qq.maps.Map(a,{panControl:!1,zoomControl:!1,center:c,zoom:b.zoom,mapTypeControlOptions:{mapTypeIds:[]}});qq.maps.event.addListener(d,"click",function(a){window.open(b.url,"_blank")});var e=(new qq.maps.Marker({map:d,position:c}),new qq.maps.Label({position:c,map:d,content:b.title}));e.setStyle({color:"#428bca",borderColor:"#428bca",fontSize:"16px",fontWeight:"bold"})}function getCompositeAttributes(a,b){var c="";return c=handleImgUrl(b?b:a.content.src),{origin:c,mask:a.content.mask?handleImgUrl(a.content.mask):"",rotate:a.content.rotate,zoom:a.content.zoom,offsetX:a.content.offsetX,offsetY:a.content.offsetY,width:a.width,height:a.height,innerWidth:a.content.width,innerHeight:a.content.height}}function parseElement(a,b){var c="position:absolute;",d=a.left||"0",e=a.top||"0",f=(a.right||"0",a.bottom||"0",a.width),g=a.height;if("img"!=a.type&&f>canvasDefaultWidth){try{f=a.width.toFixed(0)}catch(h){f=a.width}g=a.height}c=c+"left:"+d+"px;top:"+e+"px;width:"+f+"px;",-1!=g&&(c=c+"height:"+g+"px;"),void 0!==a.zIndex&&(c=c+"z-index:"+a.zIndex+";");var i="",j="";_isEditing&&(i=" ele-drag ele-resize ele-rotate element-edit ",j=" elem-resize elem-rotate "),_isEditing||a.hasOwnProperty("filter")&&(c+="-webkit-filter:"+a.filter.filter+";filter:"+a.filter.filter+";"),a.hasOwnProperty("display")&&a.display===!1&&(c+="display:none;");var k="element_"+a.id,l="element ";_isPageThumb&&(i="",j="",k="thumb_"+k);var m=$("<div  "+i+' class="'+l+k+" "+j+'"></div>');if(m.attr("style",c),m.css("transform",""),m.css("-webkit-transform",""),m.attr("eletype",a.type),_isPageThumb||m.attr("data-id",a.id),"img"==a.type){var n=$("<img class='element-last' style='-webkit-user-drag: none;width: 100%; height:100%; color: inherit; margin-left: 0px; margin-top: 0px;' />");if(n.attr("src",handleImgUrl(a.content.src)),n.css({width:"100%"==a.content.width?f:a.content.width,height:"100%"==a.content.height?g:a.content.height,"margin-left":a.content.marginLeft,"margin-top":a.content.marginTop}),_isEditing&&a.content.showImageBorder&&""!==a.content.mask&&CompositionImage(getCompositeAttributes(a),n,function(b,c){Cool.storageUtil.set(removeImgPrefix(a.content.src),b),c.attr("src",b)},!0),a.content.showImageBorder&&""!==a.content.border){var o="<img class='element-last-border' src='"+handleImgUrl(a.content.border)+"' style='-webkit-user-drag: none;width: 100%; height:100%; color: inherit; margin-left: 0px; margin-top: 0px;' />";m.html(wrapElement(n,a,o))}else m.html(wrapElement(n,a));if(!_isEditing){var p=n.css("width"),q=n.css("height");if(1===parseInt(a.content.imageType)){if(void 0!==a.content.imageList&&1===a.content.imageList.length){for(var r=a.content.imageList[0].src,s=a.content.imageCount,t=parseInt(p,10),u=[],v=0;s>v;v++)u.push(t*v+"px 0");$.each(u,function(b,c){var d=$("<span/>");d.css({width:p,height:q,left:n.css("margin-left"),top:n.css("margin-top"),position:"absolute",opacity:0,background:"url("+handleImgUrl(r)+") repeat "+c}),a.content.showImageBorder&&""!==a.content.mask&&CompositionImage(getCompositeAttributes(a,r),d,function(a,b){b.css("background-image","url("+a+")")}),m.append(d)})}}else void 0!==a.content.imageList&&$.each(a.content.imageList,function(b,c){var d=$("<span/>");d.css({width:p,height:q,left:n.css("margin-left"),top:n.css("margin-top"),position:"absolute",opacity:0,background:"url("+handleImgUrl(c.src)+") no-repeat 0 0",backgroundSize:p+" "+q}),a.content.showImageBorder&&""!==a.content.mask&&CompositionImage(getCompositeAttributes(a,c.src),d,function(a,b){b.css("background-image","url("+a+")")}),m.append(d)})}}else if("svgShape"==a.type){var w=getSvgFullUrl(a.content.src),x="";if(isLoadedSvg(w)&&(x=getLoadedSvgXml(w)),""!==x){var y=handleSvgDocument(x,a.content);m.html(wrapElement(y,a))}else!function(b){loadSvg(b).then(function(c,d,e){if(4==e.readyState&&200==e.status){isLoadedSvg(b)||pushLoadedSvgKey(b),saveLoadedSvgXml(b,e.responseText);var f=handleSvgDocument(e.responseText,a.content);m.html(wrapElement(f,a))}},function(a){console.error(a)})}(w)}else if("canvas"==a.type)m.html($("<canvas class='element-last' style='width:100%;height:100%;' ></canvas>"));else if("div"==a.type)m.html(wrapElement(a.content,a));else if("input"==a.type){m.attr("inputType",void 0===a.inputType?1:a.inputType),m.attr("required",void 0===a.required?!1:a.required),m.attr("unique",void 0===a.unique?!1:a.unique);var z="",A=parseInt(a.height,10)>60?60:a.height;if(_isEditing)z="<div class='input-outer element-last' data-id=\""+a.id+'" ',z+=' style="line-height:'+A+"px;padding-left: 15px;height:"+a.height+"px;width:"+a.width+'px;"',z+=">"+a.content+"</div>";else{z="<div class='input-outer'>";var B="<textarea class='input-query element-last' data-id=\""+a.id+'"  placeholder="'+a.content+'"';B+=' style="line-height:'+A+"px;height:"+a.height+"px;width:"+a.width+'px;"',void 0!==a.required&&a.required&&(B+=" data-required=true "),void 0!==a.unique&&a.unique&&(B+=" data-unique=true "),B+="></textarea>",z=z+B+"</div>"}m.html(wrapElement($(z),a))}else if("uploadImage"==a.type){var C="";if(_isEditing){C=$("<div  class='uploadImage-outer' style='height:"+a.height+"px'/>");var D="<input type='button' class='uploadImage element-last'  value=\""+a.content.title+'"/>';C.html(D)}else{C=$('<div class="uploadImage-query uploadImage-outer element-last" data-id='+a.id+">"),C.attr({title:a.content.title,"data-required":a.content.required});var E=$("<span >").html(a.content.title);E.css({display:"block","text-align":"center","line-height":a.height+"px"}),C.append(E);var F=$('<input type="file" capture="camera" accept="image/*" placeholder="'+a.content.title+'" >');F.css({position:"absolute",top:0,left:0,opacity:0}),C.append(F),fnAddUploadEvent(C,F,E,a)}m.html(wrapElement(C,a))}else if("smsCheck"==a.type){var G,H="",I=a.height/2-10|0;if(_isEditing){H=$("<div class='smsCheck-outer element-last' style='height:"+a.height+"px' data-id="+a.id+"/>");var J=$('<div class="smsCheck-cap" style=" '+a.style+';top:0;left:0;">').html(a.content.title);G={height:I+"px","line-height":I-5+"px",width:"100%"},J.css(G);var K=$('<div style="position:absolute;bottom:0;left:0;">');K.css(G);var L=$('<div class="smsCheck-cap" style=" '+a.style+';bottom:0;left:0;">').html("验证码");G.width="55%",L.css(G);var M=$('<div class="smsCheck-buttom" style=" '+a.style+';font-size:24px;">').html("获取验证码");G.width="35%",M.css(G),K.append(L),K.append(M),H.append(J),H.append(K)}else{H=$('<div class="smsCheck-query smsCheck-outer element-last" data-id='+a.id+">"),H.attr({title:a.content.title,"data-required":a.content.required});var N=$('<div class="smsCheck-cap" style=" '+a.style+';top:0;left:0;">');G={height:I+"px","line-height":I-5+"px",width:a.width,padding:0},N.css(G);var O=$('<input class="smsPhone element-last" type="tel" placeholder="'+a.content.title+'" style="padding-left: 15px;width:100%;height:100%">');O.attr({"data-unique":a.content.unique}),N.append(O);var P=$('<div style="position:absolute;bottom:0;left:0;">');P.css(G);var Q=$('<div class="smsCheck-cap" style=" '+a.style+';bottom:0;left:0; ">');G.width=.55*a.width,Q.css(G);var R=$('<input class="smsCode element-last" type="tel" placeholder="验证码" style="padding-left: 15px;width:100%;height:100%">');Q.append(R);var S=$('<div class="smsCheck-buttom " style=" '+a.style+';font-size:24px;">'),T=$('<input class="smsButtom element-last" type="button" value="获取验证码" >');G.width=.35*a.width,T.css(G),S.css(G),S.append(T),P.append(Q),P.append(S),H.append(N),H.append(P),fnBindSMSEvent(O,R,T,a)}m.html(wrapElement(H,a))}else if("submit"==a.type){var U=$("<div  class='submit-outer'/>"),V="<input type='button' class='submit element-last'  value=\""+a.content+'"';_isEditing||(V+='style="height:'+a.height+'px;padding:0;"'),V+="/>",U.html(V),m.html(wrapElement(U,a))}else if("video"==a.type){var W="",X=isLiveVideo(a.content.code),Y=parseInt(a.content.type),Z=1===Y&&a.content.embed||0===Y&&X;if(Z&&!_isEditing){var _=a.content.url;0===Y&&X&&(_=a.content.code);var aa=X?"":'type="video/mp4"';W=$('<video x-webkit-airplay="true" y-webkit-airplay="true" webkit-playsinline="true" class="element-last" width="'+a.width+'" height="'+a.height+'">您的浏览器不支持 video 标签。<source src="'+_+'" '+aa+"></video>"),1===parseInt(a.content.touchType)||0===parseInt(a.content.touchType)&&W.attr("controls","controls"),W.attr("preload","auto"),void 0===a.content.poster||X||W.attr("poster",a.content.poster),a.click&&("loop"===a.click.type?W.attr("loop","loop"):""!==a.click.value&&W.on("ended",function(){bindElementEvent(currentPageId,a)}))}else W=$('<div class="video element-last" style="width:100%;height:100%;"/>'),Z&&_isEditing?(W.css("background-color","#000"),void 0===a.content.poster||0===Y&&X?(W.html("嵌入视频区域"),W.css("color","#FFF"),W.css("text-align","center"),W.css("line-height",a.height+"px")):W.css("background-image","url("+a.content.poster+")")):""!==a.content.icon&&W.css("background-image",a.content.icon),m.html(wrapElement(W,a));m.html(wrapElement(W,a))}else if("tel"==a.type||"sms"==a.type){var ba=$('<a  class="anchor element-last" style="cursor: default;width:100%;"/>');ba.css("height",a.height+"px"),ba.css("line-height",a.height+"px"),ba.attr("href",createHref(a.type,a.content.value)),ba.html(a.content.text),m.html(wrapElement(ba,a))}else if("imggroup"==a.type){var ca=$('<div class="slider slider_'+a.id+' element-last" style="width:100%;height:100%;"></div>');_isEditing||ca.attr("id","slider"+a.id),ca.attr("eletype",a.eletype),ca.attr("autoplay",a.autoPlay),ca.attr("playstyle",a.playStyle),ca.attr("showarrow",a.showArrow),ca.attr("leftarrow",a.leftArrow),ca.attr("rightarrow",a.rightArrow);for(var da=a.content?a.content.length:0,ea=0;da>ea;ea++)if(_isEditing){if(0===ea){var fa=(a.width+"px "+a.height+"px",$('<div style="background-color:#fff;background-size: 100% 100%;background-repeat: no-repeat;"></div>'));fa.css("background-image","url("+handleImgUrl(a.content[ea].src)+")"),fa.css({width:"100%",height:"100%"}),ca.append(fa)}}else{var ga=$("<img/>");ga.attr("src",handleImgUrl(a.content[ea].src)),ga.css("width","100%"),ga.css("height","100%"),ca.append(ga)}m.html(wrapElement(ca,a))}else if("shape"==a.type)if("line"==a.content.type){var ha=a.height/2,ia=a.width,ja="0,"+ha+" "+ia+","+ha,ka=void 0===a.content.thickness?2:a.content.thickness,la=void 0===a.content.backgroundColor?"#000":a.content.backgroundColor,ma=getLineStrokeDasharray(a.content.subType,ka),na='<svg id="shape'+a.id+'" width="'+a.width+'" height="'+a.height+'" class="element-last" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline stroke="'+la+'" stroke-width="'+ka+'" points="'+ja+'" stroke-opacity="1" '+ma+"></polyline></svg>";m.html(wrapElement(na,a))}else{var oa=$('<div class="element-last" style="height:100%;width:100%;"></div>');oa.css("-webkit-mask-image","url('"+getShape(a.content.type)+"')"),oa.css("background-color",a.content.backgroundColor),oa.css("-webkit-mask-size","100% 100%"),m.html(wrapElement(oa,a))}else if("html"===a.type){var pa="",qa="";a.content.scroll||_isEditing||(pa='style="overflow:inherit"',qa="height:100%;");var ra=/iphone|ipad/gi.test(navigator.appVersion);a.content.fullscreen&&ra&&(qa+="overflow-y:auto;"),""!==qa&&(qa='style="'+qa+'"');var sa='<div class="element-last" style="width:100%;height:100%;min-height:inherit;word-wrap: break-word;word-break:break-all;font-size:48px">';sa+='<div class="we-canvas" '+pa+">",sa+='<div class="iscroll_html" '+qa+">",sa+="<style>"+getPrefixCss(".we-canvas",a.content.css)+"</style>",sa+=a.content.html,sa+="</div>",m.html(wrapElement(sa,a))}else if("audio"===a.type){var ta=$('<div class="audio element-last" style="width:100%;height:100%;"/>');""!==a.content.icon&&ta.css("background-image",a.content.icon),""!==a.content.url&&createAudioElement(currentPageId,a.id,a),m.html(wrapElement(ta,a))}else if("map"===a.type){var ua="";a.content.embed?(ua=$('<div id="qqmap-'+a.id+'" style="width: 100%;height:100%"></div>'),_isEditing&&ua.css("pointer-events","none"),createQQMap(ua.get(0),a.content)):(ua=$('<a href="javascript:void(0)" target="_blank" class="map element-last" style="width:100%;height:100%;"/>'),""!==a.content.icon&&ua.css("background-image",a.content.icon),""===a.content.url||_isEditing||ua.attr("href",a.content.url)),m.html(wrapElement(ua,a))}else if("interact"===a.type){var va="",wa=a.width/2-10;if(va=$("upload"===a.content.type?"<div class='element-last'><div class='interact-entry' style='top:0px;left:"+wa+"px'> +1</div><div class='interactIcon'><img src='"+handleImgUrl(a.content.imageUrl)+"'><div class='interactCount'>"+a.content.count+"</div></div></div>":"<div class='element-last'><div class='interact-entry' style='top:0px;left:"+wa+"px'> +1</div><div class='interactIcon'><i class='"+a.content.type+"'></i><div class='interactCount'>"+a.content.count+"</div></div></div>"),m.html(wrapElement(va,a)),!_isEditing){var xa=appConfig.rrxiuFontCssHost+"font_"+_dataObj.guid+".css";Cool.util.loadCss(xa);var ya=_dataObj.guid+currentPageId+a.id;""!==Cool.cookie.get(ya)&&m.children().css("color",a.content.selectedColor||"#47B859"),va.unbind().bind(clickEventType,function(b){return void 0===_dataObj.guid?(alert("请发布系统后再操作！"),!1):(""===Cool.cookie.get(ya)&&(Cool.cookie.set(ya,"1"),va.find(".interact-entry").animate({top:-20,opacity:1},800,function(){$(this).fadeOut(400).remove()}),addInteractCount(a)),!1)})}}else if("checkbox"===a.type||"radio"===a.type){var za="checkbox"===a.type?"多选":"单选",Aa=$("<div data-id='"+a.id+"' title='"+a.content.title+"' class='control-outer "+a.type+"-query element-last'></div>");

Aa.html("<div class='title' style='background-color:"+a.content.theme+"'>"+a.content.title+"("+za+")</div>");var Ba=$("<div class='options'></div>");m.html(wrapElement(Aa,a));var Ca=m.children(),Da=Ca.css("borderStyle")||"solid",Ea=Ca.css("borderWidth")||"1px";$.each(a.content.options,function(b,c){var d=Ea+" "+Da+" "+a.content.theme;b===a.content.options.length-1&&(d="none");var e="";e="checkbox"===a.type?"<input title='"+c.value+"' class='option' data-id='"+c.id+"' type='checkbox'>":"<input name='radioname"+a.id+"' title='"+c.value+"' class='option' data-id='"+c.id+"' type='radio'>",Ba.append("<div class='option-group' style='border-bottom:"+d+"'><label class='option-label'>"+e+c.value+"</label></div>")}),Aa.append(Ba),void 0!==a.content.required&&a.content.required&&Aa.attr("data-required",!0),Ca.css("borderWidth",Ea),Ca.css("borderStyle",Da),Ca.css("borderColor",a.content.theme)}else if("rating"===a.type){var Fa="<div class='rate'><span data-id='1' class='"+a.content.type+"'></span><span data-id='2' class='"+a.content.type+"'></span><span data-id='3' class='"+a.content.type+"'></span><span data-id='4' class='"+a.content.type+"'></span><span data-id='5' class='"+a.content.type+"'></span></div>",Ga=$("<div class='rating-query rating-outer element-last' title='"+a.content.title+"' data-id='"+a.id+"'><div class='title'>"+a.content.title+"</div>"+Fa+"</div>");if(!_isEditing){var Ha=appConfig.rrxiuFontCssHost+"font_"+_dataObj.guid+".css";Cool.util.loadCss(Ha);var Ia=Ga.find("."+a.content.type);Ia.on("click",function(){for(var b=parseInt($(this).data("id"))-1,c=null,d=0;5>d;d++)c=$(Ia[d]),d>b?c.is(".selected")&&(c.css("color","inherit"),c.removeClass("selected")):(c.css("color",a.content.selectedColor),c.addClass("selected"))})}void 0!==a.content.required&&a.content.required&&Ga.attr("data-required",!0),m.html(wrapElement(Ga,a)),m.children().css("lineHeight",a.height-6+"px")}else if("select"===a.type){var Ja=$("<div class='select-outer'></div>");if(_isEditing)Ja.html("<div class='editSelect' style='line-height:"+a.height+"px'>"+a.content.title+"<span>▼</span></div>");else{var Ka="<option>"+a.content.title+"</option>";$.each(a.content.options,function(a,b){Ka+="<option>"+b.value+"</option>"});var La=(a.height-(Ja.children().css("font-size")||20))/2-5;Ja.html("<select title='"+a.content.title+"' data-id='"+a.id+"' class='select-query element-last'>"+Ka+"</select><span style='top:"+La+"px'>▼</span>")}void 0!==a.content.required&&a.content.required&&Ja.children().attr("data-required",!0),m.html(wrapElement(Ja,a))}else if("plugin"===a.type){var Ma=$("<div class='element-last' style='width:100%;height:100%;'></div>");pluginIsFull(a.content.sizeType)&&m.css({top:0,left:0}),m.html(wrapElement(Ma,a)),$wePluginClient.render(a,Ma,b,_isPageThumb)}return _isEditing||(m.find(".submit").click(function(){var b=$(this);b.val("正在提交"),setTimeout(function(){submitData(b,a)},100)}),"tel"===a.type&&m.on("click",function(){apiHelper.getAppInstance().interactHit("telephone","")})),_isEditing&&a.hasOwnProperty("filter")&&($(m.find(".element-box")).css("-webkit-filter",a.filter.filter),$(m.find(".element-box")).css("filter",a.filter.filter)),_isEditing||_isPageThumb||a.hasOwnProperty("sensor")&&a.sensor.show&&(m.children(0).css("overflow","visible"),m.children(0).attr("data-depth",a.sensor.depth),m.children(0).addClass("layer")),m}function isLoadedSvg(a){return loadedSvgKey.indexOf(getMd5SvgFullSrc(a))>-1}function pushLoadedSvgKey(a){loadedSvgKey.push(getMd5SvgFullSrc(a))}function saveLoadedSvgXml(a,b){var c=getMd5SvgFullSrc(a);loadedSvgXml[c]=b}function getLoadedSvgXml(a){return loadedSvgXml[getMd5SvgFullSrc(a)]}function getMd5SvgFullSrc(a){return hex_md5(a)}function loadSvg(a){var b=(new Date).getTime();return a+="?timestamp="+b,$.ajax({url:a,type:"GET",xhrFields:{withCredentials:!0}})}function getSvgFullUrl(a){return appConfig.imageHost+a}function handleSvgDocument(a,b){for(var c,d=$(a).length,e=0;d>e;e++)if("svg"==$(a)[e].tagName){c=$(a)[e];break}var f={width:parseFloat(c.getAttribute("width")),height:parseFloat(c.getAttribute("height"))},g="0 0 "+f.width+" "+f.height;c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("preserveAspectRatio","none"),c.removeAttribute("baseProfile"),c.setAttribute("class","element-last"),c.getAttribute("viewBox")||c.setAttribute("viewBox",g);for(var h=$(c),i=h.find("[fill], [style*='fill:']"),j=0;j<b.fillColorList.length;j++)i.eq(j).css({fill:b.fillColorList[j].fill});return h}function isLiveVideo(a){var b=["yiqicam.com"],c=!1;if(a)for(var d=0;d<b.length;d++)if(a.indexOf(b[d])>-1){c=!0;break}return c}function fnAddUploadEvent(a,b,c,d){var e=appConfig.libHost;Cool.util.loadJs([e+"image-upload/exif.min.js",e+"image-upload/ImageFileUpload.min.js"],function(){var e=appConfig.serviceHost,f={fileInput:b.get(0),url:e+"extend/image/uploadImage",onProgress:function(){c.html("正在加载...")},onSelected:function(b,e){d.content.isForm?(fnShowUploadImage(a,d,b),c.html(d.content.title)):e.upload()},onSuccess:function(b){var e="http://image2.weplus.me/"+b.url;fnShowUploadImage(a,d,e),c.html(d.content.title),!d.content.isForm&&d.content.noteValue&&triggerPageEvent(currentPageId,d.content.noteValue,e)},onFailure:function(a){c.html("加载失败"),!d.content.isForm&&d.content.noteValue&&triggerPageEvent(currentPageId,d.content.noteValue,"")}},g=new ImageFileUpload;g.init(f)})}function fnShowUploadImage(a,b,c){var d=a.find("img");if(d&&d.length>0)d.attr("src",c);else{var e=$('<div class="uploadImage">'),f=document.createElement("div");f.style=b.style,e.css({position:"absolute",top:0,left:0,"background-color":f.style.backgroundColor,width:"100%",height:"100%",overflow:"hidden"}),d=$('<img width="100%" />').attr({src:c}),e.append(d),a.prepend(e)}}function fnBindSMSEvent(a,b,c,d){c.unbind().bind("click",function(){if(void 0===_dataObj.guid)return void alert("请发布系统后再操作！");if(!b.data("smsAuth")){var e=a.val();if(!e)return void alert(d.content.title+"不能为空！");var f=/^0?1[3|4|5|7|8][0-9]\d{8}$/;if(!f.test(e))return void alert("手机号码格式不正确！");c.val("已发送"),$.post(_host+"sms/send",{form:{wsiteGuid:_dataObj.guid,sendPhone:e}},function(a){return 0!==a.result?(alert(a.msg),c.val("获取验证码"),void b.data("smsAuth","")):(b.data("smsAuth",a.data.guid),void setTimeout(function(){c.val("获取验证码"),b.data("smsAuth","")},6e4))},"json")}})}function addInteractCount(a){$.post(_host+"interactData/add",{form:{wsiteGuid:_dataObj.guid,pageId:currentPageId,elemId:a.id,name:a.content.name}},function(b){if(0===b.result){var c=apiHelper.getAppInstance().getElement(a.id,currentPageId);if(c.length>0){var d=c.find(".interactCount"),e=parseInt(b.data.count)+parseInt(b.data.water);d.html(e),c.children().css("color",a.content.selectedColor||"#47B859"),bindElementEvent(currentPageId,a)}}},"json")}function setInteractData(a,b){for(var c=0;c<a.length;c++)for(var d=a[c].elementList,e=0;e<d.length;e++)if("interact"===d[e].type){var f=b[_dataObj.guid+a[c].id+d[e].id]||{count:0,water:0};d[e].content.count=parseInt(f.count)+parseInt(f.water)}}function getAllPageInteractData(a){if(void 0===_dataObj.guid)return void a();for(var b=_dataObj.pageList,c="",d=0;d<b.length;d++)for(var e=b[d].elementList,f=0;f<e.length;f++)"interact"===e[f].type&&(c+=b[d].id+","+e[f].id+"|");""!==c?(c=c.substr(0,c.length-1),$.post(_host+"interactData/get",{form:{wsiteGuid:_dataObj.guid,pageElemIds:c}},function(c){if(0===c.result){var d=c.data;setInteractData(b,d)}a()},"json")):a()}function bindElementEvent(a,b,c){if(void 0!==b.click&&""!==b.click&&_isEditing===!1)if(c){viewLinkImage(b,c),playLinkAudio(a,b.id,b,c);var d=getPageObjById(a),e=d.longPage?"mousedown touchstart":"click";c.on(e,function(c){"share"===b.click.type||"menu"===b.click.type||"focus"===b.click.type?_excuteElementEvent(a,b):void 0!==b.click.type&&void 0!==b.click.value&&""!==b.click.value&&_excuteElementEvent(a,b)}),d.longpage&&c.on(e,function(a){a.preventDefault(),a.stopPropagation()})}else"share"===b.click.type||"menu"===b.click.type||"focus"===b.click.type?_excuteElementEvent(a,b):void 0!==b.click.type&&void 0!==b.click.value&&""!==b.click.value&&_excuteElementEvent(a,b)}function _excuteElementEvent(a,b){if("url"==b.click.type)alert("外链暂停访问，请联系人人秀客服，2016-12-10");else if("page"==b.click.type)goToPageById(b.click.value);else if("event"==b.click.type)triggerPageEvent(a,b.click.value);else if("share"===b.click.type)apiHelper.getAppInstance().showShareDialog("");else if("alert"===b.click.type)alert(b.click.value);else if("focus"===b.click.type){if(_dataObj.focusWechat&&"rrx-qrcode.jpg"!==_dataObj.focusWechat.qrcode&&!getCanModifyWechat())return;showFocusWechat()}else"menu"===b.click.type?showTopMenu():"tel"===b.click.type?window.location.href="tel:"+$.trim(b.click.value):"sms"===b.click.type&&(window.location.href="sms:"+$.trim(b.click.value))}function viewLinkImage(a,b){"img"===a.type&&a.click&&""!==a.click.image&&void 0!==a.click.image&&(b.on("touchstart",function(c){c.preventDefault(),b.find(".element-last").attr("src",handleImgUrl(a.click.image))}),b.on("touchend",function(c){c.preventDefault(),b.find(".element-last").attr("src",handleImgUrl(a.content.src))}))}function playLinkAudio(a,b,c,d){c.click&&""!==c.click.audio&&(d.on("mousedown touchstart",function(d){rrxdebug&&console.error("playLinkAudio3",d);var e="link-"+a+"-"+b,f=document.getElementById(e);f?f.play():(f=document.createElement("audio"),f.setAttribute("id",e),f.setAttribute("style","opacity:0;width:1px;height:1px"),f.setAttribute("src",apiHelper.getAppInstance().musicPreFix(c.click.audio)),f.setAttribute("preload",!0),$("#main").append(f),f.play())}),d.on("touchend",function(a){}))}function createHref(a,b){var c="";switch(a){case"tel":c="tel:"+b;break;case"sms":c="sms:"+b}return c}function isPreview(){return void 0===appConfig.preView?!0:1==appConfig.preView}function getShape(a){var b="../images/shape_",c=".png";return"line"!=a?b+a+c:void 0}function getLineStrokeDasharray(a,b){if("solid"==a)return'stroke-dasharray="none"';if("dotted"==a){var c=2*b;return'stroke-dasharray="'+c+","+c+'"'}}function pluginIsFull(a){return a===PLUGIN_SIZE_TYPE.FULL}function pluginIsAuto(a){return a===PLUGIN_SIZE_TYPE.AUTO}function pluginIsFixed(a){return a===PLUGIN_SIZE_TYPE.FIXED}function pluginIsScale(a){return a===PLUGIN_SIZE_TYPE.SCALE}function pluginIsTop(a){return"1"===a}function pluginIsGame(a){return"3"===a||"4"===a}function wrapElement(a,b){var c,d,e;if(_isEditing){var f=$('<div class="element-inner"></div>');e=b.style+"width: 100%; height: 100%;","smsCheck"===b.type&&(e="width: 100%; height: 100%;"),f.attr("style",e),f.css("position",""),f.css("left",""),f.css("top",""),f.css("z-index",""),void 0!==b.rotate&&(f.css("-webkit-transform","rotate("+b.rotate+"deg) translateZ(0)"),f.css("transform","rotate("+b.rotate+"deg) translateZ(0)"));var g=$('<div class="element-box" style="width: 100%; height: 100%;"></div>');return void 0!==b.opacity&&g.css("opacity",b.opacity),"div"===b.type&&(c=$(a),c.has("img").length>0&&(d=c.find("p"),d.css("display","none"),c.find("img").css("display","block")),a=c[0].outerHTML,g.css({padding:b.padding+"px"})),void 0!==arguments[2]&&"img"===b.type?(g.addClass("image-border-two"),g.html(a),g.append(arguments[2])):g.html(a),f.html(g)}var h=$("<div ></div>");return e=b.style+"width: 100%; height: 100%;","smsCheck"===b.type&&(e="width: 100%; height: 100%;"),h.attr("style",e),h.css("position",""),h.css("overflow","hidden"),h.css("left",""),h.css("top",""),h.css("z-index",""),void 0!==b.opacity&&h.css("opacity",b.opacity),void 0!==b.rotate&&(h.css("-webkit-transform","rotate("+b.rotate+"deg) translateZ(0)"),h.css("transform","rotate("+b.rotate+"deg) translateZ(0)")),"div"===b.type&&(c=$(a),c.has("img").length>0&&(d=c.find("p"),d.css("display","none"),c.find("img").css("display","block")),a=c[0].outerHTML),void 0!==arguments[2]&&"img"===b.type?(h.addClass("image-border-two"),h.html(a),h.append(arguments[2])):h.html(a),h}function submitData(a,b){if(!b.hasSubmit){if(b.hasSubmit=!0,null===_dataObj)return b.hasSubmit=!1,void a.val(b.content);$page=a.parents(".pt-page");var c=!1;if($page){var d=$page.data("id"),e=[],f=controlsOrderByTop();$.each(f,function(a,b){var d={result:1,msg:"提交失败"};return"input"===b.type||"select"===b.type?d=getPageInputSelect(b):"checkbox"===b.type||"radio"===b.type?d=getPageCheckRadio(b):"rating"===b.type?d=getPageRating(b):"uploadImage"==b.type&&(d=getPageUploadImage(b)),1===d.result?(e=[],alert(d.msg),c=!0,!1):void e.push(d)});var g=[];if(!c){var h=controlBysmsCheck();$.each(h,function(a,b){var c=getPagesmsCheck(b);return 1===c.result?(alert(c.msg),e=[],g=[],!1):(e.push(c.item),void g.push(c.codeItem))})}if(e.length>0){$.each(e,function(a,b){"uploadImage"==b.type&&b.value.indexOf("data:image")>-1&&fnUplaodImage(b.value,function(a){b.value=a})});var i=JSON.stringify(e),j="";g.length>0&&(j=JSON.stringify(g));var k=_dataObj.guid;$.post(_host+"formdata/add",{form:{wsiteGuid:k,pageId:d,data:i,smsData:j}},function(c){if(0===c.result){$page.find(".input-query").val(""),$page.find(".control-outer .option").attr("checked",!1),$page.find(".rating-outer .rate .selected").css("color","inherit"),$page.find(".rating-outer .rate .selected").removeClass("selected"),$($page.find(".uploadImage-query .uploadImage")).remove();for(var e=$page.find(".select-query"),f=0;f<e.length;f++){var g=e.eq(f);g.val(g.attr("title"))}for(var h=$page.find(".smsCheck-query"),i=0;i<h.length;i++){var j=h.eq(i);j.find(".smsPhone").val("");var k=j.find(".smsCode");k.val(""),k.data("smsAuth",""),j.find(".smsButtom").val("获取验证码")}b.hasSubmit=!1,a.val(b.content),(""===b.click||void 0===b.click)&&(b.click={type:"alert",value:"提交成功"}),bindElementEvent(d,b)}else b.hasSubmit=!1,a.val(b.content),alert(c.msg)},"json")}else b.hasSubmit=!1,a.val(b.content)}}}function fnUplaodImage(a,b,c){var d=appConfig.serviceHost;$.ajax({url:d+"extend/image/uploadImage",type:"POST",data:{imageContent:a},dataType:"json",async:c||!1}).then(function(a){var c="";0===a.result?c="http://image2.weplus.me/"+a.data.url:alert(a.msg),b&&b(c)})}function controlsOrderByTop(){var a=["input","select","checkbox","radio","rating","uploadImage"],b=[];return $.each(a,function(a,c){for(var d=$page.find("."+c+"-query"),e=0;e<d.length;e++){var f=d.eq(e),g=f.data("id"),h=parseInt($page.find(".element_"+g).css("top"),10);b.push({top:h,id:g,type:c,required:f.data("required"),unique:f.data("unique"),value:f.val(),title:f.attr("input"===c?"placeholder":"title")})}}),b.length>1&&b.sort(function(a,c){return a.top-c.top||b.indexOf(a)-b.indexOf(c)}),b}function getPageInputSelect(a){var b=a.type,c=a.id,d=a.required,e=a.value,f=a.title;if(d&&"select"===b&&e===f)return{result:1,msg:f+"至少选择一个选项！"};if("input"===b){var g=/^0?1[3|4|5|7|8][0-9]\d{8}$/,h=/^(\S)+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(d&&""===e)return{result:1,msg:f+"不能为空！"};if(""!==e){if("邮箱"===a.title&&!h.test(e))return{result:1,msg:"输入的邮箱格式不正确！"};if(("手机"===a.title||"手机号"===a.title||"手机号码"===a.title)&&!g.test(e))return{result:1,msg:"输入的手机号码格式不正确！"}}}var i={};return i.id=c,i.value=e===f?"":e,i.type=b,i.unique=a.unique,i}function getPageCheckRadio(a){var b=$page.find(".element_"+a.id).find(".option"),c=!1,d={id:0,value:"",type:a.type};d.id=a.id;for(var e="",f=a.required,g=0;g<b.length;g++){{var h=b.eq(g);h.data("id")}if(h.is(":checked")&&(c=!0,e+=h.attr("title").replace("|"," ")+"|"),f&&!c&&g===b.length-1)return{result:1,msg:a.title+"未选择项目!"}}return d.value=""!==e?e.substring(0,e.length-1):"",d}function getPageRating(a){var b=$page.find(".element_"+a.id),c=b.find(".rate .selected"),d=c.length,e={id:a.id,value:d+"星",type:a.type},f=a.required;return f&&1>d?{result:1,msg:a.title+"未评分!"}:e}function getPageUploadImage(a){var b=$page.find(".element_"+a.id),c=b.find("img"),d="";c&&c.length>0&&(d=c.attr("src"));var e={id:a.id,value:d,type:a.type},f=a.required;return f&&!d?{result:1,msg:a.title+"未上传!"}:e}function controlBysmsCheck(){for(var a=[],b="smsCheck",c=$page.find("."+b+"-query"),d=0;d<c.length;d++){var e=c.eq(d),f=e.data("id"),g=e.find(".smsPhone"),h=e.find(".smsCode");a.push({id:f,type:b,value:g.val(),codeValue:h.val(),codeAuth:h.data("smsAuth"),title:e.attr("title"),unique:g.data("unique")})}return a}function getPagesmsCheck(a){var b="";if(!a.value)return b=a.title+"不能为空！",{result:1,msg:b};if(!a.codeValue)return b=a.title+"验证码不能为空！",{result:1,msg:b};if(!a.codeAuth)return b=a.title+"验证码没有发送！",{result:1,msg:b};var c=/^0?1[3|4|5|7|8][0-9]\d{8}$/;return c.test(a.value)?{item:{id:a.id,value:a.value,type:a.type,unique:a.unique},codeItem:{value:a.value,code:a.codeValue,codeAuth:a.codeAuth}}:(b="手机号码格式不正确！",{result:1,msg:b})}function playAnimation(a,b,c,d,e){var f=null;f=_isEditing?$.extend(!0,{},c):c,e&&!_isEditing?($p=getPageDomById(e),$item=$p.find(".element_"+b)):$item=a.find(".element_"+b);var g=0;if(0===f.delay||_isEditing||void 0!==d&&d!==!1||(g=f.delay),"css"==_animationEngine)-1===f.repeat&&_isEditing||CssAnimationEngine.animation($item,f.name,g,f.duration,f.repeat,f.repeatDelay,d,_isEditing);else{for(var h=0;h<preAnimationList.length;h++)preAnimationList[h].pageId===currentPageId&&preAnimationList[h].elementId===b&&preAnimationList[h].animationName===f.name&&preAnimationList[h].animation.seek(preAnimationList[h].animation.totalDuration());var i=JsAnimationEngine.animation($item,f.name,g,f.duration,f.repeat,f.repeatDelay,d);preAnimationList.push({pageId:currentPageId,elementId:b,animationName:f.name,animation:i})}}function playSecondAnimation(a,b,c,d){setTimeout(function(){playAnimation(a,b.id,c,!0,d)},1e3*c.delay)}function playElement(a,b,c){if(void 0!==b.animationList){for(var d,e=0,f=0,g=0;g<b.animationList.length;g++)d=b.animationList[g],(void 0===d.trigger||0===parseInt(d.trigger))&&(d.duration+d.delay>f&&(f=d.duration+d.delay),e>0&&0!==d.delay?playSecondAnimation(a,b,d,c):playAnimation(a,b.id,d,!1,c),e++);return f}}function getPageObjById(a){if("loadingpage"==a){if(void 0!==_dataObj.loadingpage&&void 0!==_dataObj.loadingpage.title)return _dataObj.loadingpage}else if("sharepage"==a){if(void 0!==_dataObj.sharepage)return _dataObj.sharepage}else if("floorpage"==a){if(void 0!==_dataObj.floorpage)return _dataObj.floorpage}else if("toppage"==a){if(void 0!==_dataObj.toppage)return _dataObj.toppage}else if(void 0!==_dataObj.pageList)for(var b=0;b<_dataObj.pageList.length;b++)if(_dataObj.pageList[b].id==a)return _dataObj.pageList[b];return null}function parsePageBackgroundColor(a,b){var c=$("<div class='pt-page-bg-box' style='width:100%;height:100%;cursor: default;'></div>");if(void 0!==a&&null!==a){var d="#FFFFFF",e=1;void 0!==a.backgroundAlpha&&""!==a.backgroundAlpha&&(e=a.backgroundAlpha/100),void 0!==a.backgroundColor&&""!==a.backgroundColor&&(d=a.backgroundColor),c.css("opacity",e),c.css("background-color",d),b.append(c)}}function parsePageBackground(a){var b=$("<div class='pt-page-bg-box' style='width:100%;height:100%;cursor: default;'></div>");if(void 0===a||null===a)return b;var c=1,d="#FFFFFF";if(void 0!==a.backgroundAlpha&&""!==a.backgroundAlpha&&(c=a.backgroundAlpha/100),void 0!==a.backgroundColor&&""!==a.backgroundColor&&(d=a.backgroundColor),void 0!==a.backgroundImage&&null!==a.backgroundImage&&""!==a.backgroundImage){var e=handleImgUrl(a.backgroundImage);b.css("background-image","url("+e+")"),b.css("background-repeat","no-repeat"),b.css("background-size","cover"),b.css("background-position","center center")}return b.css("opacity",c),b.css("background-color",d),b}function parsePageBackgroundFixMode(a,b){if(void 0!==a&&null!==a){var c=$("<div class='pt-page-bg-box' style='width:100%;height:100%;cursor: default;'></div>"),d=1,e="#FFFFFF";void 0!==a.backgroundAlpha&&""!==a.backgroundAlpha&&(d=a.backgroundAlpha/100),void 0!==a.backgroundColor&&""!==a.backgroundColor&&(e=a.backgroundColor),c.css("opacity",d),c.css("background-color",e),void 0!==a.backgroundImage&&null!==a.backgroundImage&&""!==a.backgroundImage?(b.append(c),parsePageBackgroundImage(a,b)):b.append(c)}}function parsePageBackgroundImage(a,b){if(void 0!==a&&null!==a&&void 0!==a.backgroundImage&&null!==a.backgroundImage&&""!==a.backgroundImage){var c=$("<div class='element element_pagebg'></div>"),d=$('<img class="pagebg_img">'),e=handleImgUrl(a.backgroundImage);if(d.attr("src",e),void 0===a.backgroundView)c.append(d),c.css({position:"absolute",left:0,top:0,zIndex:0}),b.append(c);else{var f="",g=!1;f=_isEditing?window.rrxiuWsiteCrateTime:wsiteInfo.loading.createTime,f&&appConfig.startTimeParseBgImgNew&&f>appConfig.startTimeParseBgImgNew&&(g=!0);var h,i,j,k,l,m,n;if(m=_$canvas.width()/_pt_inner_scale_value,n=_$canvas.height()/_pt_inner_scale_value,g){h=a.backgroundImageNaturalWidth/a.backgroundImageNaturalHeight;var o=1;a.backgroundImageNaturalWidth===a.backgroundView.width?(o=a.backgroundView.width/m,i=m,j=i/h):(o=a.backgroundView.width/m,i=a.backgroundImageNaturalWidth/o,j=i/h),l=void 0===a.backgroundView?0:a.backgroundView.x/o,k=void 0===a.backgroundView?0:a.backgroundView.y/o}else{var p=1010;a.backgroundImageNaturalHeight>=1008&&a.backgroundImageNaturalHeight<=1010?p=1010:a.backgroundImageNaturalHeight>1010?p=1100:a.backgroundImageNaturalHeight>1100&&(p=a.backgroundImageNaturalHeight),h=a.backgroundImageNaturalWidth/a.backgroundImageNaturalHeight;var q=a.backgroundImageNaturalHeight/p;j=p;var r=1;a.backgroundView.height*q<p&&(r=p/a.backgroundView.height*q,j=p*r),i=h*j,k=void 0===a.backgroundView?0:a.backgroundView.y*r/q,k<1/_pt_inner_scale_value&&(k=1/_pt_inner_scale_value),l=void 0===a.backgroundView?0:a.backgroundView.x*r/q,640==a.backgroundView.width&&a.backgroundView.height>1100&&(i=a.backgroundView.width,j=a.backgroundView.height)}d.css({width:i,height:j,marginLeft:-l,marginTop:-k}),c.append(d),c.css({position:"absolute",left:0,top:0,zIndex:0,minWidth:640,height:n,width:m}),b.append(c)}}}function parseEffectElement(a,b){var c=$($.find(".pt-inner .page_"+a));b.zIndex=b.zIndex||1e4;var d=$("<div data-role='pt-page-effect' data-complete='no' class='pt-page-effect-box-"+b.id+"' style='position: absolute;top: 0;left: 0;z-index: "+b.zIndex+";width:100%;height:100%;'></div>");c.append(d),$wePluginClient.render(b,d,a),_allowFlip=!0}function parsePage(a){var b=$("<div class='pt-page-element-list-box' style='width:100%;height:100%;position: absolute;top:0;left: 0;'></div>");if(void 0===a||null===a)return b;if(null!==a&&(void 0===a||void 0===a.elementList))return b;for(var c=0;c<a.elementList.length;c++){var d=a.elementList[c];if("plugin"!==d.type||_isEditing||!(!pluginIsGame(d.content.levelId)&&pluginIsFull(d.content.sizeType)||pluginIsTop(d.content.isTop))){"html"===d.type&&d.content.fullscreen&&(d.left=0,d.top=0,d.width=640,d.height=a.longPage?a.height:1010);var e=parseElement(d,a.id);"submit"!==d.type&&"interact"!==d.type&&"audio"!==d.type&&"video"!==d.type&&bindElementEvent(a.id,d,e),"input"===d.type&&(_isEditing||setInputPlaceholderColor(e.find(".input-query.element-last"),"")),"smsCheck"===d.type&&(_isEditing||(setInputPlaceholderColor(e.find(".smsPhone.element-last"),""),setInputPlaceholderColor(e.find(".smsCode.element-last"),""))),b.append(e)}else parseEffectElement(a.id,d)}var f=$("<div></div>");return a.longPage&&(f.attr("class","iscroll_wrapper"),f.attr("id","iscroll_wrapper"+a.id),b.css("height",a.height)),f.html(b),f}function setInputPlaceholderColor(a,b){a.placeholder({labelMode:!0,labelStyle:{margin:"11px 0 0 6px",color:b},labelAlpha:!0,labelAcross:!0})}function setPageArrowIcon(a){var b=getPageObjById(a);if(b.hasOwnProperty("arrowImgUrl")&&""!==b.arrowImgUrl&&null!==b.arrowImgUrl){var c=handleImgUrl(b.arrowImgUrl);"down"===flipWay?$(".arrow-down p").css("background-image","url("+c+")"):$(".arrow-right p").css("background-image","url("+c+")")}else"down"===flipWay?$(".pt-wrapper .arrow-down p").css("background-image",""):$(".pt-wrapper .arrow-down p").css("background-image","")}function outPage(a,b,c){var d=$("<div></div>");d.css("width",b),d.css("height",c),createWrapper(d),_$canvas=d;var e=d.find(".pt-inner");e.append(_isEditing?'<div class="pt-page pt-page-current pt-page-background-image"></div>':'<div class="pt-page pt-page-current"></div>');var f=e.find(".pt-page");return a.longPage?void 0===a.longPagebgMode||"1"===a.longPagebgMode?(parsePageBackgroundFixMode(a,f),f.append(parsePage(a))):(parsePageBackgroundColor(a,f),f.append(parsePage(a)),parsePageBackgroundImage(a,e.find(".pt-page-element-list-box"))):void 0===a.backgroundImageNaturalWidth||void 0===a.backgroundView?(e.find(".pt-page").append(parsePageBackground(a)),e.find(".pt-page").append(parsePage(a))):(parsePageBackgroundColor(a,f),f.append(parsePage(a)),parsePageBackgroundImage(a,e.find(".pt-page-element-list-box"))),d}function showElement(a){var b=$('div[class^="element element_'+a+'"]');void 0!==b&&b.show()}function CompositionImage(a,b,c,d){var e=d||!1,f=removeImgPrefix(a.origin);if(Cool.storageUtil.isHave(f)&&e)return void c(Cool.storageUtil.get(f),b);var g=0,h=0,i=0,j=0,k=0,l=0,m=a.origin,n=a.mask,o=parseInt(a.rotate)||0;o=o*Math.PI/180;var p=parseFloat(a.zoom)||1,q=parseFloat(a.offsetX)||0,r=parseFloat(a.offsetY)||0,s=0,t=0,u="",v=document.createElement("canvas"),w=v.getContext("2d");Cool.util.loadImage(m,function(d){null===d&&c(m,b),"100%"===a.innerWidth||"100%"===a.innerHeight?(i=d.width,j=d.height):(i=a.innerWidth||d.width,j=a.innerHeight||d.height),g=a.width||i,h=a.height||j,l=(i-g)/2,k=(j-h)/2,v.width=i,v.height=j,s=i/2,t=j/2,w.clearRect(0,0,i,j),""!==n?Cool.util.loadImage(n,function(a){try{w.clearRect(0,0,i,j),w.drawImage(a,l,k,g,h),w.globalCompositeOperation="source-atop",w.save(),w.translate(s,t),w.rotate(o),w.scale(p,p),w.drawImage(d,-s+q,-t+r,i,j),w.restore(),u=v.toDataURL("image/png"),c(u,b)}catch(e){console.error(e.message),c(m,b)}}):c(m,b)})}function handleScaleIfSmallScreen(a){if(!_isPc){var b=$(window).height(),c=1008*_pt_inner_scale_value;if(c>b&&"1"!==$page.attr("data-long")){var d=b/c;_page_element_list_scale_value=d;var e=a||$page.find(".pt-page-element-list-box");e.css("-webkit-transform","scale("+d+")"),e.css("transform","scale("+d+")"),e.css("-webkit-transform-origin","center top"),e.css("transform-origin","center top")}}}function isRegImgSilderTimer(a){for(var b=0;b<regImgSilderTimerRecord.length;b++)if(a==regImgSilderTimerRecord[b].pageId)return!0;return!1}function addRegedImgSilderTimer(a){regImgSilderTimerRecord.push({pageId:a,isReg:!0,silderObject:[]})}function getImgSilderTimerByPage(a){for(var b=0;b<regImgSilderTimerRecord.length;b++)if(a==regImgSilderTimerRecord[b].pageId)return regImgSilderTimerRecord[b];return null}function stopOtherImgSilderTimer(a){for(var b=0;b<regImgSilderTimerRecord.length;b++)if(a!=regImgSilderTimerRecord[b].pageId){if(void 0!==regImgSilderTimerRecord[b]&&void 0!==regImgSilderTimerRecord[b].silderObject)for(j=0;j<regImgSilderTimerRecord[b].silderObject.length;j++)void 0!==regImgSilderTimerRecord[b].silderObject[j]&&regImgSilderTimerRecord[b].silderObject[j].stop()}else if(void 0!==regImgSilderTimerRecord[b]&&void 0!==regImgSilderTimerRecord[b].silderObject)for(j=0;j<regImgSilderTimerRecord[b].silderObject.length;j++)void 0!==regImgSilderTimerRecord[b].silderObject[j]&&regImgSilderTimerRecord[b].silderObject[j].start()}function stopAllImgSilderTimer(){for(var a=0;a<regImgSilderTimerRecord.length;a++)if(void 0!==regImgSilderTimerRecord[a]&&void 0!==regImgSilderTimerRecord[a].silderObject)for(var b=0;b<regImgSilderTimerRecord[a].silderObject.length;b++)void 0!==regImgSilderTimerRecord[a].silderObject[b]&&regImgSilderTimerRecord[a].silderObject[b].stop()}function regImgSilderTimer(a){if(pageId=a,stopOtherImgSilderTimer(pageId),!isRegImgSilderTimer(pageId)){addRegedImgSilderTimer(pageId);var b=$page.find(".slider");$.each(b,function(a,b){var c=$(b),d=c.attr("id");if(void 0!==d){var e=d.replace("slider",""),f=$(".element_"+e),g=parseInt(f.css("width"),10),h=parseInt(f.css("height"),10),i="#"+d,j=c.attr("playstyle"),k=c.attr("autoplay")===!0||"true"==c.attr("autoplay")||"autoplay"==c.attr("autoplay"),l=c.attr("showarrow")===!0||"true"===c.attr("showarrow"),m=c.attr("leftarrow");m&&(m=handleImgUrl(m));var n=c.attr("rightarrow");n&&(n=handleImgUrl(n));var o;if(k){o=new flux.slider(i,{pagination:!1,autoplay:!0,controls:l,prevButton:m,nextButton:n,transitions:[j],width:g,height:h,delay:2e3});var p=getImgSilderTimerByPage(pageId);null!==p&&p.silderObject.push(o)}else o=new flux.slider(i,{pagination:!1,autoplay:!1,controls:!0,prevButton:m,nextButton:n,transitions:[j],width:g,height:h})}})}}function regImgPlayTimer(a){var b=getPageObjById(a||currentPageId);if(null!==b){if(clearRegIntervals(),void 0===b.elementList)return;var c=b.elementList;$.each(c,function(a,c){"img"===c.type&&c.content.constructor===Object&&regImgElementEvent(b.id,c.id,c.content)})}}function resetElementLastImg(a,b){b===!0?a.css("display","block"):a.css("display","none")}function regImgElementEvent(a,b,c){var d=apiHelper.getAppInstance().getElement(b,a),e=arguments[3]||null,f=d.find("span");if(c.showAnimation&&f.length>0){var g=d.find(".element-last");resetElementLastImg(g,!0),$.each(f,function(a,b){$(b).css("opacity",0)});var h=null;1===parseInt(c.touchType)?(d.bind(clickEventType,function(d){d.preventDefault(),d.stopPropagation(),setTimeout(function(){null===h&&($(f[0]).css("opacity",1),resetElementLastImg(g,!1),h=new ImgPlayTimer,h.setCount(0),h.setPageId(a),h.setElemId(b),h.setImgList(f),h.setContent(c),h.playImgList())},1e3*c.playDelay)}),d.bind("mouseup mouseleave touchend",function(a){a.preventDefault(),a.stopPropagation()})):0===parseInt(c.touchType)?setTimeout(function(){$(f[0]).css("opacity",1),resetElementLastImg(g,!1),h=new ImgPlayTimer,h.setCount(0),h.setPageId(a),h.setElemId(b),h.setImgList(f),h.setContent(c),h.playImgList()},1e3*c.playDelay):2===parseInt(c.touchType)&&null!==e?setTimeout(function(){$(f[0]).css("opacity",1),resetElementLastImg(g,!1),h=new ImgPlayTimer,h.setCount(0),h.setPageId(a),h.setElemId(b),h.setImgList(f),h.setContent(c),h.playImgList()},1e3*c.playDelay):"3"===c.touchType&&(startShake(),window.addEventListener("shake",function(d){stopShake(),setTimeout(function(){$(f[0]).css("opacity",1),resetElementLastImg(g,!1),h=new ImgPlayTimer,h.setCount(0),h.setPageId(a),h.setElemId(b),h.setImgList(f),h.setContent(c),h.playImgList()},1e3*c.playDelay)},!1),setTimeout(function(){startShake()},2e3))}}function ImgPlayTimer(){this.count=0,this.pageId=-1,this.elemId=-1,this.content=null,this.imgList=[]}function clearAllCustomIntervals(){for(var a=0;a<customIntervals.length;a++)window.clearInterval(customIntervals[a]);stopAllImgSilderTimer()}function clearRegIntervals(a,b){a&&b?$.each(regIntervals,function(c,d){a===d.pageId&&b===d.elemId&&window.clearInterval(d.interval)}):$.each(regIntervals,function(a,b){window.clearInterval(b.interval)})}function createAudioElement(a,b,c){var d="audio-"+a+"-"+b,e=document.getElementById(d);if(!e){var f=apiHelper.getAppInstance().musicPreFix(c.content.url);e=document.createElement("audio"),e.setAttribute("id",d),e.setAttribute("style","opacity:0;width:1px;height:1px"),e.setAttribute("src",f),e.setAttribute("preload",!0),c.click?"loop"===c.click.type?e.setAttribute("loop","loop"):""!==c.click.value&&$(e).on("ended",function(){bindElementEvent(a,c)}):c.content.loop&&e.setAttribute("loop",c.content.loop),$("#main").append(e)}}function switchAudioPlay(a,b){var c=document.getElementById("audio-"+a+"-"+b);rrxdebug&&console.log("switchAudioPlay",c),c&&(c.paused?c.play():c.pause())}function regAudioEvent(a,b,c,d){var e=d||null,f=apiHelper.getAppInstance().getElement(b,a),g=c.delay||0;g=1e3*g,"0"===c.touchType?f.unbind(clickEventType).bind(clickEventType,function(c){setTimeout(function(){switchAudioPlay(a,b)},g)}):"1"===c.touchType?setTimeout(function(){switchAudioPlay(a,b)},g):"2"===c.touchType&&null!==e?setTimeout(function(){switchAudioPlay(a,b)},g):"3"===c.touchType&&(startShake(),window.addEventListener("shake",function(c){stopShake(),setTimeout(function(){switchAudioPlay(a,b)},g),setTimeout(function(){startShake()},2e3)},!1))}function regAudioPlayTimer(a){var b=getPageObjById(a||currentPageId);if(null!==b){if(void 0===b.elementList)return;

var c=b.elementList;$.each(c,function(a,c){"audio"===c.type&&regAudioEvent(b.id,c.id,c.content)})}}function createVideoClose(a){var b=$('<div class="close-mask" id="close_'+a+'">×</div>');b.click(function(){apiHelper.getAppInstance().resetFlip(!0),$("#mask_"+a).remove(),$("#close_"+a).remove(),showMusicIcon(),musicIsPlayWhenPlayVideo&&playMusic(),showElement(a)}),$page.append(b)}function createVideoPlay(a,b){var c=$('<div class="video-mask" id="mask_'+a+'"></div>'),d="",e=isLiveVideo(b.code),f=0===parseInt(b.type)&&e;1===parseInt(b.type)||f?(1===parseInt(b.type)&&apiHelper.getAppInstance().stopFlip(),d=$("<video autoPlay controls></video>"),d.attr("type","video/mp4"),d.attr("id","video_"+a),d.attr("src",b.url),d.css({position:"absolute",height:"50%",width:"100%",top:"22%"})):(apiHelper.getAppInstance().stopFlip(),d=$(b.code).css({position:"absolute",top:"22%"}),d.attr("id","vif_"+a),d.attr("width","100%"),d.attr("height","50%"),d.attr("frameborder",0)),c.html(d),$page.append(c)}function removeAllVideo(){$(".video-mask").remove(),$(".close-mask").remove(),$('div[eletype="video"]').show(),showMusicIcon()}function createVideoControl(a,b){createVideoPlay(a,b),createVideoClose(a,b)}function createVideoElement(a,b,c){if($item=apiHelper.getAppInstance().getElement(b),isPreview()){musicIsPlayWhenPlayVideo=$iconMusic.hasClass("music-play")||$iconMusic.hasClass("music-play-none"),stopMusic(),hideMusicIcon();var d=parseInt(c.type);if(c.embed&&1===d||0===d&&isLiveVideo(c.code)){var e=$item.find(".element-last").get(0);e.paused?e.play():e.pause(),apiHelper.getAppInstance().resetFlip(!0)}else createVideoControl(b,c)}}function regVideoEvent(a,b,c,d){rrxdebug&&console.log("regVideoEvent",a);var e=d||null,f=apiHelper.getAppInstance().getElement(b,a),g=parseInt(c.touchType),h=getPageObjById(a),i=h.longPage?"mousedown touchstart":"click";0!==g&&0!==parseInt(c.type)&&c.embed?1===g?createVideoElement(a,b,c):c.embed&&2===g&&null!==e&&createVideoElement(a,b,c):f.off(i).on(i,function(d){d.preventDefault(),d.stopPropagation(),createVideoElement(a,b,c)})}function regVideoPlayTimer(a){var b=getPageObjById(a||currentPageId);if(null!==b){if(void 0===b.elementList)return;var c=b.elementList;$.each(c,function(a,c){"video"===c.type&&regVideoEvent(b.id,c.id,c.content)})}}function regAnimationShake(a){for(var b=_dataObj.pageEventList[a||currentPageId],c=function(b,c,d){startShake(),window.addEventListener("shake",function(e){stopShake(),playAnimation(b,c,d,!1,a),setTimeout(function(){startShake()},2e3)},!1)},d=0;d<b.length;d++)"animation"===b[d].type&&2===parseInt(b[d].animation.trigger)&&c(_$canvas,b[d].elementId,b[d].animation)}function startShake(a){a=a||"shake",void 0===myShakeEvent[a]?(myShakeEvent[a]=new Shake({shake:a}),myShakeEvent[a].start()):myShakeEvent[a].start()}function stopShake(a){a=a||"shake",void 0!==myShakeEvent[a]&&myShakeEvent[a].stop()}function regSensorEvent(a){var b=$page.find(".pt-page-element-list-box");if(b&&b.length>0&&b.html().indexOf("data-depth")>-1){new Parallax(b[0])}}function getPageStopflip(a){var b=_$canvas.find(".page_"+a);return"1"===b.attr("data-stopflip")}function regPageStopflipEvent(a){_allowFlipCurrentPage=!getPageStopflip(a),_allowFlip&&_allowFlipCurrentPage?a==lastPageId?hideArrow():showArrow():hideArrow()}function regPageAutoTimeFlipEvent(a){window.clearTimeout(rrxAutoFlipTimer);var b=getPageObjById(a||currentPageId);null!==b&&b.autoFlip&&""!==b.autoFlipTime&&void 0!==b.autoFlipTime&&(rrxAutoFlipTimer=setTimeout(function(){swipeFlipEvent("up",flipWay)},1e3*b.autoFlipTime))}function regPageEndEvent(a){rrxdebug&&console.log("regPageEndEvent in",a),regImgSilderTimer(a),regImgPlayTimer(a),regAudioPlayTimer(a),regVideoPlayTimer(a),regAnimationShake(a),regSensorEvent(a),regPageStopflipEvent(a),regPageAutoTimeFlipEvent(a)}function loopPluginByPage(a,b){rrxdebug&&console.log("loopPluginByPage");for(var c=getPageObjById(a||currentPageId),d=0;d<c.elementList.length;d++){var e=c.elementList[d];"plugin"===e.type&&b(e)}}function loadPluginEvent(a){rrxdebug&&console.log("loadPluginEvent",a),a=a||currentPageId,loopPluginByPage(a,function(b){$wePluginClient.load(a,b)}),resetEmbedVideo(a),hideMenuByOther(a)}function getIndexByArray(a,b,c){c=c||"id";for(var d=a.length-1;d>=0;d--)if(a[d][c]==b)return d;return-1}function hideMenuByOther(a){if(pageIsHaveTopPlugin(!0))return void hideMenuPlugin();if("customer"!==_copyrightFrom&&"na"!==_copyrightFrom){var b=getPageObjById(a);if(null!==b&&b.longPage)return showPluginCopyRight(longPageCopyright),void hideMenuPlugin()}var c=getIndexByArray(_dataObj.pageList,a);return _menuPageIndex>c?void hideMenuPlugin():apiHelper.getAppInstance().isShowPluginCopyright()&&pageIsHaveTopPlugin(!1,"照片投票,抽奖,抽奖20,裂变红包,微信红包,口令红包,问答,装逼神器")?void hideMenuPlugin():void((!base.isLastPage()&&"rrxiu"===_copyrightFrom||"rrxiu"!==_copyrightFrom)&&showMenuPlugin())}function triggerPluginLeaveEvent(a){a=a||currentPageId,loopPluginByPage(a,function(b){$wePluginClient.leave(a,b)}),stopEmbedVideo(a),hideMenuByOther(a);var b=getPageObjById(currentPageId);b.longPage||hidePluginCopyRight()}function stopEmbedVideo(a){a=a||currentPageId,getEmbedVideo(a,function(a){var b=a.find(".element-last").get(0);$(b).remove()})}function resetEmbedVideo(a){a=a||currentPageId,getEmbedVideo(a,function(b,c){var d=parseInt(c.content.type),e=isLiveVideo(c.content.code)&&0===d,f=c.content.url;e&&(f=c.content.code);var g=e?"":'type="video/mp4"',h=$('<video x-webkit-airplay="true" y-webkit-airplay="true" webkit-playsinline="true" class="element-last" width="'+c.width+'" height="'+c.height+'">您的浏览器不支持 video 标签。<source src="'+f+'" '+g+"></video>");1===parseInt(c.content.touchType)||0===parseInt(c.content.touchType)&&h.attr("controls","controls"),h.attr("preload","auto"),void 0===c.content.poster||e||h.attr("poster",c.content.poster),c.click&&("loop"===c.click.type?h.attr("loop","loop"):""!==c.click.value&&h.off().on("ended",function(){bindElementEvent(a,c)})),b.html(wrapElement(h,c))})}function getEmbedVideo(a,b){for(var c=getPageObjById(a),d=0;d<c.elementList.length;d++){var e=c.elementList[d];if("video"===e.type){var f=isLiveVideo(e.content.code),g=parseInt(e.content.type);if(e.content.embed&&1===g||f&&0===g){var h=apiHelper.getAppInstance().getElement(e.id,a);b(h,e)}}}}function getActualPageId(a){var b;b=0!==currentPageId?$pagelist.find(".page_"+currentPageId):$pagelist.find("div.pt-page:not(.ifpage)").first();var c=null;if(-1==a){for(c=b.next();c.hasClass("ifpage")&&(c=c.next(),c.hasClass("pt-page")!==!1););c.hasClass("pt-page")===!1&&(c=$pagelist.find("div.pt-page:not(.ifpage)").first())}else if(-2==a){for(c=b.prev();c.hasClass("ifpage")&&(c=c.prev(),c.hasClass("pt-page")!==!1););c.hasClass("pt-page")===!1&&(c=$pagelist.find("div.pt-page:not(.ifpage)").last())}else 0===a&&(c=$pagelist.find("div.pt-page:not(.ifpage)").first());return null!==c&&(a=c.data("id")),a}function getAnimationIndex(a,b){var c,d="";return b===!0?(c=getPageObjById(a),void 0!==c.flip?d=c.flip.enter:void 0!==flipAnimation.enter&&(d=flipAnimation.enter)):(c=getPageObjById(currentPageId),void 0!==c.flip?d=c.flip.back:void 0!==flipAnimation.back&&(d=flipAnimation.back)),d}function gotoPage(a,b){console.log("gotoPage.........."),goToPageById(b)}function playPage(a,b){if(void 0===b||void 0===b.elementList)return 0;for(var c=-1,d=0,e=0;e<b.elementList.length;e++){var f=b.elementList[e];f.display!==!0&&void 0!==f.display&&_isEditing||(c=playElement(a,f,b.id),"img"===f.type&&"loadingpage"===b.id&&f.content.showAnimation&&regImgElementEvent(b.id,f.id,f.content,f.content.name),c>d&&(d=c))}return d}function playPageByPageId(a){var b=getPageObjById(a);null!==b&&playPage(_$canvas,b)}function createPages(){if(void 0!==_dataObj.pageList){for(var a=_dataObj.pageList,b=0;b<a.length;b++){var c=a[b],d='<div class="pt-page page_'+c.id+'" data-id='+c.id;c.longPage&&(d+=' data-long="1"'),c.stopFlip&&(d+=' data-stopflip="1"'),d+="></div>",$pagelist.append(d)}firstPageId=a[0].id,lastPageId=a[a.length-1].id,totalPages=a.length}}function createWrapper(a){a.html(""),html='<div class="pt-outer"><div class="pt-inner"></div></div>',a.append(html);var b=parseFloat(a.height()/a.width())*canvasDefaultWidth;scale=parseFloat(1*a.width()/canvasDefaultWidth),_pt_inner_scale_value=scale;var c=parseFloat(a.height()/b),d=navigator.userAgent.toLowerCase(),e=97e-5*parseFloat(a.width()/360);d.indexOf("android")>-1&&(c+=e),$outer=a.find(".pt-outer"),$inner=a.find(".pt-inner"),$inner.css("height",b),$inner.css("margin-top",parseFloat(-1*b/2)),$inner.css("-webkit-transform","scale("+scale+","+c+")"),$inner.css("-moz-transform","scale("+scale+","+c+")"),$inner.css("transform","scale("+scale+","+c+")"),$outer.css("height",a.height()),$outer.css("width",a.width())}function createProgress(){$progress.css("position","absolute"),$progress.css("z-index","100"),$progress.css("bottom","0"),$progress.css("left","0"),$progress.css("display","none"),$progress.css("width","100%"),$progress.css("height","7px"),$progress.css("background-color","rgba(0,0,0,.2)"),$(".progress-tip").css("display","none"),$(".page-tip").css("display","none")}function isShowFocusWechat(){return _dataObj.focusWechat&&_dataObj.focusWechat.show?!0:!1}function isShowTopMenu(){return void 0===_dataObj.topMenu?!1:1===parseInt(_dataObj.topMenu.show)}function createTopeMenu(){if(isShowTopMenu()){var a=handleImgUrl(_dataObj.topMenu.icon);$focusButton.attr("src",a),$focusButton.off().on(clickEventType,function(){showTopMenu()}),showEffect($focusButton)}}function formatHref(a){return-1===a.indexOf("http://")&&-1===a.indexOf("https://")&&(a=a.replace("www","http://www")),a}function showTopMenu(){if(void 0!==_dataObj.topMenu){if(0===$topMenuPanel.find(".top-menu-list").length){for(var a='<a class="fw_close" href="javascript:void(0)"><span></span></a><div class="top-menu-list"><div class="scroll-list"><div class="scroll-menu">',b=isShowFocusWechat(),c=_dataObj.topMenu.list,d=0;d<c.length;d++)a+="url"===c[d].type?'<a class="menu-'+c[d].type+'" target="_blank" href="'+formatHref(c[d].href)+'" data-id="'+c[d].value+'">'+c[d].name+"</a>":'<a class="menu-'+c[d].type+'" href="javascript:void(0)" data-id="'+c[d].value+'">'+c[d].name+"</a>",(b||d!==c.length-1)&&(a+='<div class="cut-line"></div>');b&&(a+='<a class="menu-focus" href="javascript:void(0)">关注公众号</a>'),a+="</div></div></div>",a+='<div class="menu-copyright">'+$copyright.html()+"</div>",$topMenuPanel.html(a),(_dataObj.showReport||"customer"!==_copyrightFrom&&"na"!==_copyrightFrom)&&registerReportEvent($topMenuPanel.find(".menu-copyright .show-report"));var e=$topMenuPanel.find(".fw_close");e.off().on(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),displayPanelDialog("up","down","topmenu")});var f=$topMenuPanel.find(".top-menu-list");f.find(".menu-page").off().on("click",function(a){displayPanelDialog("up","down","topmenu");var b=$(this).data("id");setTimeout(function(){if("first"===b)firstPageId!=currentPageId&&apiHelper.getAppInstance().gotoPage(firstPageId);else if("pre"===b)apiHelper.getAppInstance().gotoPrePage();else if("next"===b)apiHelper.getAppInstance().gotoNextPage();else{if(b===currentPageId||"0"===b||0===b)return;apiHelper.getAppInstance().gotoPage(b)}},500)}),b&&f.find(".menu-focus").off().on(clickEventType,function(a){console.log("focus"),a.stopPropagation(),a.preventDefault(),showFocusWechat()})}displayPanelDialog("down","up","topmenu"),loadMenuListByiScroll()}}function loadMenuListByiScroll(){if(null===menuScrollInstance){var a=$topMenuPanel.find(".top-menu-list");menuScrollInstance=new iScroll(a.find(".scroll-list").get(0),{bounce:!1,bounceLock:!1,vScrollbar:!1})}}function createFocusWechat(){if(isShowFocusWechat()&&!isShowTopMenu()&&(!_dataObj.focusWechat||"rrx-qrcode.jpg"===_dataObj.focusWechat.qrcode||getCanModifyWechat())){var a=handleImgUrl(_dataObj.focusWechat.icon);$focusButton.attr("src",a),$focusButton.off().on(clickEventType,function(){showFocusWechat()}),showEffect($focusButton)}}function showFocusWechat(){if(0===$focusPanel.find(".fw-qrcode-box").length){var a=handleImgUrl(_dataObj.focusWechat.qrcode),b='<a href="javascript:void(0)" class="show-common-report">举报</a><a class="fw_close"><span></span></a><div class="fw-qrcode-box"><div class="qr-box"><div class="wxqr"><img src="'+a+'"></div></div><div class="fw-name">'+_dataObj.focusWechat.name+'</div><div class="fw-describe">'+_dataObj.focusWechat.describe+"</div>";$focusPanel.html(b);var c=$focusPanel.find(".fw_close");c.off().on(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),displayPanelDialog("up","down","focus")}),registerReportEvent($focusPanel.find(".show-common-report"))}displayPanelDialog("down","up","focus")}function displayPanelDialog(a,b,c){var d=null;d="danmu"===c?$danmuPanel:"topmenu"===c?$topMenuPanel:$focusPanel,"down"===a?(d.css("display","block"),"100%"===$topMenuPanel.css("top")&&(hideDanmuInfo(),apiHelper.getAppInstance().stopFlip())):(setTimeout(function(){d.css("display","none")},500),"100%"===$topMenuPanel.css("top")&&(resetDanmuInfo(),apiHelper.getAppInstance().resetFlip(!0))),setTimeout(function(){d.removeClass("damu-"+a),d.addClass("damu-"+b)},100)}function closeOnlyPluginDanmu(){onlyPluginDanmu=!1}function isShowDanmu(){return forceOpenDanmu?forceOpenDanmu:_dataObj.danmuLike&&_dataObj.danmuLike.show?!0:!1}function isOldWsite(){return void 0!==_dataObj.danmuLike||_isPreview?!1:!0}function isShowDanmuAnimate(){return forceOpenDanmu?forceOpenDanmu:_dataObj.danmuLike&&_dataObj.danmuLike.showDanmu?!0:!1}function createDanmu(){if(danmuButtonShow&&isShowDanmu()){rrxdebug&&console.info("createDanmu");var a='<span class="like"><span class="imgDiv"></span><span class="num">'+danmu_like_count+'</span></span><span class="comment"><span class="imgDiv"></span><span class="num">'+danmu_comment_count+"</span></span>";$danmuButton.html(a),$danmuButton.off().on(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),showDanmuEvent()}),showEffect($danmuButton)}}function createDanmuPanel(){var a="";_dataObj.hasOwnProperty("danmuLike")&&(_dataObj.danmuLike.showDanmu||(a=" icon-close"));var b='<a class="dm_close"><span></span></a><div class="comment-send-tip"></div><div class="p-buttons"><div class="btn-like"><div class="l-icon"></div><div class="l-txt">喜欢</div><span class="l-tip">'+danmu_like_count+'</span></div><div class="btn-danmu"><div class="l-icon '+a+'"></div><div class="l-txt">弹幕</div></div><div class="btn-share"><div class="l-icon"></div><div class="l-txt">分享</div></div></div><div class="p-publish"><input type="text" placeholder="发布弹幕"> <a href="javascript:void(0)">发布</a></div><div class="p-comments"><div class="comment-list"><div class="scroll-comment"></div></div></div>';"customer"!==_copyrightFrom&&"na"!==_copyrightFrom&&(b+='<div class="p-make"><a href="'+appConfig.copyright.url+'" target="_blank">我也要制作人人秀</a></div>'),b+='<div class="p-copyright">'+$copyright.html()+"</div>",$danmuPanel.html(b),(_dataObj.showReport||"customer"!==_copyrightFrom&&"na"!==_copyrightFrom)&&registerReportEvent($danmuPanel.find(".p-copyright .show-report")),loadCommentListByiScroll(DM_Comment_List)}function showDanmuEvent(){displayPanelDialog("down","up","danmu"),null===danmuiScrollInstance&&(createDanmuPanel(),bindDanmuElementEvent())}function hideDanmuInfo(){(isShowDanmu()||isShowFocusWechat())&&($iconMusic.css("opacity",0),$progress.css("opacity",0),Cool.util.checkIsAndroid()&&stopEmbedVideo(),currentPageId===lastPageId&&hideEffect($copyright),(isShowFocusWechat()||isShowTopMenu())&&$focusButton.hide(),isShowDanmu()&&($danmuButton.hide(),isShowDanmuAnimate()&&Danmaku.stop()))}function pageIsHaveTopPlugin(a,b){var c=getPageObjById(currentPageId),d=c.elementList;b=b||"照片投票";for(var e=0;e<d.length;e++)if(a){if(pluginIsTop(d[e].content.isTop))return!0}else if(b.indexOf(d[e].content.name)>-1)return!0;return!1}function resetDanmuInfo(){if(isShowDanmu()||isShowFocusWechat()||isShowTopMenu()){if($iconMusic.css("opacity",1),$progress.css("opacity",1),Cool.util.checkIsAndroid()&&resetEmbedVideo(),currentPageId===lastPageId&&(currentPageId===lastPageId||_isHaveMenu&&_dataObj.showReport&&"na"===_copyrightFrom)){var a=getPageObjById(currentPageId);(!a.longPage||"rrxiu"!==_copyrightFrom&&"bottom"!==_copyrightFrom)&&showEffect($copyright)}(isShowFocusWechat()||isShowTopMenu())&&$focusButton.show(),isShowDanmu()&&($danmuButton.show(),isShowDanmuAnimate()&&Danmaku.start())}}function bindDanmuElementEvent(){var a=$danmuPanel.find(".p-buttons .btn-share"),b=$danmuPanel.find(".p-buttons .btn-like"),c=$danmuPanel.find(".p-buttons .btn-danmu"),d=$danmuPanel.find(".p-publish a"),e=$danmuPanel.find(".dm_close"),f=$danmuPanel.find(".p-publish input");f.unbind().bind(clickEventType,function(){apiHelper.getAppInstance().weixinStrong.auth(function(a){authUserInfo=a})}),e.unbind().bind(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),$(window).trigger("sysDanmaCloseClick"),displayPanelDialog("up","down","danmu")}),c.unbind().bind(clickEventType,function(){var a=c.find(".l-icon");a.hasClass("icon-close")?(a.removeClass("icon-close"),_dataObj.danmuLike.showDanmu=!0,closeOnlyPluginDanmu(),forceOpenDanmu=!1):(a.addClass("icon-close"),_dataObj.danmuLike.showDanmu=!1)}),b.unbind().bind(clickEventType,function(){sendLikePost();var a=$('<div class="like_icon"></div>');$danmuPanel.append(a),a.css({transform:"translateY(40px) scale(0.5)","-webkit-transform":"translateY(40px) scale(0.5)"}),function(a){setTimeout(function(){a.css({"-webkit-transition":"1.5s ease-out",transition:"1.5s ease-out",transform:"translateY(-120px) scale(1)","-webkit-transform":"translateY(-120px) scale(1)"}),a.get(0).addEventListener("webkitTransitionEnd",function(){$(this).remove()},!1)},0)}(a)}),a.unbind().bind(clickEventType,function(){showSharepage()}),d.unbind().bind(clickEventType,function(){sendComment()})}function getCommentLikeCount(){ajaxPost("like/getCount",{wsiteGuid:_dataObj.guid},function(a){0===a.result?(danmu_like_count=a.data.likeCount,danmu_comment_count=a.data.commentCount,createDanmu()):console.error(a)})}function sendLikePost(){danmu_like_count=parseInt(danmu_like_count)+1;var a=$danmuPanel.find(".p-buttons .btn-like .l-tip"),b=$danmuButton.find(".like .num");a.html(danmu_like_count),b.html(danmu_like_count),setTimeout(function(){ajaxPost("like/add",{wsiteGuid:_dataObj.guid},function(a){0===a.result})},2e3)}function html2Escape(a){return a.replace(/[<>&"]/g,function(a){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[a]})}function sendComment(){if(!isSending){var a=$danmuPanel.find(".p-publish input");if(""===a.val())return void showDanmuTip("评论信息不能为空！");if(Danmaku.getCharacterSize(a.val())>48)return void showDanmuTip("评论信息不能超过25个字符！");if(null===authUserInfo)return void showDanmuTip("微信授权失败，请尝试点击输入框！");isSending=!0,ajaxPost("comment/add",{wsiteGuid:_dataObj.guid,review:_dataObj.danmuLike.review,content:html2Escape(a.val()),wechatOpenId:authUserInfo.id,name:authUserInfo.nickname,photo:authUserInfo.headimgurl},function(b){if(0===b.result){danmu_comment_count=parseInt(danmu_comment_count,10)+1;var c=$danmuButton.find(".comment .num");c.html(danmu_comment_count),a.val(""),showDanmuTip("评论成功 ^_^"),DM_Comment_List.unshift(b.data),Danmaku.refresh(DM_Comment_List),appendCommentToList(b.data)}else showDanmuTip("评论失败 ︶︿︶")})}}function showDanmuTip(a){var b=$danmuPanel.find(".comment-send-tip");b.css("display","block"),b.css("top","4%"),b.html(a),setTimeout(function(){b.css("top","-100px"),isSending=!1,setTimeout(function(){b.css("display","none")},1e3)},700)}function appendCommentToList(a){if(a.createTime||(a.createTime=getNowFormatDate()),!a.hideInList){var b=$danmuPanel.find(".p-comments .comment-list");b.find(".scroll-comment").prepend(getCommentHtml(a))}}function getCommentHtml(a){return a.hideInList?"":a.customCommnetListItem?($citem=$('<div class="cm-content" data-customid="'+a.customId+'" data-photo="'+a.photo+'">'+a.customCommnetListItem+"</div>"),a.customEvent&&$citem.unbind("mousedown touchstart").bind("mousedown touchstart",function(b){b.preventDefault(),b.stopPropagation(),console.info("click",a.customEvent),a.customEvent.clickEvent($citem,a.customData,a.customId)}),$citem):'<div class="cm-content"><img src="'+a.photo+'"><span>'+html2Escape(a.content)+"</span></div>"}function getNowFormatDate(){var a=new Date,b="-",c=":",d=a.getMonth()+1,e=a.getDate();d>=1&&9>=d&&(d="0"+d),e>=0&&9>=e&&(e="0"+e);var f=a.getFullYear()+b+d+b+e+" "+a.getHours()+c+a.getMinutes()+c+a.getSeconds();return f}function stringTime2Time(a){try{if(a){a=a.replace(/-/g,"/");var b=Date.parse(new Date(a));return b/=1e3}return nowTime()}catch(c){return nowTime()}}function nowTime(){var a=Date.parse(new Date);return a/=1e3}function srotDanmuList(a,b){a=a.sort(function(a,b){return b-a});var c=[];return $.each(a,function(a,d){$.each(b,function(a,b){d===b.sort&&(inSortList(c,b)||c.push(b))})}),c}function inSortList(a,b){var c=!1;return $.each(a,function(a,d){d.content===b.content&&d.name===b.name&&d.photo===b.photo&&d.createTime===b.createTime&&(c=!0)}),c}function loadCommentListByiScroll(a){var b=$danmuPanel.find(".p-comments .comment-list");$.each(a,function(a,b){b.sort=stringTime2Time(b.createTime),danmuSortKey.push(b.sort)}),a=srotDanmuList(danmuSortKey,a);for(var c=0;c<a.length;c++)b.find(".scroll-comment").append(getCommentHtml(a[c]));null===danmuiScrollInstance&&(danmuiScrollInstance=new iScroll(b.get(0),{bounce:!1,bounceLock:!1,vScrollbar:!1}))}function getCommentList(){ajaxPost("comment/getCommentList",{wsiteGuid:_dataObj.guid},function(a){0===a.result&&($.each(a.data,function(a,b){DM_Comment_List.push(b)}),isShowDanmu()&&(initDanmu(),isShowDanmuAnimate()&&Danmaku.start()))})}function initDanmu(){var a="horizontal";if(void 0!==_dataObj.danmuLike&&null!==_dataObj.danmuLike&&(a=_dataObj.danmuLike.style),listenVisibilitychange(a),onlyPluginDanmu){var b=[];$.each(DM_Comment_List,function(a,c){c.source&&"plugin"===c.source&&b.push(c)}),Danmaku.init($danmuShow,b,a,DM_Listen_Event)}else Danmaku.init($danmuShow,DM_Comment_List,a,DM_Listen_Event)}function ajaxPost(a,b,c){$.post(_host+a,{form:b},function(a){c(a)},"json")}function listenVisibilitychange(a){document.addEventListener("visibilitychange",function(){if(isShowDanmu()){var a=$danmuPanel.hasClass("damu-up");"hidden"==document.visibilityState?isShowDanmuAnimate()&&Danmaku.stop():isShowDanmuAnimate()&&!a&&currentPageId!==_copyrightId&&Danmaku.start()}}),"horizontal"===a&&DM_Listen_Event.unbind().on("danmuRestart",function(){setTimeout(function(){var a=$danmuPanel.hasClass("damu-up");isShowDanmu()&&isShowDanmuAnimate()&&!a&&currentPageId!==_copyrightId&&!Danmaku.checkIsPlaying()&&(Danmaku.stop(),Danmaku.start())},1e4)})}function renderPage(a){$(".pt-wrapper .arrow-down p").css("background-image","none !important"),$(".pt-wrapper .arrow-down p").css("background-image","none !important"),$page=_$canvas.find(".page_"+a),"sharepage"==a?$page=$sharepage:"loadingpage"==a?$page=$loadingpage:"floorpage"==a?$page=$floorpage:"toppage"==a?$page=$pagewrapper:flipLoadImage(a);var b=null,c=!1;return _dataObj.swipe=void 0,$page.data("isrender")!==!0?("loadingpage"!==a&&pageCodeInit(a,apiHelper.getAppInstance()),pageEventInit(a),$page.data("isrender",!0),b=getPageObjById(a),null!==b&&(c=b.longPage,b.longPage?void 0===b.longPagebgMode||"1"===b.longPagebgMode?(parsePageBackgroundFixMode(b,$page),$page.append(parsePage(b))):(parsePageBackgroundColor(b,$page),$page.append(parsePage(b)),parsePageBackgroundImage(b,$page.find(".pt-page-element-list-box"))):void 0===b.backgroundImageNaturalWidth||void 0===b.backgroundView?($page.append(parsePageBackground(b)),$page.append(parsePage(b))):(parsePageBackgroundColor(b,$page),$page.append(parsePage(b)),parsePageBackgroundImage(b,$page.find(".pt-page-element-list-box"))),b.elementList&&!_isEditing&&$.each(b.elementList,function(a,d){if("html"===d.type&&(c=!d.content.fullscreen&&c,d.content.scroll)){var e=apiHelper.getAppInstance().getElement(d.id,b.id);if(e){console.log("new myHtmlScroll");var f=new iScroll(e.find(".we-canvas").get(0),{checkDOMChanges:!0,bounce:!1,bounceLock:!1,onBeforeScrollStart:function(a){a.stopPropagation()}});iScrollInstances.push({pageId:b.id,elemId:d.id,instance:f})}}}),setTimeout(function(){!_isEditing&&c&&(console.log("new mylongScroll"),rrxScrollLongPage(_dataObj,b))},1))):(_isEditing||loadPluginEvent(a),b=getPageObjById(a),b.elementList&&!_isEditing&&$.each(b.elementList,function(a,c){b.elementList[a].playedAnimation=!1}),c=b.longPage),handleScaleIfSmallScreen(),$.isNumeric(a)||"loadingpage"!==a&&pageCodeLoad(a,apiHelper.getAppInstance()),c}function renderProgress(a,b){for(var c=_dataObj.pageList,d=a,e=0;e<c.length;e++)if(c[e].id===a){d=e+1;break}var f=d/b*100+"%",g=d+"/"+b;$progress.css("display","block"),$(".progress-tip").animate({width:f},700),$(".progress-tip").css("display","block"),$(".progress-tip").css("height","100%"),$(".progress-tip").css("background-color","#08A1EF"),$(".page-tip").html(g),$(".page-tip").css("display","inline-block"),$(".page-tip").css("position","absolute"),$(".page-tip").css("font-size","16px"),$(".page-tip").css("bottom","10px"),$(".page-tip").css("right","10px"),$(".page-tip").css("color","#fff")}function renderCopyright(){_isHaveMenu&&"rrxiu"!==_copyrightFrom&&"bottom"!==_copyrightFrom&&$copyright.css("bottom","70px"),0!==_dataObj.result?createCopyrightWeplus(!0):"customer"===_copyrightFrom?createCopyrightCustomer():createCopyrightWeplus()}function getCopyrightCustomer(){var a=void 0===_dataObj.copyright.content?"":_dataObj.copyright.content,b='<span class="show-copyright">'+createCopyrightHrefConent(_dataObj.copyright.url,a,getCopyrightColor(_dataObj.copyright.color))+"</span>";return b}function createCopyrightCustomer(){$copyright.css("background-color",getCopyrightBgColor(_dataObj.copyright.bgColor)),$copyright.css("color",getCopyrightColor(_dataObj.copyright.color)),$copyright.css("text-align",getCopyrightTextAlign(_dataObj.copyright.textAlign)),$copyright.html(getCopyrightCustomer()),_dataObj.showReport&&($copyright.prepend(getShowReportByWeplus()),registerReportEvent($copyright.find(".show-report"))),_dataObj.showVisitCount&&null!==_log&&!getIsFromTpl()&&setTimeout(function(){0!==_log.getVisitCount()&&$copyright.append('<span class="show-visit">阅读:'+_log.getVisitCount()+"</span>")},1500)}function getShowVisitByWeplus(){var a='<span class="show-visit" ';return _dataObj.flipProgress&&(a+='style="margin-right:40px;margin-bottom:2px;"'),a+=">阅读:"+_log.getVisitCount()+"</span>"}function getShowReportByWeplus(){return'<span class="show-report">举报</span>'}function getShowCopyrightByWeplus(){var a=appConfig.copyright;return'<span class="show-copyright">'+createCopyrightHrefConent(a.url,getCopyrightContent(a.content),getCopyrightColor(a.color))+"</span>"}function createCopyrightWeplus(a){var b="",c=appConfig.copyright,d=getShowReportByWeplus(),e=null;"na"===_copyrightFrom?($copyright.css("background-color",getCopyrightBgColor(c.bgColor)),$copyright.css("color",getCopyrightColor(c.color)),_dataObj.showReport&&($copyright.prepend(d),registerReportEvent($copyright.find(".show-report"))),_dataObj.showVisitCount&&a!==!0&&!getIsFromTpl()&&setTimeout(function(){0!==_log.getVisitCount()&&(b=getShowVisitByWeplus(),$copyright.append(b))},1500)):(b=getShowCopyrightByWeplus(),$copyright.css("background-color",getCopyrightBgColor(c.bgColor)),$copyright.css("color",getCopyrightColor(c.color)),$copyright.css("text-align","center"),a?($copyright.html(b),showCopyright(!0,currentPageId)):(b=d+b,_dataObj.showVisitCount&&null!==_log&&!getIsFromTpl()&&setTimeout(function(){0!==_log.getVisitCount()&&$copyright.append('<span class="show-visit">阅读:'+_log.getVisitCount()+"</span>")},1500),$copyright.html(b),registerReportEvent($copyright.find(".show-report")),e=getPageObjById(currentPageId),showCopyright(e?e.stopFlip:!1,currentPageId)))}function getIsFromTpl(){return Cool.util.getUrlParameterByName("tpl")}function createCopyrightHrefConent(a,b,c){return void 0!==a&&null!==a&&""!==$.trim(a)?'<a href="'+a+'" target="_blank" style="color:'+c+';">'+b+"</a>":b}function getCopyrightTextAlign(a){return"center"}function getCopyrightContent(a){return void 0===a||""===$.trim(a)?"免费制作 → 人人秀":a}function getCopyrightBgColor(a){return"na"===_copyrightFrom?"rgba(255,255,255,0)":void 0===a||""===$.trim(a)?"rgba(0,0,0,0.5)":a}function getCopyrightColor(a){return void 0===a||""===$.trim(a)?"#fff":a}function createPageEventList(){_dataObj.pageEventList={}}function createPageCodes(){_dataObj.pageCodeList={};var pageList=_dataObj.pageList,specialList=["loadingpage","floorpage","sharepage"],pageCode=null;$.each(specialList,function(idx,sid){void 0!==_dataObj[sid]?void 0!==_dataObj[sid].code&&null!==_dataObj[sid].code&&""!==_dataObj[sid].code?eval("_dataObj.pageCodeList['"+_dataObj[sid].id+"']= new function(){"+_dataObj[sid].code+" return this;};"):(pageCode=getCodeByCodeList(sid),null!==pageCode&&eval("_dataObj.pageCodeList['"+pageCode.id+"']= new function(){"+pageCode.code+" return this;};")):"loadingpage"===sid&&(pageCode=getCodeByCodeList(sid),null!==pageCode&&eval("_dataObj.pageCodeList['"+pageCode.id+"']= new function(){"+pageCode.code+" return this;};"))});for(var i=0;i<pageList.length;i++){var pageItem=pageList[i];void 0!==pageItem.code&&null!==pageItem.code&&""!==pageItem.code?eval("_dataObj.pageCodeList['"+pageItem.id+"']= new function(){"+pageItem.code+" return this;};"):(pageCode=getCodeByCodeList(pageItem.id),null!==pageCode&&eval("_dataObj.pageCodeList['"+pageCode.id+"']= new function(){"+pageCode.code+" return this;};"))}showloadingpageCode()}function getCodeByCodeList(a){if(void 0===_dataObj.codeList)return null;var b=_dataObj.codeList,c=null;return $.each(b,function(b,d){return d.id===a?(c=d,!1):void 0}),c}function getPageCodes(a){var b={code:"",plugin:""},c=["loadingpage","floorpage","sharepage"];if($.each(c,function(a,c){void 0!==_dataObj[c]&&(b=_dataObj[c])}),null!==b)for(var d=0;d<_dataObj.pageList.length;d++)a==_dataObj.pageList[d].id&&(b=_dataObj.pageList[d]);return b}function loadExternalJsLibs(a){if(void 0===_dataObj.codeJsLibs)return createPageCodes(),void a();var b=_dataObj.codeJsLibs;return 1===b.length&&""===$.trim(b[0])?(createPageCodes(),void a()):void Cool.util.loadJs(b,function(){createPageCodes(),a()})}function pageCodeInit(a,b){if(void 0!==_dataObj.pageCodeList){var c=_dataObj.pageCodeList[a];void 0!==c&&null!==c&&void 0!==c.init&&null!==c.init&&c.init(b)}}function pageCodeLoad(a,b){if(void 0!==_dataObj.pageCodeList){var c=_dataObj.pageCodeList[a];void 0!==c&&null!==c&&void 0!==c.load&&null!==c.load&&c.load(b)}}function pageEventInit(a){var b=_dataObj.pageEventList[a];(void 0===b||null===b)&&(_dataObj.pageEventList[a]=[],b=_dataObj.pageEventList[a]);var c=getPageObjById(a);if(null!==c){if(!c.hasOwnProperty("elementList"))return;for(var d=0;d<c.elementList.length;d++){var e=c.elementList[d];if(void 0!==e.animationList){for(var f,g=0;g<e.animationList.length;g++)f=e.animationList[g],(1===parseInt(f.trigger)&&""!==f.eventName||2===parseInt(f.trigger))&&b.push({name:f.eventName,type:"animation",elementId:e.id,animation:f});"img"===e.type&&e.content.showAnimation&&b.push({name:e.content.eventName,type:"imageAnimation",elementId:e.id,animation:e.content}),"audio"===e.type&&b.push({name:e.content.eventName,type:"audioEvent",elementId:e.id,animation:e.content}),"video"===e.type&&b.push({name:e.content.eventName,type:"videoEvent",elementId:e.id,animation:e.content})}}}}function triggerPageEvent(a,b,c){var d=_dataObj.pageEventList[a];if(void 0!==_dataObj.pageEventList.floorpage&&(d=d.concat(_dataObj.pageEventList.floorpage)),void 0!==d&&null!==d){for(var e,f={},g=0;g<d.length;g++)e=d[g],e.name==b&&("animation"==e.type?f[e.elementId]?f[e.elementId].push(e.animation):f[e.elementId]=[e.animation]:"imageAnimation"==e.type?(clearRegIntervals(a,e.elementId),regImgElementEvent(a,e.elementId,e.animation,e.name)):"audioEvent"===e.type?regAudioEvent(a,e.elementId,e.animation,e.name):"videoEvent"===e.type?regVideoEvent(a,e.elementId,e.animation,e.name):"customEvent"==e.type&&void 0!==e.callback&&e.callback(c));

for(var h in f)for(var i,j=0,k=0,l=f[h],m=0;m<l.length;m++)i=l[m],(1===parseInt(i.trigger)&&""!==i.eventName||2===parseInt(i.trigger))&&(i.duration+i.delay>k&&(k=i.duration+i.delay),j>0&&0!==i.delay?playSecondAnimation(_$canvas,{id:h},i,a):playAnimation(_$canvas,h,i,!1,a),j++)}}function createCopyRightPage(){try{if(("we+"===_copyrightFrom||"rrxiu"===_copyrightFrom)&&0===_dataObj.result&&!isOldWsite()){var a=appConfig.copyrightPage,b=getCopyrightPageValue("image");null!==b&&(a.backgroundImage=handleImgUrl(getCopyrightPageValue("image")));var c=a.elementList[0].content.html;a.elementList[0].content.html=c.replace("{{shareTitle}}",_dataObj.title).replace("{{shareImageUrl}}",_dataObj.shareImageUrl||defaultShareImageUrl).replace("{{bgBottomColor}}",getCopyrightPageValue("bgBottomColor","background-color:")||"").replace("{{titleColor}}",getCopyrightPageValue("leftColor")||"#888888").replace("{{jubaoColor}}",getCopyrightPageValue("leftColor")||"#888888").replace("{{visitColor}}",getCopyrightPageValue("leftColor")||"#888888").replace("{{leftColor}}",getCopyrightPageValue("leftColor")||"#FFFFFF").replace("{{leftText}}",getCopyrightPageValue("leftText")||_leftCopyrightText).replace("{{rightText}}",getCopyrightPageValue("rightText")||_rightCopyrightText).replace("{{rightColor}}",getCopyrightPageValue("rightColor")||"#fdea02").replace("{{showVisitCount}}",_dataObj.showVisitCount?"block":"none"),_dataObj.pageList.push(a)}}catch(d){}}function getCopyrightPageValue(a,b){return void 0!==_dataObj.copyrightPage?(b=b||"",null!==_dataObj.copyrightPage&&void 0!==_dataObj.copyrightPage[a]?b+_dataObj.copyrightPage[a]:null):null}function setMusicIcon(a,b){""!==a?$iconMusic.css("background-image","url("+a+")"):(b=b||"on",$iconMusic.css("background-image","url("+appConfig.viewHost+"images/icon_music_"+b+".png)"))}function setMusicPosition(){"rb"===musicPosition?($iconMusic.css("right","6%"),$iconMusic.css("bottom","3%")):"lt"===musicPosition?isShowFocusWechat()?($iconMusic.css("right","6%"),$iconMusic.css("top","3%")):($iconMusic.css("left","6%"),$iconMusic.css("top","3%")):"lb"===musicPosition?($iconMusic.css("left","6%"),$iconMusic.css("bottom","3%")):($iconMusic.css("right","6%"),$iconMusic.css("top","3%"))}function playMusic(){null!==$music?$music.play():""!==musicUrl&&($iconMusic.show(),$music=document.createElement("audio"),$music.setAttribute("src",musicUrl),$music.setAttribute("loop","loop"),$music.setAttribute("preload","true"),$music.setAttribute("autoplay","autoplay"),_$canvas.append($music),$music.play(),$iconMusic.unbind().bind(clickEventType,function(){$music.paused?playMusic():stopMusic()})),null!==$music&&($music.paused?($music.play(),setMusicIcon(musicStopIcon,"off"),$iconMusic.removeClass("music-play"),$iconMusic.removeClass("music-play-none")):(setMusicIcon(musicPlayIcon,"on"),$iconMusic.removeClass("music-play"),$iconMusic.removeClass("music-play-none"),$iconMusic.addClass(""===musicPlayIcon?"music-play":"music-play-none")),$music.paused&&(Cool.util.checkIsWeixin()===!0&&"undefined"!=typeof WeixinJSBridge&&WeixinJSBridge.invoke("getNetworkType",{},function(a){$music.paused&&playMusic()}),$(document).unbind().bind(clickEventType,function(){$(document).unbind(),$music.paused&&playMusic()})))}function stopMusic(){null!==$music&&($music.paused||$music.pause(),setMusicIcon(musicStopIcon,"off"),$iconMusic.removeClass("music-play"),$iconMusic.removeClass("music-play-none"))}function hideMusicIcon(){$iconMusic.hide()}function showMusicIcon(){null!==$music&&$iconMusic.show()}function getLoadingImageList(a){var b=[],c=0;if(_preloadAllResource){var d=_dataObj.pageList;for(c=0;c<d.length;c++)b=getImageListByPage(d[c]),d[c]!=a&&loadImgList(b,1)}else{var e=getPageObjById(a);b=getImageListByPage(e)}return b}function updateLoadingPercent(a){$loadingpage.find(".line").css("width",a+"%"),$loadingpage.find(".percent").html(a+"%")}function filterUserImage(a){return a.indexOf(".gif")>-1||a.indexOf(".GIF")>-1||a.indexOf("@!user_image_")>-1||a.indexOf("data:image")>-1?!1:!0}function getImageListByPage(a){var b=[];if(null!==a){for(var c=[],d="",e=0;e<a.elementList.length;e++){var f=a.elementList[e].content;if("img"===a.elementList[e].type){var g=f.width||0;if(f.showImageBorder||(d=handleImgUrl(f.src),filterUserImage(d)&&(d+=Cool.util.getImageThumb(g),f.src=d),b.push(d)),f.showAnimation&&(c=f.imageList,void 0!==c))for(var h=0;h<c.length;h++)d=handleImgUrl(c[h].src),filterUserImage(d)&&(d+=Cool.util.getImageThumb(g),c[h].src=d),b.push(d)}if("imggroup"===a.elementList[e].type){c=f;for(var i=0;i<c.length;i++){var j=a.elementList[e].width;d=handleImgUrl(c[i].src),filterUserImage(d)&&(d+=Cool.util.getImageThumb(j),c[i].src=d),b.push(d)}}"svgShape"===a.elementList[e].type&&b.push(getSvgFullUrl(f.src))}""!==a.backgroundImage&&void 0!==a.backgroundImage&&(d=handleImgUrl(a.backgroundImage),filterUserImage(d)&&(d+=Cool.util.getImageThumb(a.backgroundImageNaturalWidth),a.backgroundImage=d),b.push(d))}return b}function getLoadingBorderPluginList(){for(var a,b=_dataObj.pageList,c=[],d=[],e=[],f=!1,g=0;g<b.length;g++)for(var h=b[g].elementList,i=0;i<h.length;i++)if("img"===h[i].type){var j=h[i].content,k=j.width||0;if(h[i].content.showImageBorder){var l="";j.src=handleImgUrl(j.src),filterUserImage(j.src)&&(j.src+=Cool.util.getImageThumb(k)),""!==j.border&&void 0!==j.border&&(l=handleImgUrl(j.border),filterUserImage(l)&&(l+=Cool.util.getImageThumb(k)),j.border=l),""!==j.mask&&void 0!==j.mask&&(l=handleImgUrl(j.mask),filterUserImage(l)&&(l+=Cool.util.getImageThumb(k)),j.mask=l),c.push({pageId:b[g].id,elemId:h[i].id,content:j,width:h[i].width,height:h[i].height})}}else"plugin"===h[i].type?(a=Cool.util.getPluginDomain(h[i].content.token,h[i].content.version)+"index.js",-1===e.indexOf(a)&&d.push({element:h[i],token:h[i].content.token,version:h[i].content.version,url:a})):"map"===h[i].type&&h[i].content.embed&&(f=!0);return f&&initQQMap(),{borderList:c,pluginList:d}}function loading(a,b,c){var d=getLoadingBorderPluginList(),e=d.borderList,f=d.pluginList,g=500;void 0!==_dataObj.loadingpage&&void 0!==_dataObj.loadingpage.delay&&(g=1e3*_dataObj.loadingpage.delay);var h=a.length+e.length+f.length,i=0;if(0===h){var j=setInterval(function(){_allowFlip===!0&&(clearInterval(j),setTimeout(function(){$loadingpage.addClass("pt-page-fadeOut animated"),setTimeout(function(){$loadingpage.hide()},500),c()},g))},10),k=g+500+10;updatePerForNoImg(k,b)}else{for(var l=!1,m=function(){percent=parseInt(i/h*100,10),percent>100&&(percent=100),b(percent);var a=f.length>0?100:96;if(percent>=a&&l===!1){l=!0;var d=setInterval(function(){_allowFlip===!0&&(clearInterval(d),setTimeout(function(){$loadingpage.hasClass("pt-page-fadeOut")===!1&&($loadingpage.addClass("pt-page-fadeOut animated"),setTimeout(function(){$loadingpage.hide()},500),c())},g))},10)}},n=function(){i++,m()},o=function(a){var b=getCompositeAttributes(a);CompositionImage(b,a.pageId+"-"+a.elemId,function(b,c){Cool.storageUtil.set(removeImgPrefix(a.content.src),b),i++,m();for(var d=c.split("-"),e=parseInt(d[0]),f=parseInt(d[1]),g=_dataObj.pageList,h=0;h<g.length;h++)if(g[h].id===e)for(var j=g[h].elementList,k=0;k<j.length;k++)if(j[k].id===f){j[k].content.src=b;break}},!1)},p=function(a){loadSvg(a).then(function(b,c,d){4==d.readyState&&200==d.status&&(isLoadedSvg(a)||pushLoadedSvgKey(a),saveLoadedSvgXml(a,d.responseText)),n()},function(a){console.error(a),n()})},q=0;q<e.length;q++)o(e[q]);for(var r=0;r<a.length;r++)if(src=a[r],src.indexOf(".svg")>-1)p(src);else{var s=new Image;s.src=src,s.onload=n,s.onerror=n}var t=[],u=function(a){if(a&&"0"!=a.length){rrxdebug&&console.log("预加载插件js");var b=a.shift();t.indexOf(b.url)>-1?(i++,m(),u(a)):(t.push(b.url),Cool.util.loadJs(b.url,function(){$wePluginClient.add(b.token,b.version,window.wePluginInit,window.wePluginLoad,window.wePluginPreLoad,window.wePluginLeave),$wePluginClient.preload(b.element),i++,m(),u(a)}))}};u(f)}}function updatePerForNoImg(a,b){var c=100/a,d=1,e=setInterval(function(){b(d),d>=100&&(d=100,clearInterval(e)),d++},c)}function flipLoadImage(a){var b=_$canvas.find(".page_"+a);if(b.data("isrender")!==!0){var c=0,d=[],e=_dataObj.pageList;if(void 0!==e){var f;for(c=0;c<e.length;c++)if(f=e[c],f.id==a){c>0&&d.push(e[c-1].id),c<e.length-1&&d.push(e[c+1].id);break}for(c=0;c<d.length;c++)if(b=_$canvas.find(".page_"+d[c]),b.data("isrender")!==!0){f=getPageObjById(d[c]);var g=getImageListByPage(f);d[c]==a?loadImgList(g,0):loadImgList(g,1)}}}}function loadImgList(a,b){var c=0,d="";if(0===b)for(c=0;c<a.length;c++){d=a[c];var e=new Image;e.src=d}else setTimeout(function(){for(c=0;c<a.length;c++){d=a[c];var b=new Image;b.src=d}},500)}function showLoadingpage(){void 0!==_dataObj.llImageUrl&&""!==_dataObj.llImageUrl||_dataObj.showCustomLoadingLogo||void 0!==_dataObj.loadingpage&&void 0!==_dataObj.loadingpage.title&&($loadingpage.html(""),renderPage("loadingpage"),playPageByPageId("loadingpage"))}function showloadingpageCode(){void 0!==_dataObj.loadingpage&&(pageCodeInit("loadingpage",apiHelper.getAppInstance()),pageCodeLoad("loadingpage",apiHelper.getAppInstance()))}function showFloorpage(){void 0!==_dataObj.floorpage&&(renderPage("floorpage"),playPageByPageId("floorpage"))}function showToppage(){void 0!==_dataObj.toppage&&void 0!==_dataObj.toppage.elementList&&_dataObj.toppage.elementList.length>0&&(renderPage("toppage"),playPageByPageId("toppage"))}function showSharepage(){void 0!==_dataObj.sharepage?(renderPage("sharepage"),playPageByPageId("sharepage")):renderDefautShareInfo(),$sharepage.show()}function checkDefautShareInfoSetting(){(void 0===appConfig.shareInfo||null===appConfig.shareInfo)&&(appConfig.shareInfo={color:"#fff",bgColor:"rgba(0, 0, 0, 0.7)",content:'<div style="position:absolute;top:3px;right:10px;font-size:24px;">&uarr;&uarr;&uarr;</div><div style="position:absolute;top:40px;right:10px;font-size:24px;">点我分享</div>'})}function renderDefautShareInfo(){checkDefautShareInfoSetting(),$sharepage.css("background-color",appConfig.shareInfo.bgColor),$sharepage.css("color",appConfig.shareInfo.color);var a=$sharepage.html();$sharepage.html(a+appConfig.shareInfo.content)}function hideSharepage(){$sharepage.hide()}function showReportpage(){_reportInit===!1?(html='<div class="pt-report"><div class="report-title">请选择举报原因</div><hr color="#D3D3D3" width="90%" size="1"/><div class="report-reason"><table><tr><td><input class="reason-input" type="radio" value="谣言" name="report-reason" id="reason1" checked><label for="reason1"> 谣言</label></td></tr><tr><td><input class="reason-input" type="radio" value="色情低俗" name="report-reason" id="reason2"><label for="reason2"> 色情低俗</label></td></tr><tr><td><input class="reason-input" type="radio" value="诱导分享" name="report-reason" id="reason3"><label for="reason3"> 诱导分享</label></td></tr><tr><td><input class="reason-input" type="radio" value="政治敏感" name="report-reason" id="reason4"><label for="reason4"> 政治敏感</label><td></tr><tr><td><input class="reason-input" type="radio" value="侵权" name="report-reason" id="reason5"><label for="reason5"> 侵权（诽谤、抄袭、冒用）</label><td></tr><tr><td><input class="reason-input" type="radio" value="其他" name="report-reason" id="reason6"><label for="reason6"> 其他（收集隐私信息等）</label><td></tr>'+"<tr><td style='padding-top:50px;'><a class='report-submit' >提交</a><a class='report-close'  >取消</a></td></tr></table></div></div>",$reportpage.html(html),$reportpage.css("display","block"),$reportpage.css("position","absolute"),$reportpage.css("z-index","10000"),$reportpage.css("width","100%"),$reportpage.css("height","100%"),_reportInit=!0,$btnSubmit=$reportpage.find(".report-submit"),$btnClose=$reportpage.find(".report-close"),$btnSubmit.bind(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),$reportpage.css("display","none"),alert("举报成功！");for(var b=document.getElementsByName("report-reason"),c="",d=0;d<b.length;d++)b[d].checked&&(c=b[d].value);if(""!==c){var e=_host+"WsiteReport/Add";setTimeout(function(){$.ajax({type:"get",url:e,data:{guid:_dataObj.guid,reason:c},datatype:"script",complete:function(){}})},1e3)}}),$btnClose.bind(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),$reportpage.css("display","none")})):$reportpage.css("display","block")}function suspended(a){void 0===a&&(a="暂停访问"),html='<div class="pt-reportpage page_reportpage" style="display:none"></div><div class="pt-wrapper"><div class="pt-suspended"><div class="msg">'+a+"</div></div><div class=\"copyright\"><a href='http://www.rrxiu.net' target='_blank'><div>使用 <span>人人秀</span> 制作</div></a></div></div>",_$canvas.find(".pt-inner").append(html),_copyrightFrom="rrxiu",$copyright=_$canvas.find(".copyright"),$reportpage=_$canvas.find(".pt-reportpage"),renderCopyright(),showCopyright(!0)}function needCode(a){void 0===a&&(a="需要授权"),html='<div class="pt-wrapper" id="pt-wrapper-needcode"><div class="pt-code"><div class="code-title">'+_dataObj.title+'</div><div class="msg">'+a+"</div><div><table><tr><td><input type='text' name='code' class='code-value' placeholder='输入授权码' /></td></tr><tr><td><input class='code-submit' type='button' value='提交'/></td></tr></table></div><div class=\"copyright\"><a href='http://www.rrxiu.net' target='_blank'><div>使用 <span>人人秀</span> 制作</div></a></div></div>",_$canvas.find(".pt-inner").append(html),$code=_$canvas.find(".code-value"),$btn=_$canvas.find(".code-submit"),$btn.bind(clickEventType,function(){var a=$code.val();if(""!==a){var b=_host+"view/data";$.ajax({type:"post",url:b,data:{id:_dataObj.guid,code:a,preview:isPreview===!0?1:0},datatype:"script",complete:function(){$("#pt-wrapper-needcode").remove(),_log=new WePlusLog(appConfig.serviceHost,_dataObj.guid),base.init(_host,_$canvas,coolData,_isPc,_isWeixin,_log,_isEditing,_isPreview)}})}})}function getCanvasRealHeight(){return parseFloat(_$canvas.height()/_$canvas.width())*canvasDefaultWidth}function initBone(){html='<div class="pt-reportpage page_reportpage" style="display:none"></div><div class="pt-sharepage page_sharepage"></div><img class="focus-wechat-button"><div class="focus-wechat-panel damu-down"></div><div class="focus-plugin-wxqr-panel"></div><div class="top-menu-panel damu-down"></div><a class="danmu-button" href=\'javascript:void(0)\'></a><div class="danmu-panel damu-down"></div><div class="copyright"></div><div class="plugin-copyright"></div><div class="danmu-show"></div><div class="pt-preview-notice">预览模式，仅供测试</div><div class="pt-wrapper"><div class="pt-pagewrapper"><div class="pt-floorpage page_floorpage"></div><div class="pt-pagelist"></div><div class="pt-progress"><span class="progress-tip"></span><span class="page-tip"></span></div></div><div class="arrow-down"><p></p></div><div class="arrow-right"><p></p></div><div class="music"><span class="music1"><s></s></span><span class="music2"><s></s></span><span class="music3"><s></s></span></div></div>',_$canvas.find(".pt-inner").append(html),$previewNotice=_$canvas.find(".pt-preview-notice"),$copyright=_$canvas.find(".copyright"),$pluginCopyright=_$canvas.find(".plugin-copyright"),$pagewrapper=_$canvas.find(".pt-pagewrapper"),$pagelist=_$canvas.find(".pt-pagelist"),$progress=_$canvas.find(".pt-progress"),$floorpage=_$canvas.find(".pt-floorpage"),$loadingpage=_$canvas.find(".pt-loadingpage"),$sharepage=_$canvas.find(".pt-sharepage"),$reportpage=_$canvas.find(".pt-reportpage"),$sharepage.bind(clickEventType,function(){$(this).hide()}),$iconArrowDown=_$canvas.find(".arrow-down"),$iconArrowRight=_$canvas.find(".arrow-right"),$iconMusic=_$canvas.find(".music"),$focusButton=_$canvas.find(".focus-wechat-button"),$focusPanel=_$canvas.find(".focus-wechat-panel"),$topMenuPanel=_$canvas.find(".top-menu-panel"),$danmuButton=_$canvas.find(".danmu-button"),$danmuPanel=_$canvas.find(".danmu-panel"),$danmuShow=_$canvas.find(".danmu-show"),$focusWxQrPanel=_$canvas.find(".focus-plugin-wxqr-panel")}function initSwipe(){var a=!1;setScrollFn(),$pagewrapper.on("mousedown touchstart",function(b){rrxdebug&&console.log("$pagewrapper touchstart"),a=!0,(_allowFlip&&!getPageStopflip(currentPageId)&&pageEffectComplete(currentPageId)||"copyrightPage"===currentPageId)&&scrollStart(b)}),$pagewrapper.on("mousemove touchmove",function(b){rrxdebug&&console.log("$pagewrapper touchmove"),a&&(_allowFlip&&!getPageStopflip(currentPageId)&&pageEffectComplete(currentPageId)||"copyrightPage"===currentPageId?(scrollMove(b),rrxdebug&&console.info("can flip")):rrxdebug&&console.info("cannot flip pid",currentPageId,_allowFlip)),rrxdebug&&console.log("touchmove")}),$pagewrapper.on("mouseup touchend mouseleave",function(b){rrxdebug&&console.log("$pagewrapper touchend",b),a=!1,(_allowFlip&&!getPageStopflip(currentPageId)&&pageEffectComplete(currentPageId)||"copyrightPage"===currentPageId)&&scrollEnd(b)}),$("img").on("dragstart",function(a){a.preventDefault()})}function pageEffectComplete(a){var b=$($.find(".pt-inner .page_"+a));if(!b)return!0;var c=b.find('div[data-role="pt-page-effect"]');return c&&0!==c.length&&"no"===c.attr("data-complete")?!1:!0}function commpletedPageEffect(a){var b=$($.find(".pt-inner .page_"+a));if(b){var c=b.find('div[data-role="pt-page-effect"]');c&&c.attr("data-complete","yes")}}function getCoord(a){if(!a)return!1;left=$pagewrapper.offset().left,top=$pagewrapper.offset().top;var b,c;return("mousedown"==a.type||"mousemove"==a.type)&&(b=a.pageX-left,c=a.pageY-top),("touchstart"==a.type||"touchmove"==a.type)&&(b=a.touches?a.touches[0].pageX:a.originalEvent.touches[0].pageX,c=a.touches?a.touches[0].pageY:a.originalEvent.touches[0].pageY),{x:b/_pt_inner_scale_value,y:c/_pt_inner_scale_value}}function scrollStart(a){if(isSliding=!0,_isDisableFlipPage)rrxdebug&&console.log("_isDisableFlipPage true");else{scrolling||(_$activePage=null),rrxdebug&&console.log("isStart = true"),isStart=!0,isNext=!1,isFirstTime=!0,moveDistanceX=0,moveDistanceY=0;var b=getCoord(a);b&&(startX=b.x,startY=b.y),_$currentPage=_$canvas.find(".page_"+currentPageId).first(),cssAnimation(_$currentPage[0].style,"Transition","none")}}function scrollMove(a){if(enableScroll()){rrxdebug&&console.log("scrollMove");var b=getCoord(a);b&&(moveDistanceX=b.x-startX,moveDistanceY=b.y-startY),setScrollFn(),rrxdebug&&console.log("绑定移动方法"),doScrollMoveFn()}else rrxdebug&&console.log("not scrollMove")}function scrollEnd(a){isSliding=!1,scrolling=!1,rrxdebug&&console.log("isStart",isStart),isStart&&(isStart=!1,rrxdebug&&console.log("_$activePage",_$activePage),_$activePage&&(_isDisableFlipPage=!0,setScrollEndAnim(),setScrollFn(),doScrollEndFn())),_canContinue=!0}function flipend(){$pluginCopyright.hide(),_pageScrollEnd=!1;var a=currentPageId;currentPageId=_$activePage.data("id"),$page=_$activePage,rrxdebug&&console.log("flipend",currentPageId),rrxdebug&&console.log("regPageEndEvent",currentPageId);var b=_$activePage.data("id");b==lastPageId?b===_copyrightId&&(hideDanmuInfo(),_pageScrollEnd=!0):a===_copyrightId&&resetDanmuInfo(),setPageArrowIcon(currentPageId),triggerPluginLeaveEvent(a),rrxdebug&&console.info("flipend-showCopyright ",currentPageId,lastPageId,_copyrightId),currentPageId==lastPageId?(rrxdebug&&console.log("flipend-showCopyright ",currentPageId,lastPageId),showCopyright(!0,currentPageId),hideArrow()):(showCopyright(!1,currentPageId),showArrow()),setTimeout(function(){regPageEndEvent(currentPageId),cssAnimation(_$currentPage[0].style,"Transition","none"),deactive(_$activePage).addClass("pt-page-current"),deactive(_$currentPage).removeClass("pt-page-current"),_$currentPage=_$activePage,_isDisableFlipPage=!1,_$currentPage.css("z-index","1"),$(".pt-page").attr("style",""),rrxdebug&&console.log("end"),updateUserReadDepth(),"loadingpage"!==currentPageId&&pageCodeLoad(currentPageId,apiHelper.getAppInstance()),_isEditing||loadPluginEvent(currentPageId),resetLongPage(),_flipProgress===!0&&renderProgress(currentPageId,totalPages)},flipEndTimeout)}function setScrollFn(){rrxdebug&&console.log(_dataObj.flipWay,_dataObj.flipAnimation);var a=_dataObj.flipWay?_dataObj.flipWay:"down",b=parseInt(_dataObj.flipAnimation,10);switch(b){case 0:b="Move";break;case 110:b="Move";break;case 120:b="Fade";break;case 130:b="Move";break;case 140:b="Move";break;case 150:b="Move";break;case 170:b="Scale",animTime=.8,flipEndTimeout=990;break;case 200:b="Card";break;case 210:b="LRMove";break;case 220:b="LRMove";break;case 230:b="LRMove";break;case 240:b="LRRotate";break;case 250:b="LRSlide";break;default:b="Move"}_scrollMode=b,doScrollMoveFn=scroll[a+b+"Move"],doScrollEndFn=scroll[a+b+"End"]}function getPageDomById(a){return _$canvas.find(".page_"+a).first()}function enableScroll(){return rrxdebug&&console.log("isStart _dataObj.pageList",isStart,_dataObj.pageList),isStart&&_dataObj.pageList.length>1}function setCssWhenMove(a,b,c,d,e){if(_$activePage){var f=a?"-":"",g=c-Math.abs(d);cssAnim(_$activePage,"transform",b+"("+f+g+"px)")}}function setCssWhenEnd(a,b,c,d){cssAnim(_$currentPage,"transform","scale(1)"),cssAnim(_$activePage,"transform",a+"(0px)")}function cssAnim(a,b,c){for(var d=["","-webkit-","-moz-"],e=0;e<d.length;e++)a.css(d[e]+b,c)}function cssAnimation(a,b,d){for(var e=["","webkit","moz"],f=0,g=e.length;g>f;f++){0===f&&(b=b.substring(0,1).toLowerCase()+b.substring(1,b.length));var h=d instanceof Array?d[f]:d;c=e[f]+b,a[c]=h}}function cancelFlip(){_isDisableFlipPage=!0;var a;setScrollFn(),a=moveDistanceY>0?-windowHeight:windowHeight,cssAnim(_$activePage,"transform","translateY("+a+"px)"),cssAnim(_$currentPage,"transform","translateY(0) scale(1)"),setTimeout(function(){_$currentPage.attr("style",""),_$activePage.attr("style",""),deactive(_$activePage),_isDisableFlipPage=!1},500)}function getMoveInit(a,b,c,d){var e=_$activePage;deactive(_$activePage),active(_$activePage);var f=a?"-":"";e[0].style.webkitTransition="none",e[0].style.transition="none",e[0].style.webkitTransform=c+"("+f+d+"px)",e[0].style.transform=c+"("+f+d+"px)",cssAnim(_$currentPage,"transform-origin",b)}function active(a){return playPageByPageId(a.data("id")),a.addClass("z-active")}function deactive(a){return a.removeClass("z-active")}function setScrollEndAnim(){var a="linear";"LRSlide"===_scrollMode&&setTransition(_$currentPage[0],animTime,a),setTransition(_$activePage[0],animTime,a)}function setTransition(a,b,c){a.style.webkitTransition="-webkit-transform "+b+"s "+c,a.style.transition="transform "+b+"s "+c}function getActivePage(a){if(scrolling)return _$activePage;var b;return"prev"===a?(b=getActualPageId(-2),getPageDomById(b)):"next"===a?(b=getActualPageId(-1),getPageDomById(b)):void 0}function goToPrePage(){var a=0;scrollStart();var b=setInterval(function(){a+=2,_scrollMode.indexOf("LR")>-1?moveDistanceX=a:moveDistanceY=a,scrollMove(),a>=21&&(clearInterval(b),scrollEnd())},1)}function goToNextPage(){var a=0;scrollStart();var b=setInterval(function(){a-=2,rrxdebug&&console.log("e",a,_scrollMode,moveDistanceY),rrxdebug&&console.log(_scrollMode,a),_scrollMode.indexOf("LR")>-1?moveDistanceX=a:moveDistanceY=a,scrollMove(),-21>=a&&(clearInterval(b),scrollEnd(),rrxdebug&&console.log("clear..........."))},1)}function goToPageById(a){if(!_isDisableFlipPage)if("first"===a)goToPageById(getFirstPageId());else if("next"===a)goToNextPage();else if("pre"===a)goToPrePage();else{var b=getPageObjById(a);if(null===b)return;if(scrolling=!0,_$activePage=getPageDomById(a),_$activePage.length>0){var c=currentPageId;c>a?goToPrePage():a>c&&goToNextPage()}}}function beforeScrollEndThenNext(){clearAllCustomIntervals(),stopShake(),removeAllVideo()}function beforeScrollEndThenCopyrightEndPage(a){rrxdebug&&console.log(a),a==lastPageId&&a===_copyrightId&&($(".make-rrxiu").hide(),$(".show-rrxiu-visit").hide(),hideDanmuInfo(),showCopyrightEndPage())}function isStopNextPage(){return rrxdebug&&console.log("isStopNextPage",currentPageId,lastPageId),currentPageId==lastPageId&&"stop"==lastPageGoto?!0:!1}function isContinuePrePage(){return rrxdebug&&console.log("isContinuePrePage",currentPageId,lastPageId),currentPageId==firstPageId&&"continue"!=lastPageGoto?!1:!0}function resetLongPage(){touchPos=0,touchEndCount=0,touchToBottomCount=0,doTransform(0,0)}function doTransform(a,b){var c=$(".iscroll_wrapper").find(".pt-page-element-list-box");transformEle(c,"translate3d(0,"+a+"px,0)",b)}function doTransformIscrollWrapper(a,b,c){transformEle(a,"translate3d(0,"+b+"px,0)",c)}function transformEle(a,b,c){if(a.css({transition:"","-webkit-transition":""}),c){var d="transform "+c+"ms ease-out";a.css({transition:d,"-webkit-transition":"-webkit-"+d})}a.css({transform:b,"-webkit-transform":"-webkit-"+b})}function rrxScrollLongPage(b,e){function f(){rrxdebug&&console.log("addTouchEvent",j),j.on("mousedown touchstart",function(a){rrxdebug&&console.log("long page touchstart",r,h.height,a);var b=a.target;if(c=b.tagName,d=b.getAttribute("ctype")?b.getAttribute("ctype").charAt(0):"",cname=b.getAttribute("class"),rrxdebug&&console.log("long evt target",b,c,d,a),"SELECT"==c||"TEXTAREA"==c||"BUTTON"==c||"INPUT"==c||b.getAttribute("data")||b.getAttribute("href")||"option-label"==cname)C=!1,a.stopPropagation();else{C=!0,a.stopPropagation(),a.preventDefault(),t=!0,u=!0,w=0;var e=a.originalEvent,f=e.touches,g=f?e.changedTouches[0]:null;v=g?g.clientY:a.clientY,v/=_pt_inner_scale_value,"WE"==r&&(x=g?g.clientX:a.clientX,x/=_pt_inner_scale_value),A=touchPos,b=Date.now(),rrxdebug&&console.log("v m w",v,x,A)}}),j.on("mousemove touchmove",function(b){if(rrxdebug&&console.log("long page touchmove",r,b),b.stopPropagation(),C&&b.preventDefault(),t){var d=b.originalEvent;a=d.touches,c=a?a[0]:null;var e=c?c.clientY:b.clientY;if(e/=_pt_inner_scale_value,w=touchPos+e-v,"WE"==r){var f=c?c.clientX:b.clientX;f/=_pt_inner_scale_value,y=f-x}if(Math.abs(y)>Math.abs(w-touchPos))return y>0?goToPrePage():goToNextPage(),u=!1,void(rrxdebug&&console.log(1));if(w>0&&"NS"==r&&!s)return rrxdebug&&console.log(2),goToPrePage(),u=!1,void(touchPos=0);if(rrxdebug&&console.info("g o",w,m),w>m&&0>w)g(w),doTransformIscrollWrapper(j,w,0),rrxdebug&&console.log(3);else if(m>w&&"NS"==r&&!s)return rrxdebug&&console.log(4),touchToBottomCount+=1,rrxdebug&&console.log("_toBottomCount",touchToBottomCount,touchEndCount),touchToBottomCount>1&&touchEndCount>0&&goToNextPage(),u=!1,void(touchPos=m);B=Date.now(),B-z>300&&(z=B,A=w)}}),j.on("mouseup touchend mouseleave",function(a){if(rrxdebug&&console.log("long page touchend",touchPos,a),a.stopPropagation(),C&&a.preventDefault(),!t)return void(t=!1);if(touchEndCount+=1,rrxdebug&&console.log("_endCount",touchEndCount),t=!1,u=!1,w>m&&0>w){var b=Date.now();n=(w-A)/(b-z),i=Math.abs(n/.002),o=n*i/2,w+=o,w>0?(i=(w-0)/o*i,w=0):m>w&&(i=(w-m)/o*i,w=m),doTransformIscrollWrapper(j,w,i),touchPos=w,touchEndCount=0}})}function g(a){}var h,j,k,l,m,o,p,q=windowHeight,r="NS",s=!1,t=!1,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=!0;q=o,h=e,p=b,rrxdebug&&console.log(h),s=e.stopFlip,k=_$canvas.find(".page_"+h.id),j=$("#iscroll_wrapper"+h.id).find(".pt-page-element-list-box"),l=-(h.height-1e3),m=l;var D=parseInt(_dataObj.flipAnimation,10);r=D>=210?"WE":"NS",f(),rrxdebug&&console.log(l,j)}function swipeFlipEvent(a,b){rrxdebug&&console.log("swipeFlipEvent"),"left"===a||"up"===a?goToNextPage():gotoPrePage()}function initShareInfo(){var a=function(){void 0!==_dataObj.describe&&(shareDesc=_dataObj.describe),void 0!==_dataObj.title&&(shareTitle=_dataObj.title,_dataObj.showShareCount&&(shareTitle=shareTitle.replace("#分享数#",_log.getVisitCount())),_isEditing===!1&&_isPc===!1||(document.title="人人秀 | 更有逼格的展示")),(void 0===_dataObj.shareImageUrl||""===_dataObj.shareImageUrl)&&(_dataObj.shareImageUrl=defaultShareImageUrl),shareImageUrl=_dataObj.shareImageUrl};if("0"===wsiteInfo.wxp.newReview||403===coolData.result){var b="欢迎使用人人秀，您的作品审核不通过";shareDesc=b,shareTitle=b,document.title=b,coolData={result:403,msg:"审核不通过"}}else _dataObj.showShareCount?setTimeout(a,2e3):a()}function fnHackTitle(a){a&&(document.title=a);var b=navigator.userAgent.toLowerCase();if(b.indexOf("iphone")>-1)var c=$("body"),d=$('<iframe style="width: 0;height: 0;border: none;" src="/favicon.ico"></iframe>').on("load",function(){setTimeout(function(){d.off("load").remove()},0)}).appendTo(c)}function getFirstPageId(){var a=$pagelist.find("div.pt-page:not(.ifpage)").first(),b=0;return a&&(b=a.data("id")),b}function pageObjectToArray(a){if(a.hasOwnProperty("pageList")&&a.pageList.constructor===Object){var b=[];for(var c in a.pageList)b.push(a.pageList[c]);a.pageList=b}return a}function handleImgUrl(a){return a?a.indexOf("data:image")>-1?a:appConfig.imageHost+removeImgPrefix(a):""}function removeImgPrefix(a){return a?a.indexOf("data:image")>-1?a:(a.indexOf("http://image2.weplus.me/")>-1&&(a=a.replace("http://image2.weplus.me/","")),a.indexOf("http://image.weplus.me/")>-1&&(a=a.replace("http://image.weplus.me/","")),a.indexOf(appConfig.imageHost)>-1&&(a=a.replace(appConfig.imageHost,"")),a):""}function allowFlipCurrentPage(){return _allowFlip&&_allowFlipCurrentPage?!0:!1}function showArrow(){getPageCount()>1&&allowFlipCurrentPage()&&pageEffectComplete(currentPageId)&&currentPageId!==lastPageId&&("down"==flipWay?$iconArrowDown.show():$iconArrowRight.show())}function hideArrow(){"down"==flipWay?$iconArrowDown.hide():$iconArrowRight.hide()}function getPageCount(){return null!==$pagelist?$pagelist.find(".pt-page").length:0}function nextPage(){var a=!1;if(getPageCount()>1){if(currentPageId==lastPageId&&"stop"==lastPageGoto)return;var b=getActualPageId(-1);b==lastPageId?b===_copyrightId&&(hideDanmuInfo(),a=!0):currentPageId===_copyrightId&&resetDanmuInfo();var c=getAnimationIndex(b,!0);gotoPage(c,b)}a&&showCopyrightEndPage()}function prePage(){var a=!1;if(getPageCount()>1){if(currentPageId==firstPageId&&"continue"!=lastPageGoto)return;var b=getActualPageId(-2);b==lastPageId?b===_copyrightId&&(hideDanmuInfo(),a=!0):currentPageId===_copyrightId&&resetDanmuInfo();var c=getAnimationIndex(b,!1);gotoPage(c,b)}a&&showCopyrightEndPage()}function showEffect(a){a.addClass("fadeIn"),a.css("display","block")}function hideEffect(a){a.removeClass("fadeout"),a.css("display","none")}function showCopyright(a,b){if(rrxdebug&&console.info("showCopyright",b,_copyrightId,a),b===_copyrightId)return void(rrxdebug&&console.info("=="));if(b===_copyrightId)return void(rrxdebug&&console.info("=="));if(_isHaveMenu){var c=getIndexByArray(_dataObj.pageList,b);if(!(_menuPageIndex>c))return}var d=function(a){a===!0?(rrxdebug&&console.info("func show"),showEffect($copyright)):hideEffect($copyright)};rrxdebug&&console.trace(_copyrightFrom),rrxdebug&&console.info("showCopyright-_copyrightFrom",_dataObj.copyright);var e=null;if("we+"!==_copyrightFrom&&"rrxiu"!==_copyrightFrom||void 0===b)if("customer"===_copyrightFrom||"bottom"===_copyrightFrom)if("bottom"===_copyrightFrom){if(e=getPageObjById(b),e&&e.stopFlip===!0)return void d(!0);d(a)}else{if(_isHaveMenu)return void d(!1);d(a)}else"na"===_copyrightFrom&&(_dataObj.showReport||_dataObj.showVisitCount)?d(a):0!==_dataObj.result&&d(a);else e=getPageObjById(b),d(e&&e.stopFlip===!0?!0:a)}function showCopyrightEndPage(){if($(".bottomm-text").show(),$(".make-rrxiu").show(),$cypage=getPageDomById(_copyrightId),("we+"===_copyrightFrom||"rrxiu"===_copyrightFrom)&&!isOldWsite()){var a=_log.getVisitCount();if(_dataObj.showVisitCount){var b=$cypage.find(".show-rrxiu-visit");!getIsFromTpl()&&b.length>0&&a>0?(b.css("display","block"),b.html(b.html().replace("{{visitCount}}",a))):b.css("display","none")}if(a>0){var c=$cypage.find(".share-title");c.length>0&&c.html(c.html().replace("#分享数#",a))}var d=$cypage.find(".bottomm-text");d.length>0&&(d.css("bottom","-100px"),setTimeout(function(){d.animate({bottom:"60px"},800)},300)),isFirstGotoEndPage&&(isFirstGotoEndPage=!1,setTimeout(function(){registerReportEvent($cypage.find(".show-rrxiu-report"))},1e3)),hideMenuPlugin()}}function hideMenuPlugin(){_$canvas.find(".rrx-pg-menu-index").length>0&&(hideEffect(_$canvas.find(".rrx-pg-menu-index")),("rrxiu"===_copyrightFrom||"bottom"===_copyrightFrom)&&hideEffect($copyright))}function setMenuStyle(){_$canvas.find(".rrx-pg-menu-index").length>0&&(_$canvas.find(".rrx-pg-menu-index").css("bottom","38px"),$copyright.css("height","40px"),$copyright.css("line-height","40px"));

}function showMenuPlugin(){_$canvas.find(".rrx-pg-menu-index").length>0&&(showEffect(_$canvas.find(".rrx-pg-menu-index")),("rrxiu"===_copyrightFrom||"bottom"===_copyrightFrom)&&(showEffect($copyright),setMenuStyle()))}function registerReportEvent(a){a.length>0&&a.off().on(clickEventType,function(){showReportpage()})}function getPrefixCss(a,b){for(var c=function(b){var c="",d=b.replace(new RegExp(/({)/g),"${").replace(new RegExp(/(})/g),"}$").split("$");if(d.length>0)for(var e=0;e<d.length;e++){var f=$.trim(d[e]);f.indexOf("{")>-1&&f.indexOf("}")>-1?c+=f:""!==f&&(c+=a+" "+f)}else c=b;return c},d="",e=b.replace(new RegExp(/(@)/g),"$@").split("$"),f=0;f<e.length;f++)d+=-1===e[f].indexOf("@")?c(e[f]):e[f];return d}function getCopyrightFrom(){var a=void 0!==_dataObj.copyright?_dataObj.copyright.from:"rrxiu",b=_dataObj.pageList;if(b){1!==b.length||"rrxiu"!==a&&"bottom"!==a||b[0].longPage&&(a="bottom");for(var c=0;c<b.length;c++)for(var d=b[c].elementList,e=0;e<d.length;e++)if("plugin"===d[e].type&&"菜单"===d[e].content.name){_menuPageIndex=c,_isHaveMenu=!0,"customer"===a&&_dataObj.showReport&&(a="na");break}}return a}function isOfficialAccountsMode(){return"official_accounts"===Cool.util.getUrlParameterByName("mode")?!0:"1"===getOfficialAccountsModeCookie()?!0:!1}function getOfficialAccountsModeKey(){var a=_dataObj.guid;return hex_md5("official_accounts"+a)}function setOfficialAccountsModeCookie(){var a=isOfficialAccountsMode()?"1":"0",b="",c=10;Cool.cookie.setWithoutTime(getOfficialAccountsModeKey(),a,c,b)}function getOfficialAccountsModeCookie(){return Cool.cookie.get(getOfficialAccountsModeKey())}function initOfficialAccountsModeCookie(){var a=getOfficialAccountsModeCookie();setOfficialAccountsModeCookie()}function getCanFocusWechat(){return wsiteInfo.wxp.focusWechat}function getCanModifyWechat(){return wsiteInfo.wxp.modifyWechat}function getCanShowShareTips(){return 1===wsiteInfo.shareTips}function getFormatCount(a){var b=a.toString();return b.length>=6&&(b=b.substr(0,2)+","+b.substr(2,3)+","+b.substr(5)),b}function renderPluginCopyRight(a,b,c){_pagePluginCopyRight.push(currentPageId);var d=appConfig.copyright.url,e=a.title||"人人秀",f=a.image||"http://assets3.rrxiu.net/www/images/v2/non_cover.jpg",g=a.color||"blue",h=Math.round(3*Math.random()+1),i=Math.round(1*Math.random()+1),j=[27357863,27358135];ideaCount=Cool.localStorageUtil.get("rrxPgIdeaCount")||0,ideaCount=parseInt(ideaCount,10),0===ideaCount&&(ideaCount=j[i-1]),27357863>ideaCount&&(ideaCount=27357863);var k='<a href="javascript:void(0)" class="show-plugin-report">举报</a><div class="closeBtn"><img src="../images/plugin-close.png"></div><div class="logo col"><img src="'+f+'"></div><div class="slogan col"><p class="title">'+e+'</p><p class="context"><span class="count">'+getFormatCount(ideaCount)+'</span>个创意活动在此产生</p></div><div class="createBtn"><a class="btn" style="border-color:'+g+'" target="_blank" href="'+d+'">免费制作</a></div>';$pluginCopyright.html(k),b&&(c?($pluginCopyright.css("height","0px"),$pluginCopyright.find(".closeBtn").css("display","none"),$pluginCopyright.find(".logo").css("display","none"),$pluginCopyright.find(".slogan").css("display","none"),$pluginCopyright.find(".createBtn").css("display","none")):($pluginCopyright.css("height","100px"),$pluginCopyright.find(".closeBtn").css("display","block"),$pluginCopyright.find(".logo").css("display","inline-block"),$pluginCopyright.find(".slogan").css("display","inline-block"),$pluginCopyright.find(".createBtn").css("display","block"))),setTimeout(function(){var a=$pluginCopyright.find(".show-plugin-report");registerReportEvent(a);var c=$pluginCopyright.find(".closeBtn");c.length>0&&c.off().on(clickEventType,function(){b?($pluginCopyright.css("height","0px"),$pluginCopyright.find(".closeBtn").hide(),$pluginCopyright.find(".logo").hide(),$pluginCopyright.find(".slogan").hide(),$pluginCopyright.find(".createBtn").hide()):hideEffect($pluginCopyright)});var d=$pluginCopyright.find(".slogan .count");crRollInterval=setInterval(function(){d.length>0?(ideaCount+=1,Cool.localStorageUtil.set("rrxPgIdeaCount",ideaCount),d.html(getFormatCount(ideaCount))):clearRollList()},1e3*h)},1e3)}function showPluginCopyRight(a,b){var c=b,d=!1;if(b)"na"===_copyrightFrom?(b=!0,d=!0):"customer"===_copyrightFrom&&(d=!0,b=_dataObj.showReport&&currentPageId==lastPageId?!1:!0);else if("customer"===_copyrightFrom||"na"===_copyrightFrom)return;(!d||b)&&(clearRollList(),c?("customer"!==_copyrightFrom||_dataObj.showReport)&&hideEffect($copyright):hideEffect($copyright),renderPluginCopyRight(a,b,d),showEffect($pluginCopyright))}function hidePluginCopyRight(){"customer"!==_copyrightFrom&&"na"!==_copyrightFrom&&(clearRollList(),hideEffect($pluginCopyright))}function clearRollList(){clearInterval(crRollInterval)}function showPluginFocus(a,b){apiHelper.getAppInstance().stopFlip(),""!==b&&void 0!==b?b+="@!200x200":b="";var c=$focusWxQrPanel.find(".dialog-content");if(null===c||void 0===c||0===c.length){var d='<a class="show-common-report">举报</a><a class="fc_wx_close"><span></span></a><div class="dialog-content"><div class="focus-box"><div class="focus-box-inner"><div class="title-tip"></div><div class="wxqr"><img class="wxqr-img"></div><div class="bottom-tip">请<span class="red-tips save-tip">长按二维码</span>图片<div class="mtop4">关注公众号后参加活动</div></div></div></div></div>';$focusWxQrPanel.html(d),c=$focusWxQrPanel.find(".dialog-content");var e=$focusWxQrPanel.find(".fc_wx_close");e.off().on(clickEventType,function(a){a.stopPropagation(),a.preventDefault(),hidePluginFocus()}),registerReportEvent($focusWxQrPanel.find(".show-common-report"))}var f=c.find(".title-tip"),g=c.find(".wxqr-img");f.text(a),g.attr("src",b),$focusWxQrPanel.show()}function hidePluginFocus(){apiHelper.getAppInstance().resetFlip(!0),$focusWxQrPanel.hide()}function updateUserReadDepth(){var a=_dataObj.pageList;if(!(window.userReadDepth>=a.length))if("copyrightPage"===currentPageId)window.userReadDepth=a.length;else for(var b=0;b<a.length;b++)if(a[b].id==currentPageId){b+1>window.userReadDepth&&(window.userReadDepth=b+1);break}}var base=this,_$canvas=null,canvasDefaultWidth=640,$previewNotice,$copyright,$pluginCopyright,$progress,$reportpage,$iconMusic,$focusButton,$focusPanel,$topMenuPanel,$danmuButton,$danmuPanel,$danmuShow,$focusWxQrPanel,$pagewrapper=null,$pagelist=null,$floorpage=null,$loadingpage=null,$sharepage=null,$iconArrowDown,$iconArrowRight,currentPageId=0,_dataObj=null,_host="",_allowTempFlip=!0,_allowFlip=!0,_allowFlipCurrentPage=!0,flipWay="down",flipAnimation={enter:"1101",back:"1102"},musicUrl="",musicPlayIcon="",musicStopIcon="",musicPosition="",musicAutoPlay=!0,$music=null,_isEditing=!1,PLUGIN_SIZE_TYPE={AUTO:"1",FIXED:"2",FULL:"3",SCALE:"4"},_isPc=!0,_isPreview=!1,_isPageThumb=!1,lastPageGoto="continue",firstPageId=0,lastPageId=0,clickEventType="click",self,_log=null,_isWeixin=!1,_animationEngine=appConfig.animationEngine,_copyrightFrom="",_isHaveMenu=!1,_menuPageIndex=-1,_copyrightId="copyrightPage",_leftCopyrightText="免费创建一个场景→",_rightCopyrightText="人人秀",_page_element_list_scale_value=1,limitBottomCount=0,limitTopCount=0,iScrollInstances=[],defaultShareImageUrl="http://assets3.weplus.me/www/images/logo_blue_300x300.jpg",shareUrl=location.href,shareTitle="",shareImageUrl="",shareDesc="",customIntervals=[],_preloadAllResource=!1,_reportInit=!1,_flipProgress=!1,_pagePluginCopyRight=[],longPageCopyright={title:"长页-人人秀旗下产品",image:appConfig.imageHost+"plugin_icon/longpage.png",color:"#2ac3fd"},getWxJsSignTry=0,isLoadQQMap=!1;window.qqMapCallback=function(){isLoadQQMap=!0};var loadedSvgKey=[],loadedSvgXml={},preAnimationList=[],regImgSilderTimerRecord=[{pageId:0,isReg:!1,silderObject:[]}];ImgPlayTimer.prototype={constructor:ImgPlayTimer,setCount:function(a){this.count=a},getCount:function(){return this.count},setPageId:function(a){this.pageId=a},setElemId:function(a){this.elemId=a},setContent:function(a){this.content=a},setImgList:function(a){this.imgList=a},playImgList:function(){var a=this,b=!0,c=setInterval(function(){if(b){if(a.count>=a.imgList.length){if(a.count=0,!a.content.playLoop)return void window.clearInterval(c);b=!1,setTimeout(function(){b=!0,$(a.imgList[a.imgList.length-1]).css("opacity",0),$(a.imgList[0]).css("opacity",1)},1e3*a.content.loopDelay)}a.count>0&&($(a.imgList[a.count-1]).css("opacity",0),$(a.imgList[a.count]).css("opacity",1)),a.count++}},parseInt(1e3/a.content.playSpeed,10));regIntervals.push({pageId:a.pageId,elemId:a.elemId,interval:c})}};var regIntervals=[];musicIsPlayWhenPlayVideo=!0;var myShakeEvent={},Shake=function(a){if(this.hasDeviceMotion="ondevicemotion"in window,this.options={shake:"shake",threshold:15,timeout:1e3},"object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&(this.options[b]=a[b]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof document.CustomEvent)this.event=new document.CustomEvent(this.options.shake,{bubbles:!0,cancelable:!0});else{if("function"!=typeof document.createEvent)return!1;this.event=document.createEvent("Event"),this.event.initEvent(this.options.shake,!0,!0)}};Shake.prototype={reset:function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},start:function(){this.reset(),this.hasDeviceMotion&&window.addEventListener("devicemotion",this,!1)},stop:function(){this.hasDeviceMotion&&window.removeEventListener("devicemotion",this,!1),this.reset()},devicemotion:function(a){var b,c,d=a.accelerationIncludingGravity,e=0,f=0,g=0;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=d.x,this.lastY=d.y,void(this.lastZ=d.z);if(e=Math.abs(this.lastX-d.x),f=Math.abs(this.lastY-d.y),g=Math.abs(this.lastZ-d.z),(e>this.options.threshold&&f>this.options.threshold||e>this.options.threshold&&g>this.options.threshold||f>this.options.threshold&&g>this.options.threshold)&&(b=new Date,c=b.getTime()-this.lastTime.getTime(),c>this.options.timeout)){var h=Math.abs(e+f+g)/c*1e4;this.event.speed=h.toFixed(2),window.dispatchEvent(this.event),this.lastTime=new Date}this.lastX=d.x,this.lastY=d.y,this.lastZ=d.z},handleEvent:function(a){return"function"==typeof this[a.type]?this[a.type](a):void 0}};var rrxAutoFlipTimer=null,menuScrollInstance=null,danmuiScrollInstance=null,danmu_like_count=0,danmu_comment_count=0,isSending=!1,DM_Comment_List=[],DM_Listen_Event=$({}),forceOpenDanmu=!1,danmuButtonShow=!0,onlyPluginDanmu=!1,authUserInfo=null,danmuSortKey=[],flip=function(){function a(a,b){if(void 0!==a)if(h=a,b=void 0===b?0:b,h.find(".pt-page").each(function(){$(this).data("originalClassList",$(this).attr("class"))}),0===b){var c=h.find("div.pt-page:not(.ifpage)").first();c.addClass("pt-page-current"),i=c.data("id")}else h.find(".page_"+b).addClass("pt-page-current"),i=b}function b(a,b){c(a,b),j=!1}function c(a,b){b.attr("class",b.data("originalClassList")),a.attr("class",a.data("originalClassList")+" pt-page-current")}function d(a){return""===a&&(a="1101"),g[a]}function e(a,c){if(void 0!==h){if(j)return!1;var e,g;classes=d(a),e=classes[0],g=classes[1],j=!0;var k=null;k=0===i?h.find("div.pt-page:not(.ifpage)").first():h.find(".page_"+i).first();var l=h.find(".page_"+c).first();if(i=c,null!==l){l.data("id")!=k.data("id")&&l.addClass("pt-page-current");var m=!1,n=!1;k.addClass(g).on(f,function(a){k.off(f),m=!0,n&&b(l,k)}),l.addClass(e).on(f,function(){l.off(f),n=!0,m&&b(l,k)})}else j=!1;return _support||b(k,l),!0}}var f="webkitAnimationEnd animationend";_support=!0;var g=[];g[1101]=["pt-page-moveFromBottom","pt-page-moveToTop"],g[1102]=["pt-page-moveFromTop","pt-page-moveToBottom"],g[1201]=["pt-page-moveFromBottom pt-page-ontop","pt-page-fade"],g[1202]=["pt-page-moveFromTop pt-page-ontop","pt-page-fade"],g[1301]=["pt-page-moveFromBottom","pt-page-moveToTopEasing pt-page-ontop"],g[1302]=["pt-page-moveFromTop","pt-page-moveToBottomEasing pt-page-ontop"],g[1401]=["pt-page-flipInTop pt-page-delay500","pt-page-flipOutBottom"],g[1402]=["pt-page-flipInBottom pt-page-delay500","pt-page-flipOutTop"],g[1501]=["pt-page-rotatePullBottom pt-page-delay180","pt-page-rotatePushTop"],g[1502]=["pt-page-rotatePullTop pt-page-delay180","pt-page-rotatePushBottom"],g[1601]=["pt-page-rotateCubeTopIn","pt-page-rotateCubeTopOut pt-page-ontop"],g[1602]=["pt-page-rotateCubeBottomIn","pt-page-rotateCubeBottomOut pt-page-ontop"],g[1701]=["pt-page-scaleUpCenter pt-page-delay400","pt-page-scaleDownCenter"],g[1801]=["pt-page-rotateInNewspaper pt-page-delay500","pt-page-rotateOutNewspaper"],g[1901]=["pt-page-scaleUp","pt-page-rotateFall pt-page-ontop"],g[2001]=["pt-page-scaleUp","pt-page-moveToTop pt-page-ontop"],g[2101]=["pt-page-moveFromRight","pt-page-moveToLeft"],g[2102]=["pt-page-moveFromLeft","pt-page-moveToRight"],g[2201]=["pt-page-moveFromRight","pt-page-moveToLeftEasing pt-page-ontop"],g[2301]=["pt-page-rotateCubeLeftIn","pt-page-rotateCubeLeftOut pt-page-ontop"],g[2401]=["pt-page-rotateCarouselLeftIn","pt-page-rotateCarouselLeftOut pt-page-ontop"],g[2501]=["pt-page-rotateSlideIn","pt-page-rotateSlideOut"];var h,i=0,j=!1;return{init:a,gotoPage:e}}(),isSliding=!1,moveDistanceX=0,moveDistanceY=0,doScrollMoveFn=null,doScrollEndFn=null,scroll={},isStart=!1,isNext=!1,isFirstTime=!0,flipEndTimeout=500,animTime=.4,scrolling=!1,left=0,top=0,_isDisableFlipPage=!1,_isDisableFlipPrevPage=!1,_isDisableFlipNextPage=!1,_scrollMode=0,windowWidth=$("#pt-inner").width(),windowHeight=$("#pt-inner").height(),_$activePage=null,_$currentPage=null,touchPos=0,touchEndCount=0,touchToBottomCount=0,_canContinue=!0,_pageScrollEnd=!1;scroll.downMoveMove=function(){var a=Math.abs(moveDistanceY)<=Math.abs(moveDistanceX)||0===moveDistanceY;if(rrxdebug&&console.log("downMoveMove",a),!a)if(moveDistanceY>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);isNext||isFirstTime?(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),rrxdebug&&console.warn("init prev"),_$activePage=getActivePage("prev"),getMoveInit(!0,"bottom center","translateY",windowHeight)):setCssWhenMove(!0,"translateY",windowHeight,moveDistanceY,"vertical")}else if(0>moveDistanceY){if(_isDisableFlipPrevPage)return;if(isStopNextPage())return void(_canContinue=!1);!isNext||isFirstTime?(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),getMoveInit(!1,"top center","translateY",windowHeight)):setCssWhenMove(!1,"translateY",windowHeight,moveDistanceY,"vertical")}},scroll.downMoveEnd=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX)&&Math.abs(moveDistanceY)>20){rrxdebug&&console.log(moveDistanceY,windowHeight),setCssWhenEnd("translateY",moveDistanceY,windowHeight,_scrollMode),rrxdebug&&console.log("移动结束"),beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),flipend()}else _isDisableFlipPage=!1,cancelFlip()},scroll.downFadeMove=function(){var a=Math.abs(moveDistanceY)<=Math.abs(moveDistanceX)||0===moveDistanceY;if(!a)if(moveDistanceY>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);(isNext||isFirstTime)&&(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),_$activePage.removeClass("z-fade-in"),deactive(_$activePage),_$currentPage[0].style.zIndex=1,_$activePage[0].style.zIndex=2,_$activePage.addClass("z-fade-in"),active(_$activePage))}else if(0>moveDistanceY){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);(!isNext||isFirstTime)&&(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),_$activePage.removeClass("z-fade-in"),deactive(_$activePage),_$currentPage[0].style.zIndex=1,_$activePage[0].style.zIndex=2,_$activePage.addClass("z-fade-in"),active(_$activePage))}},scroll.downFadeEnd=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX)){beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),setTimeout(function(){flipend()},100)}else _isDisableFlipPage=!1,cancelFlip()},scroll.downScaleMove=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX)){if(moveDistanceY>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);(isNext||isFirstTime)&&(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),deactive(_$activePage),_$activePage[0].style.zIndex=2,active(_$activePage),_$activePage[0].style.opacity=1,_$currentPage[0].style.opacity=0)}else if(0>moveDistanceY){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);(!isNext||isFirstTime)&&(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),deactive(_$activePage),_$activePage[0].style.zIndex=2,active(_$activePage),_$activePage[0].style.opacity=1,_$currentPage[0].style.opacity=0)}var a=Math.abs(moveDistanceY)/windowHeight*1.3;_$activePage[0].style.opacity=a.toFixed(1),a.toFixed(3)<=1&&cssAnim(_$activePage,"transform","scale("+a.toFixed(3)+")")}},scroll.downScaleEnd=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX)&&Math.abs(moveDistanceY)>20){cssAnim(_$activePage,"transform","scale(1)"),_$activePage[0].style.opacity=1,beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),flipend()}else cssAnimation(_$currentPage[0].style,"Transition","none"),cssAnimation(_$activePage[0].style,"Transition","none"),_isDisableFlipPage=!1,cancelFlip()},scroll.downCardMove=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX))if(moveDistanceY>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);isNext||isFirstTime?(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),deactive(_$activePage),cssAnimation(_$activePage[0].style,"TransformOrigin","top"),cssAnimation(_$activePage[0].style,"Transform","rotateX(90deg)"),active(_$activePage)):cssAnimation(_$activePage[0].style,"Transform","rotateX("+(90-moveDistanceY/windowHeight*90)+"deg)")}else if(0>moveDistanceY){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);!isNext||isFirstTime?(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),deactive(_$activePage),cssAnimation(_$activePage[0].style,"TransformOrigin","bottom"),cssAnimation(_$activePage[0].style,"Transform","rotateX(-90deg)"),active(_$activePage)):cssAnimation(_$activePage[0].style,"Transform","rotateX("+(-90-moveDistanceY/windowHeight*90)+"deg)")}},scroll.downCardEnd=function(){if(Math.abs(moveDistanceY)>Math.abs(moveDistanceX)&&Math.abs(moveDistanceY)>20){cssAnimation(_$activePage[0].style,"Transform","rotateX(0deg)"),beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),flipend()}else cssAnimation(_$currentPage[0].style,"Transition","none"),cssAnimation(_$activePage[0].style,"Transition","none"),_isDisableFlipPage=!1,cancelFlip()},scroll.rightLRMoveMove=function(){if(Math.abs(moveDistanceX)>Math.abs(moveDistanceY))if(moveDistanceX>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);isNext||isFirstTime?(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),getMoveInit(!0,"center right","translateX",windowWidth)):setCssWhenMove(!0,"translateX",windowWidth,moveDistanceX,_scrollMode)}else if(0>moveDistanceX){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);!isNext||isFirstTime?(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),getMoveInit(!1,"center left","translateX",windowWidth)):setCssWhenMove(!1,"translateX",windowWidth,moveDistanceX,_scrollMode)}},scroll.rightLRMoveEnd=function(){if(Math.abs(moveDistanceX)>Math.abs(moveDistanceY)&&Math.abs(moveDistanceX)>20){setCssWhenEnd("translateX",moveDistanceX,windowWidth,_scrollMode),beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),flipend()}else _isDisableFlipPage=!1,cancelFlip()},scroll.rightLRRotateMove=function(){var a,b,c,d,e,f,g,h;if(Math.abs(moveDistanceX)>Math.abs(moveDistanceY))if(moveDistanceX>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);rrxdebug&&console.log("moveDistanceX",moveDistanceX),isNext||isFirstTime?(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),active(_$activePage),cssAnim(_$activePage,"Transform","scale(0.3) translateX(0) translateZ(-"+windowHeight+"px) rotateY(45deg)"),_$activePage[0].style.zIndex="0",_$currentPage[0].style.zIndex="100"):(a=((4*windowWidth/4-moveDistanceX)/windowWidth).toFixed(3),b=1.5*moveDistanceX,c=moveDistanceX-windowWidth/4,d=moveDistanceX/windowWidth*45,cssAnim(_$currentPage,"Transform","translateX("+b+"px) scale("+a+") rotateY("+d+"deg) translateZ("+c+"px)"),e=(moveDistanceX/windowWidth).toFixed(3),f=-windowWidth+b,g=windowWidth/4+moveDistanceX,h=-45+(moveDistanceX+windowWidth/4)/windowWidth*45,cssAnim(_$activePage,"Transform","scale("+e+") translateX("+f+"px) translateZ("+g+"px) rotateY("+h+"deg)"))}else if(0>moveDistanceX){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);rrxdebug&&console.log("moveDistanceX",moveDistanceX,moveDistanceY),!isNext||isFirstTime?(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),active(_$activePage),cssAnim(_$activePage,"Transform","scale(0.3) translateX("+(windowWidth+300)+"px) translateZ(-"+windowHeight+"px) rotateY(-45deg)"),_$activePage[0].style.zIndex="0",_$currentPage[0].style.zIndex="100"):(prev_scale=((4*windowWidth/4+moveDistanceX)/windowWidth).toFixed(3),prev_tx=1.5*moveDistanceX,prev_tz=moveDistanceX+windowWidth/4,prev_ry=moveDistanceX/windowWidth*45,cssAnim(_$currentPage,"Transform","translateX("+prev_tx+"px) scale("+prev_scale+") rotateY("+prev_ry+"deg) translateZ("+prev_tz+"px)"),e=(-moveDistanceX/windowWidth).toFixed(3),f=windowWidth- -prev_tx,g=windowWidth/4+moveDistanceX,h=45+(moveDistanceX+windowWidth/4)/windowWidth*45,cssAnim(_$activePage,"Transform","scale("+e+") translateX("+f+"px) translateZ("+g+"px) rotateY("+h+"deg)"))}},scroll.rightLRRotateEnd=function(){if(Math.abs(moveDistanceX)>Math.abs(moveDistanceY)&&Math.abs(moveDistanceX)>20){moveDistanceX>0?(rrxdebug&&console.log("rightLRRotateEnd 11",moveDistanceX),_$currentPage[0].style.webkitTransformOrigin="right",_$currentPage[0].style.webkitTransform="translateX("+-windowWidth+"px) translateZ(-"+windowWidth+"px) rotateY(-180deg) scale(0.2)",_$activePage[0].style.webkitTransform="translateX(0) translateZ(0) rotateY(0) scale(1)",_$currentPage[0].style.zIndex="0",_$activePage[0].style.zIndex="1"):(rrxdebug&&console.log("rightLRRotateEnd 22",moveDistanceX),_$currentPage[0].style.webkitTransformOrigin="left",_$currentPage[0].style.webkitTransform="translateX("+windowWidth+"px) translateZ(-"+windowWidth+"px) rotateY(180deg) scale(0.2)",_$activePage[0].style.webkitTransform="translateX(0) translateZ(0) rotateY(0) scale(1)",_$activePage[0].style.zIndex="1",_$currentPage[0].style.zIndex="0"),beforeScrollEndThenNext();var a=_$activePage.data("id");beforeScrollEndThenCopyrightEndPage(a),flipend()}else cssAnimation(_$currentPage[0].style,"Transition","none"),cssAnimation(_$activePage[0].style,"Transition","none"),_isDisableFlipPage=!1,cancelFlip()},scroll.rightLRSlideMove=function(){var a,b;if(Math.abs(moveDistanceX)>Math.abs(moveDistanceY))if(moveDistanceX>0){if(_isDisableFlipPrevPage)return;if(!isContinuePrePage())return void(_canContinue=!1);rrxdebug&&console.log("moveDistanceX",moveDistanceX),isNext||isFirstTime?(isNext=!1,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("prev"),active(_$activePage),_$currentPage.css({opacity:.5}),_$activePage.css({opacity:.5}),cssAnim(_$activePage,"Transform","translateX(0) translateZ(-500px)"),cssAnim(_$currentPage,"Transform","translateX(0) translateZ(-500px)")):(curr_tx=moveDistanceX,curr_tz=-500,cssAnim(_$currentPage,"Transform","translateX("+curr_tx+"px) translateZ("+curr_tz+"px)"),_$currentPage.css({opacity:.5}),a=-windowWidth+moveDistanceX-200,b=-500,cssAnim(_$activePage,"Transform","translateX("+a+"px) translateZ("+b+"px)"),_$activePage.css({opacity:.5}))}else if(0>moveDistanceX){if(_isDisableFlipNextPage)return;if(isStopNextPage())return void(_canContinue=!1);rrxdebug&&console.log("moveDistanceX",moveDistanceX,moveDistanceY),!isNext||isFirstTime?(isNext=!0,isFirstTime=!1,_$activePage&&deactive(_$activePage),_$activePage=getActivePage("next"),_$activePage&&deactive(_$activePage),active(_$activePage),_$currentPage.css({opacity:.5}),_$activePage.css({opacity:.5}),cssAnim(_$activePage,"Transform","translateX(0) translateZ(-500px)"),cssAnim(_$currentPage,"Transform","translateX(0) translateZ(-500px)")):(curr_tx=moveDistanceX,curr_tz=-500,cssAnim(_$currentPage,"Transform","translateX("+curr_tx+"px) translateZ("+curr_tz+"px)"),_$currentPage.css({opacity:.5}),a=windowWidth+moveDistanceX+200,b=-500,cssAnim(_$activePage,"Transform","translateX("+a+"px) translateZ("+b+"px)"),_$activePage.css({opacity:.5}))}},scroll.rightLRSlideEnd=function(){var a;Math.abs(moveDistanceX)>Math.abs(moveDistanceY)&&Math.abs(moveDistanceX)>2?moveDistanceX>0?(_$currentPage[0].style.webkitTransform="translateX("+2*windowWidth+"px) translateZ(-500px)",_$activePage[0].style.webkitTransform="translateX(0) translateZ(-500px)",beforeScrollEndThenNext(),a=_$activePage.data("id"),beforeScrollEndThenCopyrightEndPage(a),setTimeout(function(){_$activePage[0].style.webkitTransform="translateX(0) translateZ(-0)",_$currentPage.css({opacity:1}),_$activePage.css({opacity:1}),flipend()},450)):(_$currentPage[0].style.webkitTransform="translateX("+-2*windowWidth+"px) translateZ(-500px)",_$activePage[0].style.webkitTransform="translateX(0) translateZ(-500px)",beforeScrollEndThenNext(),a=_$activePage.data("id"),beforeScrollEndThenCopyrightEndPage(a),setTimeout(function(){_$activePage[0].style.webkitTransform="translateX(0) translateZ(-0)",_$currentPage.css({opacity:1}),_$activePage.css({opacity:1}),flipend()},450)):(cssAnimation(_$currentPage[0].style,"Transition","none"),cssAnimation(_$activePage[0].style,"Transition","none"),_isDisableFlipPage=!1,cancelFlip())};var isFirstGotoEndPage=!0;base.outPage=function(a,b,c){return outPage(a,b,c)},base.parsePage=function(a){return parsePage(a)},base.parseElement=function(a){return parseElement(a)},base.playElement=function(a,b){return playElement(a,b)},base.init=function(a,b,c,d,e,f,g,h,i){function j(){void 0!==_dataObj.init&&_dataObj.init(),initBone(),initSwipe(),createPages(),0===o&&0===currentPageId&&(currentPageId=getFirstPageId()),createProgress(),renderCopyright(),_isPreview&&!i&&$previewNotice.show(),wxinit(location.href),void 0!==_dataObj.loadingpage&&void 0!==_dataObj.loadingpage.title&&$loadingpage.html(""),getAllPageInteractData(function(){loadExternalJsLibs(function(){createPageEventList(),showLoadingpage();var a=getLoadingImageList(currentPageId);setTimeout(function(){loading(a,function(a){updateLoadingPercent(a)},function(){setMusicPosition(),musicAutoPlay===!0?playMusic():""!==musicUrl&&void 0!==musicUrl&&($iconMusic.show(),setMusicIcon(musicStopIcon,"off"),$iconMusic.removeClass("music-play"),$iconMusic.removeClass("music-play-none"),$iconMusic.bind(clickEventType,function(){null===$music?playMusic():stopMusic()})),showToppage(),showFloorpage();{var a=currentPageId;renderPage(a)}regPageEndEvent(a);for(var b=0;b<_dataObj.pageList.length;b++)_dataObj.pageList[b].id!==a&&(currentPageId=_dataObj.pageList[b].id,renderPage(_dataObj.pageList[b].id));currentPageId=a,rrxdebug&&console.info("_pagePluginCopyRight",_pagePluginCopyRight),-1===$.inArray(currentPageId,_pagePluginCopyRight)&&$pluginCopyright.hide(),_flipProgress===!0&&renderProgress(currentPageId,totalPages),setPageArrowIcon(currentPageId),"loadingpage"!==currentPageId&&pageCodeLoad(currentPageId,apiHelper.getAppInstance()),$(".bottomm-text").hide(),$(".show-rrxiu-visit").hide(),$page=_$canvas.find(".page_"+currentPageId),_isEditing||setTimeout(function(){loadPluginEvent(currentPageId)},10),playPageByPageId(currentPageId),flip.init($pagelist,currentPageId),rrxdebug&&console.log("init data-",currentPageId,lastPageId),currentPageId==lastPageId?(showCopyright(!0,currentPageId),hideArrow()):(showCopyright(!1,currentPageId),showArrow()),isShowDanmu()&&(rrxdebug&&console.info("initdata-isShowDanmu"),setTimeout(function(){getCommentLikeCount(),getCommentList()},1e3)),createFocusWechat(),createTopeMenu()})},0)})})}if($loadingpage=b.find(".pt-loadingpage"),"gql5ay"==c.guid&&(_animationEngine="css"),clickEventType=null!==document.ontouchstart?"click":"touchstart",_$canvas=b,_dataObj=pageObjectToArray(c),self=this,_host=a,void 0!==f&&null!==f&&(_log=f),_flipProgress=c.flipProgress,void 0===_flipProgress&&(_flipProgress=!0),void 0!==d&&(_isPc=d),void 0!==g&&(_isEditing=g),void 0!==h&&h&&(_isPreview=!0),void 0!==e&&(_isWeixin=e),void 0!==_dataObj.shareImageUrl&&""!==_dataObj.shareImageUrl&&(_dataObj.shareImageUrl=handleImgUrl(_dataObj.shareImageUrl)+appConfig.shareImageThumb),void 0!==_dataObj.llImageUrl&&""!==_dataObj.llImageUrl&&(_dataObj.llImageUrl=handleImgUrl(_dataObj.llImageUrl)+appConfig.llImageThumb),!g&&_dataObj.hasOwnProperty("cssList"))for(var k=h?"preview":"publish",l=0;l<_dataObj.cssList.length;l++)Cool.util.loadCss(Cool.util.hostStamp(appConfig.webFontHost+"css/"+k+"/"+_dataObj.cssList[l]));if(_copyrightFrom=getCopyrightFrom(),createCopyRightPage(),_$canvas.on("touchmove",function(a){a.preventDefault()}),initShareInfo(),void 0!==_dataObj.result&&0!==_dataObj.result){for(var m=2;100>=m;m++)updateLoadingPercent(m);return void setTimeout(function(){2==c.result?(needCode(_dataObj.msg),wxinit(location.href)):suspended(_dataObj.msg),$loadingpage.hide()},50)}if(void 0!==_dataObj.flipWay&&""!==_dataObj.flipWay&&(flipWay=_dataObj.flipWay),void 0!==_dataObj.flipAnimation){var n=[];n[110]={enter:"1101",back:"1102"},n[120]={enter:"1201",back:"1202"},n[130]={enter:"1301",back:"1302"},n[140]={enter:"1401",back:"1402"},n[150]={enter:"1501",back:"1502"},n[160]={enter:"1601",back:"1602"},n[170]={enter:"1701",back:"1701"},n[180]={enter:"1801",back:"1801"},n[190]={enter:"1901",back:"1901"},n[200]={enter:"2001",back:"2001"},n[210]={enter:"2101",back:"2102"},n[220]={enter:"2201",back:"2201"},n[230]={enter:"2301",back:"2301"},n[240]={enter:"2401",back:"2401"},n[250]={enter:"2501",back:"2501"},flipAnimation=n[_dataObj.flipAnimation],(void 0===flipAnimation||null===flipAnimation)&&(flipAnimation=n[110])}void 0!==_dataObj.musicUrl&&""!==_dataObj.musicUrl&&(musicUrl=apiHelper.getAppInstance().musicPreFix(_dataObj.musicUrl)),musicPlayIcon=void 0!==_dataObj.musicPlayIcon&&""!==_dataObj.musicPlayIcon?handleImgUrl(_dataObj.musicPlayIcon):"",musicStopIcon=void 0!==_dataObj.musicStopIcon&&""!==_dataObj.musicStopIcon?handleImgUrl(_dataObj.musicStopIcon):"",void 0!==_dataObj.musicAutoPlay&&""!==_dataObj.musicAutoPlay&&_dataObj.musicAutoPlay===!1&&(musicAutoPlay=_dataObj.musicAutoPlay),musicPosition=_dataObj.musicPosition||"",void 0!==_dataObj.lastPageGoto&&(lastPageGoto="stop"==_dataObj.lastPageGoto?"stop":"continue"),initOfficialAccountsModeCookie();var o=0;j()},base.playPage=function(a,b){return playPage(a,b)};var crRollInterval=null,ideaCount=0;base.isLastPageGotoFirstPage=function(){return"continue"==lastPageGoto?!0:!1},base.isLastPage=function(){return getPageCount()>1?currentPageId==lastPageId:!0},base.isFirstPage=function(){return getPageCount()>1?currentPageId==firstPageId:!0},base.nextPage=function(){goToNextPage()},base.prePage=function(){goToPrePage()},base.getPageCount=function(){return getPageCount()},base.getCurrentPageId=function(){return currentPageId},base.setIsEditing=function(a){_isEditing=a},base.getAllowFlip=function(){return allowFlipCurrentPage()},base.setPageThumb=function(a){_isPageThumb=a},base.clearAllCustomIntervals=function(){clearAllCustomIntervals();

},base.getPrefixCss=function(a,b){return getPrefixCss(a,b)},base.gotoPage=function(a){goToPageById(a)},base.CompositionImage=function(a,b,c,d){return CompositionImage(a,b,c,d)},base.getApiHelper=function(){return apiHelper.getAppInstance()};var apiHelper={appInstance:null,getAppInstance:function(){return null===this.appInstance&&(this.appInstance=new this.app),this.appInstance},app:function(){function a(a,d,e){if(c(a))return!0;var f=a(d,e);return b(f)?!0:f}function b(a){var b=a||!0;return b===!0}function c(a){var b=void 0===a;return b}this.test=function(){console.log("API")},this.getFlipWay=function(){return flipWay},this.getPluginDomain=function(a,b){return Cool.util.getPluginDomain(a,b)},this.parsePluginTheme=function(a,b,c){return Cool.util.parsePluginTheme(a,b,c)},this.pluginPreFix=function(a){if(""===a||null===a||void 0===a||a.constructor!==String)return a;for(var b=["http://plugin.weplus.me/","../assets/plugin/"],c=0;c<b.length;c++)if(a.indexOf(b[c])>-1)return a.replace(b[c],appConfig.pluginDomainFormat);return a},this.hostStamp=function(a){return Cool.util.hostStamp(a)},this.loadImage=function(a,b){Cool.util.loadImage(a,b)},this.getServiceHost=function(){return appConfig.serviceHost},this.getInteractServiceHost=function(){return appConfig.interactServiceHost},this.getDataHost=function(){return appConfig.dataHost},this.musicPreFix=function(a){if(!a)return a;var b=!1;null===_dataObj||void 0===_dataObj||_isEditing||_dataObj.hasOwnProperty("auth")&&(b=_dataObj.auth.P320===!0?!0:!1);var c=b?appConfig.vipDataHost:appConfig.dataHost,d="http://data.weplus.me/";return a.indexOf(d)>-1?a=a.replace(d,c):a.indexOf(appConfig.dataHost)>-1?a=a.replace(appConfig.dataHost,c):-1===a.indexOf("http://")&&(a=c+a),a},this.getImageHost=function(){return appConfig.imageHost},this.getViewHost=function(){return appConfig.viewHost},this.getWsiteGuid=function(){return _dataObj.guid},this.isEditing=function(){return _isEditing},this.getElement=function(a,b,c){var d=null;b=b||0,c=c===!0?!0:!1,0===b&&(b=currentPageId);var e=c?".pt-page-effect-box-":".element_";return d=_$canvas.find(".page_"+b+" "+e+a)},this.getPage=function(a){a=a||0,0===a&&(a=currentPageId);var b=_$canvas.find(".page_"+a);return b},this.getCurrentPageId=function(){return currentPageId},this.getWsiteCanvas=function(){return _$canvas};var d={};this.setGlobal=function(a,b){d[a]=b},this.getGlobal=function(a){return d[a]},this.loadJs=function(a,b){Cool.util.loadJs(a,b)},this.getUrlParameterByName=function(a){return Cool.util.getUrlParameterByName(a)},this.getBrowserUrl=function(a,b,c){return Cool.util.getBrowserUrl(a,b,c)},this.setLoadingDelay=function(a){void 0!==_dataObj.loadingpage&&(_dataObj.loadingpage.delay=a)},this.setStartPage=function(a){void 0!==a&&(currentPageId=a)},this.preloadAllResource=function(a){_preloadAllResource=a?!0:!1},this.loadCss=function(a){Cool.util.loadCss(a)},this.addCss=function(a){Cool.util.loadCssByStyle(a)},this.getUrlParamByName=function(a){return Cool.util.getUrlParameterByName(a)},this.isOfficialAccountsMode=function(){return isOfficialAccountsMode()},this.getUrlWithOfficialAccounts=function(a){var b=appConfig.viewDomainFormat.replace("{guid}",a);return b+"/?mode=official_accounts"},this.getCanFocusWechat=function(){return getCanFocusWechat()},this.getCanShowShareTips=function(){return getCanShowShareTips()},this.isPc=function(){return _isPc},this.showPluginCopyRight=function(a,b){showPluginCopyRight(a,b)},this.hidePluginCopyRight=function(){hidePluginCopyRight()},this.isShowPluginCopyright=function(){return!("customer"===_copyrightFrom||"na"===_copyrightFrom)},this.showSingleReport=function(){if(_dataObj.showReport||"customer"!==_copyrightFrom&&"na"!==_copyrightFrom){hideEffect($copyright);var a=_$canvas.find(".pt-inner .show-vr-plugin-report");0===a.length&&(a=$('<a href="javascript:void(0)" class="show-vr-plugin-report">举报</a>'),_$canvas.find(".pt-inner").append(a),registerReportEvent(a)),showEffect(a)}},this.hideSingleReport=function(){hideEffect(_$canvas.find(".pt-inner .show-vr-plugin-report"))},this.showShareDialog=function(a){void 0!==a&&""!==a&&$sharepage.html(a),showSharepage()},this.hideShareDialog=function(){hideSharepage()},this.updateShareInfo=function(a,b,c,d){var e=!1;a&&(e=!0,shareTitle=a,Cool.share.setTitle(a)),b&&(e=!0,shareDesc=b,Cool.share.setDesc(b)),c&&(e=!0,shareImageUrl=c,Cool.share.setImage(c)),d&&(e=!0,shareUrl=d),setWxShareInfo()},this.getShareInfo=function(){return{title:shareTitle,desc:shareDesc,image:shareImageUrl,url:shareUrl}},this.resetShareInfo=function(){shareTitle=_dataObj.title,Cool.share.setTitle(shareTitle),shareDesc=_dataObj.describe,Cool.share.setDesc(shareDesc),shareImageUrl=_dataObj.shareImageUrl,Cool.share.setImage(shareImageUrl),shareUrl=location.href,setWxShareInfo()},this.playBackgroundMusic=function(){$iconMusic.show(),playMusic()},this.stopBackgroundMusic=function(a){a&&$iconMusic.hide(),stopMusic()},this.getBackgroundMusicState=function(){return null!==$music?!$music.paused:!1},this.gotoPrePage=function(){triggerPluginLeaveEvent(currentPageId),goToPrePage()},this.gotoNextPage=function(){triggerPluginLeaveEvent(currentPageId),goToNextPage()},this.gotoPage=function(a,b){-1!==a&&(triggerPluginLeaveEvent(currentPageId),goToPageById(a))},this.swipe=function(b,d){if(c(d))return console.error("swipe:参数不正确");switch(b){case"up":_dataObj.swipeCustomUp=d;break;case"down":_dataObj.swipeCustomDown=d;break;case"left":_dataObj.swipeCustomLeft=d;break;case"right":_dataObj.swipeCustomRight=d}_dataObj.swipe=function(b,c){switch(c){case"up":return a(_dataObj.swipeCustomUp,b,c);case"down":return a(_dataObj.swipeCustomDown,b,c);case"left":return a(_dataObj.swipeCustomLeft,b,c);case"right":return a(_dataObj.swipeCustomRight,b,c)}}},this.startShake=function(a){void 0!==a&&null!==a&&startShake(a)},this.stopShake=function(a){void 0!==a&&null!==a&&stopShake(a)},this.bindEvent=function(a,b,d,e){var f=c(a),g=c(b);if(f||g)return console.error("bindEvent:参数不正确");if(void 0===d||""===d||"click"===d)a.unbind().bind(clickEventType,b);else if("shake"===d||d.indexOf("shake")>-1)e=void 0===e?!0:e,startShake(d),window.addEventListener(d,function(a){stopShake(d),b(a),e&&setTimeout(function(){startShake(d)},2e3)},!1);else if("enter"===d)console.error("enter:此插件暂不支持");else{var h;switch(d){case"swipeRight":h=new rrxTouch(a,{swiperight:b});break;case"swipeLeft":h=new rrxTouch(a,{swiperleft:b});break;case"swiperUp":h=new rrxTouch(a,{swiperup:b});break;case"swiperDown":h=new rrxTouch(a,{swipedown:b})}}},this.stopFlip=function(){_allowTempFlip=_allowFlip,_allowFlip=!1,hideArrow()},this.resetFlip=function(a){a=void 0===a?!1:a,_allowFlip=a?_allowTempFlip:!0,commpletedPageEffect(currentPageId),showArrow(),triggerPageEvent(currentPageId,"sysResetFlipCallBack")},this.commpletedPageEffect=function(a){commpletedPageEffect(a)},this.showFlipArrow=function(){showArrow()},this.hideFlipArrow=function(){hideArrow()},this.isWeixin=function(){return _isWeixin},this.triggerEvent=function(a,b){triggerPageEvent(currentPageId,a,b)},this.createEvent=function(a,b,c){var d=c||currentPageId,e=_dataObj.pageEventList[d];(void 0===e||null===e)&&(_dataObj.pageEventList[d]=[],e=_dataObj.pageEventList[d]),e.push({name:a,type:"customEvent",callback:b})},this.getElements=function(a,b){var c=[];if(void 0===a||0===a.length)return c;b=b||0,0===b&&(b=currentPageId);var d=null;for(i=0;i<a.length;i++)d=_$canvas.find(".page_"+b+" .element_"+a[i]),d&&c.push(d);return c},this.animation=function(a,b,c){var d=0,e=1,f=1,g=0;c&&(d=c.delay||0,e=c.duration||1,f=c.repeat||1,g=c.repeatDelay||0),(0===d||_isEditing)&&(d=0),"css"==_animationEngine?CssAnimationEngine.animation(a,b,d,e,f,g,_isEditing):JsAnimationEngine.animation(a,b,d,e,f,g)},this.setToBottom=function(a,b){isNaN(a)||(a=this.getElement(a,currentPageId)),a.css("top","auto"),a.css("bottom",b)},this.getiScroll=function(a,b){a=a||currentPageId;var c=void 0===b,d=null;return $.each(iScrollInstances,function(e,f){if(c){if(f.pageId===a)return d=f.instance,!1}else if(f.pageId===a&&f.elemId===b)return d=f.instance,!1}),d},this.scaleElement=function(a){c(a)||handleScaleIfSmallScreen(a)},this.checkIsLogin=function(){var a=$.cookie("wp_moblie_user");return void 0===a?null:a},this.mobileLogin=function(a,b,c){var d=/^(\S)+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/,e={result:0,msg:""};if(d.test(a))if(b.length<6)e.msg="密码至少6个字符",e.result=1,c(e);else{var f=a.split("@")[0],g={name:f,email:a,password:b,rememberMe:1,via:"jquery"};$.ajax({url:appConfig.serviceHost+"auth/mobileLogin",type:"GET",dataType:"jsonp",data:g,jsonp:"jsonp_callback"}).done(function(a){var b=new Date,d=new Date(b.valueOf()+3e5);$.cookie("wp_moblie_user","1",{expires:d}),c(a)}).fail(function(a){c(a)})}else e.msg="输入的邮箱格式不正确！",e.result=1,c(e)},this.getWsiteList=function(a,b,c){$.ajax({url:appConfig.serviceHost+"wsite/getList?page="+a+"&limit="+b,xhrFields:{withCredentials:!0}}).done(function(a){c(a)}).fail(function(a){c({result:1,msg:"未登录"})})};var e=function(a){function b(a,d,g){var h=(new Date,"GetWxUserById");"strong"===g&&(h="GetWxUserByIdStrong");var i=_host+"wechat/"+h+"?uid="+d+"&wsiteGuid="+m;$.ajax({url:i,xhrFields:{withCredentials:!0},dataType:"json",success:function(d){if(0===d.result)n=d.data,k(d.data.id),f(),void 0!==a&&a(n);else if(3===d.result)l(),e(),setTimeout(function(){b(a,"",g)},c());else{l();var h="";h="strong"===g?_host+"wechat/auth?redirect="+encodeURIComponent(location.href)+"&wsiteGuid="+m+"&level=strong":_host+"wechat/AuthNo?redirect="+encodeURIComponent(location.href)+"&wsiteGuid="+m,window.location.replace(h),setTimeout(function(){window.location.replace(h)},1e3)}},error:function(a,b,c){e(),console.error(a)}})}function c(){return 1e3*Math.floor(9*Math.random()+3)}function d(){$("body").append($authDialog)}function e(){(null===$authDialog||void 0===$authDialog)&&d(),$authDialog.show()}function f(){$authDialog.remove()}function g(a){return"wechat_openid"+a}function h(){var a=hex_md5(m+appConfig.version),b=Cool.cookie.get(g(a));return(""===$.trim(b)||null===b||void 0===b)&&(b=""),b}function i(){var a=window.location.host,b=a.indexOf(".");return a.substr(b)}function j(){return"strong"===a?1/24:.5}function k(a){var b=hex_md5(m+appConfig.version),c=i(),d=j();Cool.cookie.setWithoutTime(g(b),a,d,c)}function l(){var a=hex_md5(m+appConfig.version),b=i(),c=-100;Cool.cookie.setWithoutTime(g(a),"",c,b)}if(_dataObj){var m=_dataObj.guid,n={id:"",nickname:"",headimgurl:""};this.auth=function(c){if(_isWeixin===!1){_$canvas.find(".pt-wrapper").html("");return _$canvas.find(".pt-wrapper").html("<div style='width:100%;height:100%;background:#3DCE3D;font-size:40px;text-align:center;'><div style='padding-top:200px;color:#fff;'>需要在微信里打开!</div></div>"),$loadingpage&&$loadingpage.hide(),!1}if(d(),wsiteInfo&&wsiteInfo.authBehind&&wsiteInfo.wxauthedInfo)n=wsiteInfo.wxauthedInfo,c(n);else{var e=h();b(c,e,a)}};var o='<div style="display:none;z-index:3000;position: fixed;top:0;left:0;bottom:0;right:0;background-color:rgb(240, 239, 245);text-align:center;"><img src="../images/weixin_auth.png"style="margin-top:100px;text-align:center;margin-left:auto;margin-right:auto;width:80px;"><div style="text-align:center;margin-top:40px;color:#666;">正在进行微信授权</div></div>';return $authDialog=$(o),this.getAuthedInfo=function(){return wsiteInfo&&wsiteInfo.authBehind&&wsiteInfo.wxauthedInfo?wsiteInfo.wxauthedInfo:n},this}};this.weixin=new e,this.weixinStrong=new e("strong");var f=function(){function a(a,c){var d=_host+"focus/add",e={wsiteGuid:b,openId:a};$.ajax({url:d,type:"POST",data:e,dataType:"json",xhrFields:{withCredentials:!0}}).done(function(a){c&&c(a)}).fail(function(a){console.error(a)})}if(_dataObj){var b=_dataObj.guid;return{add:a}}};return this.wxFocus=new f,this.log=function(a){void 0!==_log&&void 0!==a&&""!==a&&_log.logTag(a)},this.interactHit=function(a,b){b=b||"",void 0!==_log&&void 0!==a&&""!==a&&_log.interactHit(a,b)},this.closeWsite=function(a){if(void 0!==_log){var b=Math.round(((new Date).getTime()-window.rrxOpenWsiteTime)/1e3);_log.closeWsite(window.userReadDepth,b,a)}else a()},this.hideTopIcon=function(){},this.resetTopIcon=function(){},this.isFirstPage=function(){return base.isFirstPage()},this.insertDanma=function(a,b){if($.each(a,function(a,b){DM_Comment_List.unshift(b)}),b){var c=[];$.each(DM_Comment_List,function(a,b){b.source&&"plugin"===b.source&&c.push(b)}),Danmaku.refresh(c)}else Danmaku.refresh(DM_Comment_List)},this.clearSysteimDanma=function(){DM_Comment_List=[],Danmaku.refresh(DM_Comment_List)},this.startDanma=function(){Danmaku.start()},this.stopDanma=function(){Danmaku.stop()},this.getDanmuConfig=function(){return _dataObj.danmuLike},this.initDanmu=function(){initDanmu()},this.forceOpenDanmu=function(){forceOpenDanmu=!0},this.setDanmuButtonShow=function(a){danmuButtonShow=a},this.setOnlyPluginDanmu=function(a){onlyPluginDanmu=a},this.showPluginFocus=function(a,b){showPluginFocus(a,b)},this.hidePluginFocus=function(){hidePluginFocus()},this}},$wePluginClient=function(){function a(a,b){void 0===window.wePluginClient&&(window.wePluginClient=[]);for(var c=window.wePluginClient.length-1;c>=0;c--)if(window.wePluginClient[c].token==a&&window.wePluginClient[c].version==b)return window.wePluginClient[c];return null}function b(b,c,d,f){var g=b.content.token,h=b.content.version,i=a(g,h);if(null!==i)i.init&&new i.init(b,c,apiHelper.getAppInstance(),d,f);else{var j=Cool.util.getPluginDomain(g,h)+"index.js";require(j,function(){e(g,h,window.wePluginInit,window.wePluginLoad,window.wePluginPreLoad);var i=a(g,h);null!==i?i.init&&new i.init(b,c,apiHelper.getAppInstance(),d,f):alert("加载插件失败")})}}function c(b,c){rrxdebug&&console.log("loadPlugin");var d=a(c.content.token,c.content.version);null!==d&&d.load&&new d.load(b,c)}function d(b){rrxdebug&&console.log("preLoadPlugin");var c=a(b.content.token,b.content.version);null!==c&&c.preload&&new c.preload(b,apiHelper.getAppInstance())}function e(b,c,d,e,f,g){rrxdebug&&console.log("addPlugin"),void 0===window.wePluginClient&&(window.wePluginClient=[]);var h=a(b,c);null===h&&window.wePluginClient.push({token:b,version:c,init:d,load:e,preload:f,leave:g})}function f(b,c){rrxdebug&&console.log("leavePlugin");var d=a(c.content.token,c.content.version);null!==d&&d.leave&&new d.leave(b,c,apiHelper.getAppInstance())}return{render:b,load:c,preload:d,add:e,leave:f}}()},CoolApp.prototype={constructor:CoolApp,createApp:function(a,b,c,d,e,f,g,h,i,j){this.init(a,b,c,d,e,f,g,h,i,j)},nextPage:function(){this.nextPage()},prePage:function(){this.prePage()},gotoPage:function(a){this.gotoPage(a)},isLastPage:function(){return base.isLastPage()},isFirstPage:function(){return base.isFirstPage()},isLastPageGotoFirstPage:function(){return base.isLastPageGotoFirstPage()},getPageCount:function(){this.getPageCount()},outPage:function(a,b,c){},parsePage:function(a){return this.parsePage(a)},playPage:function(a,b){return this.playPage(a,b)},parseElement:function(a){return this.parseElement(a)},playElement:function(a,b){return this.playElement(a,b)},getCurrentPageId:function(){return this.getCurrentPageId()},setIsEditing:function(a){this.setIsEditing(a)},getAllowFlip:function(){this.getAllowFlip()},setPageThumb:function(a){this.setPageThumb(a)},clearAllCustomIntervals:function(){this.clearAllCustomIntervals()},getPrefixCss:function(a,b){return this.getPrefixCss(a,b)},CompositionImage:function(a,b,c,d){return this.CompositionImage(a,b,c,d)},getApiHelper:function(){return this.getApiHelper()}}}(),function(){var a="",b="",c="",d=0,e="",f="",g="",h=0,i=0;WePlusLog=function(j,k,l,m,n){c=j,a=k,e=l,g=k+"VisitFirstLogGuid",f=m,h=parseInt(n,10),1!==h&&setTimeout(function(){var h=Cool.cookie.get(g),j={guid:a,fromVisitGuid:e,firstVisitGuid:h,qrc:f};$.post(c+"visitLog/add",{form:j},function(a){0===a.result?(b=a.data.logguid,d=a.data.visitCount,void 0!==a.data.id&&(i=a.data.id),""===h&&Cool.cookie.set(g,b)):console.log(a)},"json")},1e3)},WePlusLog.prototype={constructor:WePlusLog,doShare:function(b){1!==h&&setTimeout(function(){var d={type:b,wsiteGuid:a,visitGuid:Cool.cookie.get(g)};$.post(c+"visitLog/doShare",{form:d},function(a){},"json")},500)},logTag:function(a){setTimeout(function(){$.post(c+"logvisit/logTag",{form:{logguid:b,tag:a}},function(a){},"json")},500)},interactHit:function(b,d){if(1!==h){var e={type:b,name:d,wsiteGuid:a,visitGuid:Cool.cookie.get(g)};$.post(c+"visitLog/interactHit",{form:e},function(a){},"json")}},closeWsite:function(a,d,e){if(1===h)return void e();var f={logGuid:b,logCacheId:i,page:a,duration:d};$.post(c+"visitLog/CloseWsiteUpdate",{form:f},function(a){console.log("closeWsite",a),e()},"json")},getVisitCount:function(){return d},getVisitFirstLogKey:function(){return g}}}(),$(function(){function a(b){Cool.util.loadJs([b],function(b){try{if(""===coolData&&q===!1)a(m),q=!0;else{if(0===coolData.result){var e=Cool.util.getUrlParameterByName("from_code"),i=Cool.util.getUrlParameterByName("qrc_code");r=new WePlusLog(appConfig.serviceHost,f,e,i,h)}else 403===coolData.result&&(Cool.util.checkIsPcWithoutIframe()||(window.location.href="http://mp.weixin.qq.com/s?__biz=MzA4ODc5OTE1OQ==&mid=403761162&idx=1&sn=7c0391b88d1cbde5cc0fcefd59f4f93b&scene=1&srcid=0325SOmbeusryF6uwtlJxmLR&from=groupmessage&isappinstalled=0#wechat_redirect"));$("#main").css({width:width,height:height}),"1"===g&&(coolData.showVisitCount=!1),d=new CoolApp,d.createApp(appConfig.serviceHost,$("#main"),coolData,Cool.util.checkIsPcWithoutIframe(),k,r,!1,"1"===h?!0:!1,"1"===g?!0:!1),c()}}catch(j){a(m),q=!0,console.log("load",j)}})}function b(){return 1===parseInt(h)?"":"load"===Cool.cookie.get("wepublish")?(new Date).valueOf():(Cool.cookie.set("wepublish","load"),"")}function c(){var a=function(a){{var b=a.data;a.origin}if(""!==b){try{b=JSON.parse(b)}catch(c){}if("next"===b.filpType)d.getAllowFlip()&&d.nextPage();else if("pre"===b.filpType)d.getAllowFlip()&&d.prePage();else if("copyright"===b.filpType||"setting"===b.filpType){var f=$.extend(coolData,{},!0),g=b.wsite,h=b.copyright;for(var i in g)f[i]=g[i];if(void 0!==h&&("customer"===h.from&&(f.copyright=appConfig.copyright),f.copyright.from=h.from),f.showVisitCount=!1,d=new CoolApp,"copyright"===b.filpType){var j=f.pageList[f.pageList.length-1].id;"copyrightPage"===j&&f.pageList.pop(),"rrxiu"===f.copyright.from?(j="copyrightPage",f.danmuLike.show=!1):j=f.pageList[f.pageList.length-1].id,d.getApiHelper().setStartPage(j)}d.createApp(appConfig.serviceHost,$("#main"),f,e,k,r,!1,!1,!0)}}};"undefined"!=typeof window.addEventListener?window.addEventListener("message",a,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",a)}var d,e=Cool.util.checkIsPc(),f=wsiteInfo.wsiteGuid,g=Cool.util.getUrlParameterByName("setting"),h=Cool.util.getUrlParameterByName("preview"),i=Cool.util.getUrlParameterByName("tpl");if(e);else{var j=$("#main");j.on("touchmove",function(a){a.preventDefault()})}var k=Cool.util.checkIsWeixin(),l=b(),m=appConfig.serviceHost+"view/data?id="+f+"&preview="+h,n=appConfig.cloudHost+f+".js",o=wsiteInfo.ver;if(i){if(m=m+"&tpl="+i,e){var p=appConfig.clientHost+"my.html#/template/list?guid="+f;$div.append('<a class="weplus" id="tpllist" href=\''+p+'\'><div class="weplus-text">使用该模板</div><div class="weplus-arrow"></div></a>'),$("#out-container").append($div)}n=appConfig.cloudHost+"tpl_"+f+".js?v="+o,a(appConfig.enabledCloud?n:m)}else n=""===l?n+"?v="+o:n+"?timestamp="+l+"&v="+o,a(appConfig.enabledCloud&&1!==parseInt(h)?n:m);var q=!appConfig.enabledCloud,r=null});var Danmaku=function(){function a(){null===t?setTimeout(function(){$danmuButton.hide(),a()},1500):(E=!1,y.unbind(),clearInterval(z),A=1,t.html(""),t.css("display","none"))}function b(a,b,c,d){D=c,t=a,F=d,"vertical"===D?x=b:f(b)}function c(){0===x.length||E||(t.css("display","block"),E=!0,"vertical"===D?window.requestAnimationFrame?window.requestAnimationFrame(function(){r()}):r():(i(),window.requestAnimationFrame?window.requestAnimationFrame(function(){j()}):j()))}function d(a){f(a)}function e(a){return a.replace(/[<>&"]/g,function(a){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[a]})}function f(a){if(0!==a.length){x=[],y.unbind();var b=a.length>B?B:a.length;g(b);for(var c=0;b>c;c++){var d=h();x.push({time:H[d],duration:k(4e3,6e3),top:c%10*70+10,photo:a[c].photo,content:a[c].content,customStyle:a[c].customStyle,customeContent:a[c].customeContent}),H.splice(d,1)}}}function g(a){for(var b=0;a>b;b++)H.push(300*b)}function h(){var a=Math.floor(Math.random()*H.length+1)-1;return a}function i(){$.each(x,function(a,b){var c=Math.ceil(b.time/v);(0===a||b.duration>u)&&(u=b.duration),b.session=c;var d=new G(b);y.on(c+"start",function(){d.perform()})})}function j(){w=Math.ceil(u/v),A=0,z=setInterval(function(){y.trigger(A+"start"),A===w?(A=0,E=!1,y.unbind(),clearInterval(z),F.trigger("danmuRestart")):A++},v)}function k(a,b){var c=Math.random()*(b-a)+a;return c=parseInt(c,10),parseInt(c,10)}function l(a){for(var b=0,c=0;c<a.length;c++)a.charCodeAt(c)>127||94==a.charCodeAt(c)?b+=2:b++;return b}function m(a){if(!(a>x.length)){p();var b=x[a-1],c=$('<div class="cm-content vertical" data-step="'+a+'" style="font-size:22px;color:#fff;"><img src="'+b.photo+'"><span>'+b.content+"</span></div>"),d=t.height()-144;n(c,d),t.append(c),setTimeout(function(){o(c,d)},100)}}function n(a,b){a.css({transform:"translate3d(20px,"+b+"px,0) scale(0)","-webkit-transform":"translate3d(20px,"+b+"px,0) scale(0)"})}function o(a,b){a.css({"transform-origin":"top","-webkit-transition":"-webkit-transform .5s cubic-bezier(0.4, 0, 1, 1)",transition:"transform .5s cubic-bezier(0.4, 0, 1, 1)",transform:"translate3d(20px,"+b+"px,0) scale(1)","-webkit-transform":"translate3d(20px,"+b+"px,0) scale(1)"})}function p(){for(var a=t.children(),b=0;b<a.length;b++){var c=$(a[b]);c.attr("data-step",b+1);var d=q(c)-74;c.css({transform:"translate3d(20px,"+d+"px,0)","-webkit-transform":"translate3d(20px,"+d+"px,0)"})}}function q(a){var b=a.css("-webkit-transform");return parseInt(b.split(",")[5],10)}function r(){t.css("display","block"),z=setInterval(function(){var a=t.children();(a.length>=C||a.length===x.length)&&s(a),m(A),A===x.length?A=1:A++},1.2*v)}function s(a){var b=C-1;x.length<C&&(b=x.length-1);for(var c=function(b){0===b?$(a[b]).animate({opacity:0},500,function(){$(this).remove()}):$(a[b]).remove()},d=0;d<a.length-b;d++)c(d)}var t=null,u=3e3,v=1e3,w=1,x=[],y=$({}),z=null,A=1,B=100,C=8,D="horizontal",E=!1,F=null,G=function(a){this.play=a,this.appearance=this.makeUp(),this.appearance.hide().appendTo(t)};G.prototype.makeUp=function(){var a=$('<div class="cm-content" style="font-size:22px;color:#fff;"><img src="'+this.play.photo+'"><span>'+e(this.play.content)+"</span></div>");return this.play.customeContent&&(a=$('<div class="cm-content" style="font-size:22px;color:#fff;">'+this.play.customeContent+"</div>")),this.play.customStyle&&a.css(this.play.customStyle),a},G.prototype.reset=function(){var a="transform 0s";this.appearance.css({"-webkit-transition":"-webkit-"+a,transition:a,transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)"})},G.prototype.animate=function(){var a=this,b=a.appearance,c=b.width()+t.width()+20,d="transform "+a.play.duration/1e3+"s cubic-bezier(0.4, 0, 1, 1)";b.css({"-webkit-transition":"-webkit-"+d,transition:d,transform:"translate3d("+-c+"px,0,0)","-webkit-transform":"translate3d("+-c+"px,0,0)"}),b.get(0).addEventListener("webkitTransitionEnd",function(){a.reset()},!1)},G.prototype.perform=function(){var a=this,b=a.appearance;b.css({position:"absolute",left:t.width()+"px",top:a.play.top||0,display:"table"});var c=a.play.time-(a.play.session-1)*v;setTimeout(function(){a.animate()},c)};var H=[];return{init:b,start:c,stop:a,getCharacterSize:l,refresh:d,checkIsPlaying:function(){return E}}}();window.rrxTouch={},function(a){function b(a,b){return 180*Math.atan2(b,a)/Math.PI}function c(a,c,d,e){var f=c-e,g=d-a,h=0,i=Math.sqrt(g*g+f*f);if(2>i)return h;var j=b(g,f);return j>=-45&&45>j?h=4:j>=45&&135>j?h=1:j>=-135&&-45>j?h=2:(j>=135&&180>=j||j>=-180&&-135>j)&&(h=3),h}function d(a){a=a||window.event,a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0)}var e,f,g=0,h=0;rrxTouch=function(a,b){if(!a)throw new Error("elem is null");b||(b={prevent_default:!0}),a.on("mousedown touchstart",function(a){b.prevent_default&&d(a),"mousedown"==a.type&&(e=a.pageX,f=a.pageY),"touchstart"==a.type&&(e=a.touches?a.touches[0].pageX:a.originalEvent.touches[0].pageX,f=a.touches?a.touches[0].pageY:a.originalEvent.touches[0].pageY),b.touchstart&&b.touchstart()}),a.on("mousemove touchmove",function(a){b.prevent_default&&d(a),"mousemove"==a.type&&(g=a.pageX,h=a.pageY),"touchmove"==a.type&&(g=a.touches?a.touches[0].pageX:a.originalEvent.touches[0].pageX,h=a.touches?a.touches[0].pageY:a.originalEvent.touches[0].pageY),b.touchmove&&b.touchmove()}),a.on("mouseup touchend mouseleave",function(a){b.prevent_default&&d(a),b.touchend&&b.touchend();var i=c(e,f,g,h);switch(i){case 0:break;case 1:console.info("up"),b.swipeup&&b.swipeup();break;case 2:console.info("down"),b.swipedown&&b.swipedown();break;case 3:console.info("left"),b.swipeleft&&b.swipeleft();break;case 4:console.info("right"),b.swiperight&&b.swiperight()}})}}(window.jQuery);